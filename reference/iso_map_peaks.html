<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Map peaks based on retention time — iso_map_peaks • isoprocessor</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Map peaks based on retention time — iso_map_peaks" />
<meta property="og:description" content="This function makes it easy to map peaks based on pre-defined peak maps. It is implemented to work on iso_files as well as directly on peak_table data frames. It reports all peaks including missing peaks and ambiguous peaks by adding a set of information columns for each entry (is_identified, is_missing, is_ambiguous, n_matches, n_overlapping). For routine downstream data processing, this function is usually followed by iso_summarize_peak_mappings and iso_get_problematic_peak_mappings to inspect the problematic peaks and iso_remove_problematic_peak_mappings to proceed only with mapped peaks that are clearly identified. Note that without this filter, one must proceed with great caution interpreting the ambiguous peaks. Also note that if the compound column already exists in peak_table, it will be overwritten with the new mappings from the peak maps but will issue a warning that this is happening." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-106138361-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-106138361-4');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">isoprocessor</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="in active development">0.6.11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/dual_inlet.html">Dual Inlet</a>
</li>
<li>
  <a href="../articles/continuous_flow.html">Continuous Flow</a>
</li>
<li>
  <a href="../articles/scan.html">Scan</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Processing Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/ea_irms_example_carbon.html">Bulk carbon isotope analysis</a>
    </li>
    <li>
      <a href="../articles/gc_irms_example_carbon.html">Compound specific carbon isotope analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/isoverse/isoprocessor">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Map peaks based on retention time</h1>
    <small class="dont-index">Source: <a href='https://github.com/isoverse/isoprocessor/blob/master/R/peak_mapping.R'><code>R/peak_mapping.R</code></a></small>
    <div class="hidden name"><code>iso_map_peaks.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function makes it easy to map peaks based on pre-defined peak maps. It is implemented to work on <code>iso_files</code> as well as directly on <code>peak_table</code> data frames. It reports all peaks including missing peaks and ambiguous peaks by adding a set of information columns for each entry (<code>is_identified</code>, <code>is_missing</code>, <code>is_ambiguous</code>, <code>n_matches</code>, <code>n_overlapping</code>). For routine downstream data processing, this function is usually followed by <code><a href='iso_summarize_peak_mappings.html'>iso_summarize_peak_mappings</a></code> and <code><a href='iso_get_problematic_peak_mappings.html'>iso_get_problematic_peak_mappings</a></code> to inspect the problematic peaks and <code><a href='iso_remove_problematic_peak_mappings.html'>iso_remove_problematic_peak_mappings</a></code> to proceed only with mapped peaks that are clearly identified. Note that without this filter, one must proceed with great caution interpreting the ambiguous peaks. Also note that if the <code>compound</code> column already exists in <code>peak_table</code>, it will be overwritten with the new mappings from the peak maps but will issue a warning that this is happening.</p>
    </div>

    <pre class="usage"><span class='fu'>iso_map_peaks</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for iso_file_list</span>
<span class='fu'>iso_map_peaks</span><span class='op'>(</span>
  <span class='va'>iso_files</span>,
  <span class='va'>peak_maps</span>,
  map_id <span class='op'>=</span> <span class='fu'>default</span><span class='op'>(</span><span class='va'>map_id</span><span class='op'>)</span>,
  compound <span class='op'>=</span> <span class='fu'>default</span><span class='op'>(</span><span class='va'>compound</span><span class='op'>)</span>,
  rt <span class='op'>=</span> <span class='fu'>default</span><span class='op'>(</span><span class='va'>rt</span><span class='op'>)</span>,
  rt_start <span class='op'>=</span> <span class='fu'>default</span><span class='op'>(</span><span class='va'>rt_start</span><span class='op'>)</span>,
  rt_end <span class='op'>=</span> <span class='fu'>default</span><span class='op'>(</span><span class='va'>rt_end</span><span class='op'>)</span>,
  rt_prefix_divider <span class='op'>=</span> <span class='st'>":"</span>,
  quiet <span class='op'>=</span> <span class='fu'>default</span><span class='op'>(</span><span class='va'>quiet</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># S3 method for data.frame</span>
<span class='fu'>iso_map_peaks</span><span class='op'>(</span>
  <span class='va'>peak_table</span>,
  <span class='va'>peak_maps</span>,
  file_id <span class='op'>=</span> <span class='fu'>default</span><span class='op'>(</span><span class='va'>file_id</span><span class='op'>)</span>,
  map_id <span class='op'>=</span> <span class='fu'>default</span><span class='op'>(</span><span class='va'>map_id</span><span class='op'>)</span>,
  compound <span class='op'>=</span> <span class='fu'>default</span><span class='op'>(</span><span class='va'>compound</span><span class='op'>)</span>,
  rt <span class='op'>=</span> <span class='fu'>default</span><span class='op'>(</span><span class='va'>rt</span><span class='op'>)</span>,
  rt_start <span class='op'>=</span> <span class='fu'>default</span><span class='op'>(</span><span class='va'>rt_start</span><span class='op'>)</span>,
  rt_end <span class='op'>=</span> <span class='fu'>default</span><span class='op'>(</span><span class='va'>rt_end</span><span class='op'>)</span>,
  rt_prefix_divider <span class='op'>=</span> <span class='st'>":"</span>,
  quiet <span class='op'>=</span> <span class='fu'>default</span><span class='op'>(</span><span class='va'>quiet</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>...</th>
      <td><p>S3 method placeholder parameters, see class specific functions for details on parameters</p></td>
    </tr>
    <tr>
      <th>iso_files</th>
      <td><p>collection of continuous flow iso_file objects</p></td>
    </tr>
    <tr>
      <th>peak_maps</th>
      <td><p>data frame with the peak map(s). At minimum, this data frame must have a <code>compound</code> and <code>rt</code> column but may have additional information columns. If multiple peak maps are provided, the <code>peak_table</code> data frame requires a <code>map_id</code> column to identify which peak map should be used and the peak maps data frame must have a <code>rt:&lt;map_id&gt;</code> column for each used value of <code>map_id</code>. The names of all these columns can be changed if necessary using the <code>compound</code>, codert and <code>map_id</code> parameters.</p></td>
    </tr>
    <tr>
      <th>map_id</th>
      <td><p>the column that indicates which map to use for which file (only necessary if multiple peak maps are used)</p></td>
    </tr>
    <tr>
      <th>compound</th>
      <td><p>the column in peak_maps that holds compound information</p></td>
    </tr>
    <tr>
      <th>rt</th>
      <td><p>the column in peak_table and colum prefix in peak_maps ("rt:...") that holds retention time information</p></td>
    </tr>
    <tr>
      <th>rt_start</th>
      <td><p>the column in peak_table that holds start of peak retention times</p></td>
    </tr>
    <tr>
      <th>rt_end</th>
      <td><p>the column in peak_table that holds end of peak retention times</p></td>
    </tr>
    <tr>
      <th>rt_prefix_divider</th>
      <td><p>the divider after the retention time column prefix in peak_maps to identify the map id values (e.g. "rt:map_id_value")</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>whether to display (quiet=FALSE) or silence (quiet = TRUE) information messages.</p></td>
    </tr>
    <tr>
      <th>peak_table</th>
      <td><p>data frame with the peak table</p></td>
    </tr>
    <tr>
      <th>file_id</th>
      <td><p>the column(s) in peak_table that uniquely identify a file/set of peaks that belong together</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>data frame with mapped peaks and the following information columns:</p><ul>
<li><p><code>peak_info</code>: a label for the peak with its name and retention time plus indicators of any ambiguity in identification in the form of <code>'?'</code> for either compound name or retention time for an expected peak that was not found</p></li>
<li><p><code>is_identified</code>: a logical TRUE/FALSE indicating peaks that have been successfully identified (includes missing peaks from the peak map!) (note that this information could also be derived from !is.na(compound) but is provided for convenience)</p></li>
<li><p><code>is_missing</code>: a logical TRUE/FALSE indicating peaks that are in the peak map definition but have no matching peak</p></li>
<li><p><code>is_ambiguous</code>: a logical TRUE/FALSE indicating peaks that are ambiguous in their definition either because they have multiple matches or because they overlap with other, overlapping peaks that were identified the same (note that this information could also be derived from n_overlapping &gt; 1 | n_matches &gt; 1 but is provided for convenience)</p></li>
<li><p><code>n_matches</code>: the number of matches each peak has in the peak map</p></li>
<li><p><code>n_overlapping</code>: the number of overlapping peaks that match the same peak definition</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other peak mapping functions: 
<code><a href='iso_get_problematic_peaks.html'>iso_get_problematic_peaks</a>()</code>,
<code><a href='iso_remove_problematic_peak_mappings.html'>iso_remove_problematic_peak_mappings</a>()</code>,
<code><a href='iso_summarize_peak_mappings.html'>iso_summarize_peak_mappings</a>()</code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sebastian Kopf.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


