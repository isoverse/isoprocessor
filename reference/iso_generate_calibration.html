<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Generate data calibration — iso_generate_calibration • isoprocessor</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Generate data calibration — iso_generate_calibration" />
<meta property="og:description" content="Generate a calibration for a specific variable based on one or multiple calibration models. Requires properly nested and grouped data, see iso_prepare_for_calibration for details. Note that to calibrate different variables, separate calls to this function should be issued each with different calibration names." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-106138361-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-106138361-4');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">isoprocessor</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="in active development">0.6.11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/dual_inlet.html">Dual Inlet</a>
</li>
<li>
  <a href="../articles/continuous_flow.html">Continuous Flow</a>
</li>
<li>
  <a href="../articles/scan.html">Scan</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Processing Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/ea_irms_example_carbon.html">Bulk carbon isotope analysis</a>
    </li>
    <li>
      <a href="../articles/gc_irms_example_carbon.html">Compound specific carbon isotope analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/isoverse/isoprocessor">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate data calibration</h1>
    <small class="dont-index">Source: <a href='https://github.com/isoverse/isoprocessor/blob/master/R/calibration.R'><code>R/calibration.R</code></a></small>
    <div class="hidden name"><code>iso_generate_calibration.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generate a calibration for a specific variable based on one or multiple calibration models. Requires properly nested and grouped data, see <a href='iso_prepare_for_calibration.html'>iso_prepare_for_calibration</a> for details. Note that to calibrate different variables, separate calls to this function should be issued each with different <code>calibration</code> names.</p>
    </div>

    <pre class="usage"><span class='fu'>iso_generate_calibration</span><span class='op'>(</span>
  <span class='va'>dt</span>,
  <span class='va'>model</span>,
  calibration <span class='op'>=</span> <span class='st'>""</span>,
  use_in_calib <span class='op'>=</span> <span class='fu'>default</span><span class='op'>(</span><span class='va'>is_std_peak</span><span class='op'>)</span>,
  min_n_datapoints <span class='op'>=</span> <span class='fl'>2</span>,
  is_std_peak <span class='op'>=</span> <span class='fu'>default</span><span class='op'>(</span><span class='va'>is_std_peak</span><span class='op'>)</span>,
  is_standard <span class='op'>=</span> <span class='fu'>default</span><span class='op'>(</span><span class='va'>is_std_peak</span><span class='op'>)</span>,
  quiet <span class='op'>=</span> <span class='fu'>default</span><span class='op'>(</span><span class='va'>quiet</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dt</th>
      <td><p>nested data table with column <code>all_data</code> (see <a href='iso_prepare_for_calibration.html'>iso_prepare_for_calibration</a>)</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>a single regression model (usually <a href='https://rdrr.io/r/stats/lm.html'>lm</a> or <a href='https://rdrr.io/r/stats/glm.html'>glm</a>) or a list of multiple alternative regression models for the calibration. If a named list is provided, the name(s) will be used instead of the formulas for the model identification column. If multiple models are provided, the entire data table rows will be duplicated to consider the different models in parallel. Note that <a href='https://rdrr.io/r/stats/loess.html'>loess</a> models are supported but discouraged (and will cause a warning) because local polynomial regression fitting does not calibrate based on a hypothesized regression model and can easily mis-calibrate sparse data. The exception is for non-linear temporal drift corrections (use <code>calibration="drift"</code> to flag as such) which may reasonably require local polynomical regression fitting of the type <code><a href='https://rdrr.io/r/stats/loess.html'>loess(y ~ file_datetime)</a></code> to account for temporal machine variations.</p></td>
    </tr>
    <tr>
      <th>calibration</th>
      <td><p>an informative name for the calibration (could be e.g. <code>"d13C"</code> or <code>"conc"</code>). If provided, will be used as a prefix for the new columns generated by this function. This parameter is most useful if there are multiple variables in the data set that need to be calibrated (e.g. multiple delta values, concentration, etc.). If there is only a single variable to calibrate, the <code>calibration</code> parameter is completely optional and can just be left blank (the default).</p></td>
    </tr>
    <tr>
      <th>use_in_calib</th>
      <td><p>column or filter condition to determine which subset of data to actually use for the calibration (default is the <code>is_std_peak</code> field introduced by <code><a href='iso_add_standards.html'>iso_add_standards</a></code>).</p></td>
    </tr>
    <tr>
      <th>min_n_datapoints</th>
      <td><p>the minimum number of data points required for applying the model(s). Note that there is always an additional check to make sure the minimum number of degrees of freedom for each model is met. If the minimum number of degrees of freedom required is not met, the model will/can not be calculated no matter what <code>min_n_datapoints</code> is set to.</p></td>
    </tr>
    <tr>
      <th>is_std_peak</th>
      <td><p>deprecated in favor of <code>use_in_calib</code></p></td>
    </tr>
    <tr>
      <th>is_standard</th>
      <td><p>deprecated in favor of <code>use_in_calib</code></p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>whether to display (quiet=FALSE) or silence (quiet = TRUE) information messages.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>the data table with the following columns added (prefixed by the <code>calibration</code> parameter if provided):</p><ul>
<li><p><code>calib</code>: the name of the calibration if provided in the <code>model</code> parameter, otherwise the formula</p></li>
<li><p><code>calib_ok</code>: a TRUE/FALSE column indicating whether there was enough data for calibration to be generated</p></li>
<li><p><code>calib_points</code>: an integer column indicating the total number of data points used in the calibration. Note that this field counts replicate data points: multiple data points that fall at the exact same x or y-value still count as individual data points for this metric.</p></li>
<li><p><code>calib_params</code>: a nested dataframe that holds the actual regression model fit, coefficients, summary and data range. These parameters are most easily accessed using the functions <code><a href='iso_get_calibration_coefficients.html'>iso_unnest_calibration_coefs</a></code>, <code><a href='iso_get_calibration_summary.html'>iso_unnest_calibration_summary</a></code>, <code><a href='iso_get_calibration_parameters.html'>iso_unnest_calibration_parameters</a></code>, <code><a href='iso_get_calibration_range.html'>iso_unnest_calibration_range</a></code>, or directly via <code><a href='https://tidyr.tidyverse.org/reference/nest.html'>unnest</a></code></p></li>
<li><p><code>resid</code> within <code>all_data</code>: a new column within the nested <code>all_data</code> that holds the residuals for all standards used in the regression model</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other calibration functions: 
<code><a href='iso_add_standards.html'>iso_add_standards</a>()</code>,
<code><a href='iso_apply_calibration.html'>iso_apply_calibration</a>()</code>,
<code><a href='iso_evaluate_calibration_range.html'>iso_evaluate_calibration_range</a>()</code>,
<code><a href='iso_get_calibration_coefficients.html'>iso_get_calibration_coefficients</a>()</code>,
<code><a href='iso_get_calibration_data.html'>iso_get_calibration_data</a>()</code>,
<code><a href='iso_get_calibration_range.html'>iso_get_calibration_range</a>()</code>,
<code><a href='iso_get_calibration_summary.html'>iso_get_calibration_summary</a>()</code>,
<code><a href='iso_get_problematic_calibrations.html'>iso_get_problematic_calibrations</a>()</code>,
<code><a href='iso_prepare_for_calibration.html'>iso_prepare_for_calibration</a>()</code>,
<code><a href='iso_remove_problematic_calibrations.html'>iso_remove_problematic_calibrations</a>()</code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sebastian Kopf.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


