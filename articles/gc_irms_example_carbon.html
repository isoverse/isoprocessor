<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GC-IRMS data processing example: carbon • isoprocessor</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="GC-IRMS data processing example: carbon">
<meta property="og:description" content="isoprocessor">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-106138361-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-106138361-4');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">isoprocessor</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="in active development">0.6.11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/dual_inlet.html">Dual Inlet</a>
</li>
<li>
  <a href="../articles/continuous_flow.html">Continuous Flow</a>
</li>
<li>
  <a href="../articles/scan.html">Scan</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Processing Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ea_irms_example_carbon.html">Bulk carbon isotope analysis</a>
    </li>
    <li>
      <a href="../articles/gc_irms_example_carbon.html">Compound specific carbon isotope analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/isoverse/isoprocessor">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="gc_irms_example_carbon_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>GC-IRMS data processing example: carbon</h1>
            <h3 class="subtitle">carbon isotopes in alkanes</h3>
            
            <h4 class="date">2021-11-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/isoverse/isoprocessor/blob/master/vignettes/gc_irms_example_carbon.Rmd"><code>vignettes/gc_irms_example_carbon.Rmd</code></a></small>
      <div class="hidden name"><code>gc_irms_example_carbon.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This is an example of a data processing pipeline for compound-specific Gas Chromatography Isotope Ratio Mass Spectrometry (GC-IRMS) carbon isotope measurements. It can be downloaded as a template (or just to see the plain-text code) by following the <code>Source</code> link above. Knitting for stand-alone data analysis works best to <code>HTML</code> rather than the website rendering you see here. To make this formatting change simply delete line #6 in the template file (the line that says <code>rmarkdown::html_vignette:</code>).</p>
<p>Note that all code chunks that contain a critical step towards the final data (i.e. do more than visualization or a data summary) are marked with <code>(*)</code> in the header to make it easier to follow all key steps during interactive use.</p>
<p>This example was run using <strong><a href="http://isoreader.kopflab.org">isoreader</a> version 1.3.1</strong> and <strong><a href="http://isoprocessor.kopflab.org/">isoprocessor</a> version 0.6.11</strong>. If you want to reproduce the example, please make sure that you have these or newer versions of both packages installed:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># restart your R session (this command only works in RStudio)</span>
<span class="fu">.rs.restartR</span><span class="op">(</span><span class="op">)</span>

<span class="co"># installs the development tools package if not yet installed</span>
<span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"devtools"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span> 

<span class="co"># installs the newest version of isoreader and isoprocessor</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"isoverse/isoreader"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"isoverse/isoprocessor"</span><span class="op">)</span></code></pre></div>
</div>
<div id="load-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#load-packages" class="anchor"></a>Load packages</h1>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co"># general data wrangling and plotting</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/isoverse/isoreader">isoreader</a></span><span class="op">)</span> <span class="co"># reading the raw data files</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/isoverse/isoprocessor">isoprocessor</a></span><span class="op">)</span> <span class="co"># processing the data</span></code></pre></div>
<p>This analysis was run using <a href="http://isoreader.kopflab.org">isoreader</a> version 1.3.1 and <a href="http://isoprocessor.kopflab.org/">isoprocessor</a> version 0.6.11.</p>
<p>For use as a data processing template, please follow the <code>Source</code> link above, download the raw file and adapt as needed. Knitting for stand-alone data analysis works best to <code>HTML</code> rather than the in-package default <code>html_vignette</code>.</p>
<p>All code chunks that contain a critical step towards the final data (i.e. do more than visualization or a data summary) are marked with <code>(*)</code> in the header to make it easier to follow all key steps during interactive use.</p>
</div>
<div id="load-data" class="section level1">
<h1 class="hasAnchor">
<a href="#load-data" class="anchor"></a>Load data</h1>
<div id="read-raw-data-files" class="section level2">
<h2 class="hasAnchor">
<a href="#read-raw-data-files" class="anchor"></a>Read raw data files (*)</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># set file path(s) to data files, folders or rds collections </span>
<span class="co"># can be multiple folders or mix of folders and files, using example data set here</span>
<span class="co"># (this is a reduced data set of mostly standards with just a few example samples)</span>
<span class="va">data_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/iso_get_processor_example.html">iso_get_processor_example</a></span><span class="op">(</span><span class="st">"gc_irms_example_carbon.cf.rds"</span><span class="op">)</span>

<span class="co"># read files</span>
<span class="va">iso_files_raw</span> <span class="op">&lt;-</span> 
  <span class="co"># path to data files</span>
  <span class="va">data_path</span> <span class="op">%&gt;%</span> 
  <span class="co"># read data files in parallel for fast read</span>
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_read_continuous_flow.html">iso_read_continuous_flow</a></span><span class="op">(</span>parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co"># filter out files with read errors (e.g. from aborted analysis)</span>
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_filter_files_with_problems.html">iso_filter_files_with_problems</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Info: preparing to read 1 data files (all will be cached), setting up 1 par...</span>
<span class="co">#&gt; Process 1: reading file 'gc_irms_example_carbon.cf.rds' with '.cf.rds' read...</span>
<span class="co">#&gt; Process 1: loaded 45 data files from R Data Storage</span>
<span class="co">#&gt; Info: finished reading 1 files in 2.89 secs</span>
<span class="co">#&gt; Info: removing 0/45 files that have any error (keeping 45)</span></code></pre></div>
</div>
<div id="process-file-info-peak-table" class="section level2">
<h2 class="hasAnchor">
<a href="#process-file-info-peak-table" class="anchor"></a>Process file info &amp; peak table (*)</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># process</span>
<span class="va">iso_files</span> <span class="op">&lt;-</span> <span class="va">iso_files_raw</span> <span class="op">%&gt;%</span> 
  <span class="co"># set peak table from vendor data table</span>
  <span class="fu"><a href="../reference/iso_set_peak_table_from_vendor_data_table.html">iso_set_peak_table_automatically_from_vendor_data_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># convert units from mV to V for amplitudes and area</span>
  <span class="fu"><a href="../reference/iso_convert_peak_table_units.html">iso_convert_peak_table_units</a></span><span class="op">(</span>V <span class="op">=</span> <span class="va">mV</span>, Vs <span class="op">=</span> <span class="va">mVs</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># rename key file info columns</span>
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_rename_file_info.html">iso_rename_file_info</a></span><span class="op">(</span>id1 <span class="op">=</span> <span class="va">`Identifier 1`</span>, id2 <span class="op">=</span> <span class="va">`Identifier 2`</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># parse text info into numbers</span>
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_parse_file_info.html">iso_parse_file_info</a></span><span class="op">(</span>number <span class="op">=</span> <span class="va">Analysis</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># process other file information that is specific to the naming conventions</span>
  <span class="co"># of this particular sequence</span>
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_mutate_file_info.html">iso_mutate_file_info</a></span><span class="op">(</span>
    <span class="co"># what is the type of each analysis?</span>
    type <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
      <span class="fu">str_detect</span><span class="op">(</span><span class="va">id1</span>, <span class="st">"[Zz]ero"</span><span class="op">)</span>      <span class="op">~</span> <span class="st">"on_off"</span>,
      <span class="fu">str_detect</span><span class="op">(</span><span class="va">id1</span>, <span class="st">"[Ll]inearity"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"lin"</span>,
      <span class="fu">str_detect</span><span class="op">(</span><span class="va">id1</span>, <span class="st">"A5"</span><span class="op">)</span>           <span class="op">~</span> <span class="st">"std"</span>,
      <span class="cn">TRUE</span>                            <span class="op">~</span> <span class="st">"sample"</span>
    <span class="op">)</span>,
    <span class="co"># was there seed oxidation?</span>
    seed_oxidation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">`Seed Oxidation`</span> <span class="op">==</span> <span class="st">"1"</span>, <span class="st">"yes"</span>, <span class="st">"no"</span><span class="op">)</span>,
    <span class="co"># what was the injection volume based on the AS method name?</span>
    injection_volume <span class="op">=</span> <span class="fu">str_extract</span><span class="op">(</span><span class="va">`AS Method`</span>, <span class="st">"AS PTV [0-9.]+"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
      <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_number.html">parse_number</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_with_units.html">iso_double_with_units</a></span><span class="op">(</span><span class="st">"uL"</span><span class="op">)</span>,
    <span class="co"># what was the concentration? (assuming Preparation = concentration or volume)</span>
    concentration <span class="op">=</span> <span class="fu">str_extract</span><span class="op">(</span><span class="va">Preparation</span>, <span class="st">"[0-9.]+ ?ng( per |/)uL"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
      <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_number.html">parse_number</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_with_units.html">iso_double_with_units</a></span><span class="op">(</span><span class="st">"ng/uL"</span><span class="op">)</span>,
    <span class="co"># or the volume?</span>
    volume <span class="op">=</span> <span class="fu">str_extract</span><span class="op">(</span><span class="va">Preparation</span>, <span class="st">"[0-9.]+ ?uL"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
      <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_number.html">parse_number</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_with_units.html">iso_double_with_units</a></span><span class="op">(</span><span class="st">"uL"</span><span class="op">)</span>,
    <span class="co"># what folder are the data files in? (assuming folder = sequence)</span>
    folder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html">basename</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/basename.html">dirname</a></span><span class="op">(</span><span class="va">file_path</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># add in additional sample metadata (could be any info)</span>
  <span class="co"># note: this would typically be stored in / read from a csv or excel file</span>
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_add_file_info.html">iso_add_file_info</a></span><span class="op">(</span>
    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
      <span class="co"># column names</span>
      <span class="op">~</span><span class="va">id1</span>,                           <span class="op">~</span><span class="va">sample</span>,          <span class="op">~</span><span class="va">fraction</span>,
      <span class="co"># metadata (row-by-row)</span>
      <span class="st">"OG268_CZO-SJER_F1"</span>,            <span class="st">"SJER"</span>,           <span class="st">"F1"</span>,
      <span class="st">"OG271_CZO-CTNA_F1"</span>,            <span class="st">"CTNA"</span>,           <span class="st">"F1"</span>,
      <span class="st">"OG281_CZO-Niwot_Tundra2_F1"</span>,   <span class="st">"Niwot_Tundra2"</span>,  <span class="st">"F1"</span>,
      <span class="st">"OG282_CZO-Niwot_Tundra1_F1"</span>,   <span class="st">"Niwot_Tundra1"</span>,  <span class="st">"F1"</span>
    <span class="op">)</span>,
    join_by <span class="op">=</span> <span class="st">"id1"</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># focus only on the relevant file info, discarding the rest</span>
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_select_file_info.html">iso_select_file_info</a></span><span class="op">(</span>
    <span class="va">folder</span>, <span class="va">Analysis</span>, <span class="va">file_datetime</span>, <span class="va">id1</span>, <span class="va">id2</span>, <span class="va">type</span>, <span class="va">sample</span>, 
    <span class="va">seed_oxidation</span>, <span class="va">injection_volume</span>, <span class="va">concentration</span>, <span class="va">volume</span>
  <span class="op">)</span>
<span class="co">#&gt; Info: setting peak table for 45 file(s) from vendor data table with the following renames:</span>
<span class="co">#&gt; - for 45 file(s): 'Nr.'-&gt;'peak_nr', 'Is Ref.?'-&gt;'is_ref', 'Start'-&gt;'rt_start', 'Rt'-&gt;'rt', 'End'-&gt;'rt_end', 'Ampl 44'-&gt;'amp44', 'Ampl 45'-&gt;'amp45', 'Ampl 46'-&gt;'amp46', 'BGD 44'-&gt;'bgrd44_start', 'BGD 45'-&gt;'bgrd45_start', 'BGD 46'-&gt;'bgrd46_start', 'BGD 44'-&gt;'bgrd44_end', 'BGD 45'-&gt;'bgrd45_end', 'BGD 46'-&gt;'bgrd46_end', 'rIntensity 44'-&gt;'area44', 'rIntensity 45'-&gt;'area45', 'rIntensity 46'-&gt;'area46', 'rR 45CO2/44CO2'-&gt;'r45/44', 'rR 46CO2/44CO2'-&gt;'r46/44', 'rd 45CO2/44CO2'-&gt;'rd45/44', 'rd 46CO2/44CO2'-&gt;'rd46/44', 'd 45CO2/44CO2'-&gt;'d45/44', 'd 46CO2/44CO2'-&gt;'d46/44', 'd 13C/12C'-&gt;'d13C', 'd 18O/16O'-&gt;'d18O', 'd 17O/16O'-&gt;'d17O', 'AT% 13C/12C'-&gt;'at13C', 'AT% 18O/16O'-&gt;'at18O'</span>
<span class="co">#&gt; Info: converting peak table column units where applicable from 'mV'-&gt;'V' and 'mVs'-&gt;'Vs' for columns matching 'everything()'</span>
<span class="co">#&gt; Info: renaming the following file info across 45 data file(s): 'Identifier 1'-&gt;'id1', 'Identifier 2'-&gt;'id2'</span>
<span class="co">#&gt; Info: parsing 1 file info columns for 45 data file(s):</span>
<span class="co">#&gt;  - to number: 'Analysis'</span>
<span class="co">#&gt; Info: mutating file info for 45 data file(s)</span>
<span class="co">#&gt; Info: adding new file information ('sample', 'fraction') to 45 data file(s), joining by 'id1'...</span>
<span class="co">#&gt;  - 'id1' join: 4/4 new info rows matched 4/45 data files</span>
<span class="co">#&gt; Info: selecting/renaming the following file info across 45 data file(s): 'folder', 'Analysis', 'file_datetime', 'id1', 'id2', 'type', 'sample', 'seed_oxidation', 'injection_volume', 'concentration', 'volume'</span></code></pre></div>
</div>
<div id="show-file-information" class="section level2">
<h2 class="hasAnchor">
<a href="#show-file-information" class="anchor"></a>Show file information</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># display file information</span>
<span class="va">iso_files</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_get_file_info.html">iso_get_file_info</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">file_id</span>, <span class="op">-</span><span class="va">folder</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_make_units_explicit.html">iso_make_units_explicit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Info: aggregating file info from 45 data file(s)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="5%">
<col width="12%">
<col width="17%">
<col width="3%">
<col width="4%">
<col width="9%">
<col width="9%">
<col width="14%">
<col width="14%">
<col width="7%">
</colgroup>
<thead><tr class="header">
<th align="right">Analysis</th>
<th align="left">file_datetime</th>
<th align="left">id1</th>
<th align="left">id2</th>
<th align="left">type</th>
<th align="left">sample</th>
<th align="left">seed_oxidation</th>
<th align="right">injection_volume [uL]</th>
<th align="right">concentration [ng/uL]</th>
<th align="right">volume [uL]</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2026</td>
<td align="left">2017-10-26 02:22:23</td>
<td align="left">CO2 zero</td>
<td align="left">6V</td>
<td align="left">on_off</td>
<td align="left">NA</td>
<td align="left">no</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2030</td>
<td align="left">2017-10-26 02:55:44</td>
<td align="left">Linearity CO2</td>
<td align="left">NA</td>
<td align="left">lin</td>
<td align="left">NA</td>
<td align="left">no</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2034</td>
<td align="left">2017-10-26 09:15:48</td>
<td align="left">A5</td>
<td align="left">0.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2041</td>
<td align="left">2017-10-26 20:50:38</td>
<td align="left">A5</td>
<td align="left">3ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">no</td>
<td align="right">3.0</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2047</td>
<td align="left">2017-10-27 05:50:04</td>
<td align="left">A5</td>
<td align="left">3ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2061</td>
<td align="left">2017-10-28 01:29:27</td>
<td align="left">OG271_CZO-CTNA_F1</td>
<td align="left">1.5uL</td>
<td align="left">sample</td>
<td align="left">CTNA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">NA</td>
<td align="right">25</td>
</tr>
<tr class="odd">
<td align="right">2093</td>
<td align="left">2017-10-30 00:32:04</td>
<td align="left">A5</td>
<td align="left">0.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2099</td>
<td align="left">2017-10-30 10:33:19</td>
<td align="left">A5</td>
<td align="left">0.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2106</td>
<td align="left">2017-10-30 22:25:45</td>
<td align="left">OG281_CZO-Niwot_Tundra2_F1</td>
<td align="left">1.5uL</td>
<td align="left">sample</td>
<td align="left">Niwot_Tundra2</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">NA</td>
<td align="right">150</td>
</tr>
<tr class="even">
<td align="right">2114</td>
<td align="left">2017-10-31 10:08:42</td>
<td align="left">A5</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2132</td>
<td align="left">2017-11-01 18:33:25</td>
<td align="left">A5 conc</td>
<td align="left">1ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">140</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2138</td>
<td align="left">2017-11-02 07:48:12</td>
<td align="left">A5 conc</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">140</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2027</td>
<td align="left">2017-10-26 02:30:42</td>
<td align="left">CO2 zero</td>
<td align="left">3V</td>
<td align="left">on_off</td>
<td align="left">NA</td>
<td align="left">no</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2031</td>
<td align="left">2017-10-26 04:30:54</td>
<td align="left">A5</td>
<td align="left">0.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2035</td>
<td align="left">2017-10-26 10:50:43</td>
<td align="left">A5</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2044</td>
<td align="left">2017-10-27 00:23:25</td>
<td align="left">A5</td>
<td align="left">4.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">no</td>
<td align="right">4.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2053</td>
<td align="left">2017-10-27 14:49:22</td>
<td align="left">OG268_CZO-SJER_F1</td>
<td align="left">1.5uL</td>
<td align="left">sample</td>
<td align="left">SJER</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">NA</td>
<td align="right">50</td>
</tr>
<tr class="even">
<td align="right">2069</td>
<td align="left">2017-10-28 12:37:31</td>
<td align="left">A5</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2096</td>
<td align="left">2017-10-30 05:48:23</td>
<td align="left">A5</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2100</td>
<td align="left">2017-10-30 12:08:16</td>
<td align="left">A5</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2107</td>
<td align="left">2017-10-31 00:00:40</td>
<td align="left">OG282_CZO-Niwot_Tundra1_F1</td>
<td align="left">1.5uL</td>
<td align="left">sample</td>
<td align="left">Niwot_Tundra1</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">NA</td>
<td align="right">150</td>
</tr>
<tr class="even">
<td align="right">2115</td>
<td align="left">2017-10-31 11:43:46</td>
<td align="left">A5</td>
<td align="left">3ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2139</td>
<td align="left">2017-11-02 15:13:36</td>
<td align="left">A5 conc</td>
<td align="left">1ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">140</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2028</td>
<td align="left">2017-10-26 02:39:02</td>
<td align="left">CO2 zero</td>
<td align="left">1.2V</td>
<td align="left">on_off</td>
<td align="left">NA</td>
<td align="left">no</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2032</td>
<td align="left">2017-10-26 06:05:49</td>
<td align="left">A5</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2036</td>
<td align="left">2017-10-26 12:25:48</td>
<td align="left">A5</td>
<td align="left">3ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2045</td>
<td align="left">2017-10-27 02:40:08</td>
<td align="left">A5</td>
<td align="left">0.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2056</td>
<td align="left">2017-10-27 19:34:08</td>
<td align="left">A5</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2075</td>
<td align="left">2017-10-28 20:27:22</td>
<td align="left">A5</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2097</td>
<td align="left">2017-10-30 07:23:28</td>
<td align="left">A5</td>
<td align="left">3ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2101</td>
<td align="left">2017-10-30 13:43:23</td>
<td align="left">A5</td>
<td align="left">3ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2116</td>
<td align="left">2017-10-31 13:18:39</td>
<td align="left">A5 conc</td>
<td align="left">1ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">140</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2136</td>
<td align="left">2017-11-02 04:38:25</td>
<td align="left">A5 conc</td>
<td align="left">0.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">140</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2140</td>
<td align="left">2017-11-02 16:48:30</td>
<td align="left">A5 conc</td>
<td align="left">2ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">2.0</td>
<td align="right">140</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2029</td>
<td align="left">2017-10-26 02:47:22</td>
<td align="left">CO2 zero</td>
<td align="left">0.7V</td>
<td align="left">on_off</td>
<td align="left">NA</td>
<td align="left">no</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2033</td>
<td align="left">2017-10-26 07:40:55</td>
<td align="left">A5</td>
<td align="left">3ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2040</td>
<td align="left">2017-10-26 19:07:47</td>
<td align="left">A5</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2046</td>
<td align="left">2017-10-27 04:15:02</td>
<td align="left">A5</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2060</td>
<td align="left">2017-10-27 23:54:33</td>
<td align="left">A5 conc</td>
<td align="left">1ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">no</td>
<td align="right">1.0</td>
<td align="right">140</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2086</td>
<td align="left">2017-10-29 13:58:06</td>
<td align="left">A5</td>
<td align="left">1.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2098</td>
<td align="left">2017-10-30 08:58:24</td>
<td align="left">A5 conc</td>
<td align="left">1ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">140</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2102</td>
<td align="left">2017-10-30 15:18:16</td>
<td align="left">A5 conc</td>
<td align="left">1ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">140</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2113</td>
<td align="left">2017-10-31 08:33:47</td>
<td align="left">A5</td>
<td align="left">0.5ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">14</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2117</td>
<td align="left">2017-10-31 14:53:43</td>
<td align="left">A5 conc</td>
<td align="left">3ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">140</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2137</td>
<td align="left">2017-11-02 06:13:18</td>
<td align="left">A5 conc</td>
<td align="left">1ul</td>
<td align="left">std</td>
<td align="left">NA</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">140</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="example-chromatograms" class="section level2">
<h2 class="hasAnchor">
<a href="#example-chromatograms" class="anchor"></a>Example chromatograms</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plot the chromatograms</span>
<span class="fu"><a href="../reference/iso_plot_continuous_flow_data.html">iso_plot_continuous_flow_data</a></span><span class="op">(</span>
  <span class="co"># select a few analyses (these #s must exist!)</span>
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_filter_files.html">iso_filter_files</a></span><span class="op">(</span><span class="va">iso_files</span>, <span class="va">Analysis</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2046</span>, <span class="fl">2106</span>, <span class="fl">2107</span><span class="op">)</span><span class="op">)</span>,
  <span class="co"># select data and aesthetics</span>
  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">44</span><span class="op">)</span>, color <span class="op">=</span> <span class="va">id1</span>, panel <span class="op">=</span> <span class="va">Analysis</span>,
  <span class="co"># zoom in on time interval</span>
  time_interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">3200</span><span class="op">)</span>,
  <span class="co"># peak labels for all peaks &gt; 2V</span>
  peak_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_format.html">iso_format</a></span><span class="op">(</span><span class="va">rt</span>, <span class="va">d13C</span>, signif <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,
  peak_label_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,
  peak_label_filter <span class="op">=</span> <span class="va">amp44</span> <span class="op">&gt;</span> <span class="fl">2000</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="co"># customize resulting ggplot</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span>
<span class="co">#&gt; Info: applying file filter, keeping 3 of 45 files</span></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/example_chromatograms-1.png" width="768"></p>
</div>
</div>
<div id="onoffs" class="section level1">
<h1 class="hasAnchor">
<a href="#onoffs" class="anchor"></a>ON/OFFs</h1>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># find files with zero in the Identifier 1 field</span>
<span class="va">on_offs</span> <span class="op">&lt;-</span> <span class="va">iso_files</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_filter_files.html">iso_filter_files</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"on_off"</span><span class="op">)</span> 
<span class="co">#&gt; Info: applying file filter, keeping 4 of 45 files</span>

<span class="co"># visualize the on/offs  </span>
<span class="fu"><a href="../reference/iso_plot_continuous_flow_data.html">iso_plot_continuous_flow_data</a></span><span class="op">(</span><span class="va">on_offs</span>, data <span class="op">=</span> <span class="fl">44</span>, color <span class="op">=</span> <span class="va">id2</span><span class="op">)</span></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/on_off_chromatograms-1.png" width="768"></p>
<div id="summary" class="section level2">
<h2 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculate on/off summary</span>
<span class="va">on_off_summary</span> <span class="op">&lt;-</span> 
  <span class="va">on_offs</span> <span class="op">%&gt;%</span> 
  <span class="co"># retrieve peak table</span>
  <span class="fu"><a href="../reference/iso_get_peak_table.html">iso_get_peak_table</a></span><span class="op">(</span>
    select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">amp44</span>, <span class="va">area44</span>, <span class="va">d13C</span><span class="op">)</span>,
    include_file_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">file_datetime</span>, <span class="va">id2</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># summarize information</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">file_datetime</span>, <span class="va">id2</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_summarize_data_table.html">iso_summarize_data_table</a></span><span class="op">(</span><span class="op">)</span> 
<span class="co">#&gt; Info: aggregating peak table from 4 data file(s), including file info 'c(file_datetime, id2)'</span>
  

<span class="co"># table</span>
<span class="va">on_off_summary</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_make_units_explicit.html">iso_make_units_explicit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="18%">
<col width="4%">
<col width="2%">
<col width="14%">
<col width="8%">
<col width="16%">
<col width="9%">
<col width="17%">
<col width="7%">
</colgroup>
<thead><tr class="header">
<th align="left">file_datetime</th>
<th align="left">id2</th>
<th align="right">n</th>
<th align="right">amp44 mean [V]</th>
<th align="right">amp44 sd</th>
<th align="right">area44 mean [Vs]</th>
<th align="right">area44 sd</th>
<th align="right">d13C mean [permil]</th>
<th align="right">d13C sd</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">2017-10-26 02:22:23</td>
<td align="left">6V</td>
<td align="right">10</td>
<td align="right">6.091</td>
<td align="right">0.010</td>
<td align="right">112.848</td>
<td align="right">0.330</td>
<td align="right">0.006</td>
<td align="right">0.012</td>
</tr>
<tr class="even">
<td align="left">2017-10-26 02:30:42</td>
<td align="left">3V</td>
<td align="right">10</td>
<td align="right">3.201</td>
<td align="right">0.003</td>
<td align="right">59.386</td>
<td align="right">0.141</td>
<td align="right">0.001</td>
<td align="right">0.018</td>
</tr>
<tr class="odd">
<td align="left">2017-10-26 02:39:02</td>
<td align="left">1.2V</td>
<td align="right">10</td>
<td align="right">1.183</td>
<td align="right">0.001</td>
<td align="right">21.968</td>
<td align="right">0.054</td>
<td align="right">-0.006</td>
<td align="right">0.024</td>
</tr>
<tr class="even">
<td align="left">2017-10-26 02:47:22</td>
<td align="left">0.7V</td>
<td align="right">10</td>
<td align="right">0.681</td>
<td align="right">0.001</td>
<td align="right">12.638</td>
<td align="right">0.030</td>
<td align="right">-0.031</td>
<td align="right">0.052</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># plot</span>
<span class="va">on_off_summary</span> <span class="op">%&gt;%</span> 
  <span class="co"># use generic data plot function</span>
  <span class="fu"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">file_datetime</span>, y <span class="op">=</span> <span class="va">`d13C sd`</span>,
    size <span class="op">=</span> <span class="va">`amp44 mean`</span>, color <span class="op">=</span> <span class="va">id2</span>,
    points <span class="op">=</span> <span class="cn">TRUE</span>,
    date_labels <span class="op">=</span> <span class="st">"%b %d - %H:%M"</span>
  <span class="op">)</span> <span class="op">+</span> 
  <span class="co"># customize resulting ggplot</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html">expand_limits</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> </code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/on_off_summary-1.png" width="576"></p>
</div>
</div>
<div id="linearity" class="section level1">
<h1 class="hasAnchor">
<a href="#linearity" class="anchor"></a>Linearity</h1>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># find files with linearity in the Identifier 1 field</span>
<span class="va">lins</span> <span class="op">&lt;-</span> <span class="va">iso_files</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_filter_files.html">iso_filter_files</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"lin"</span><span class="op">)</span> 
<span class="co">#&gt; Info: applying file filter, keeping 1 of 45 files</span>

<span class="co"># visualize the linearity runs</span>
<span class="fu"><a href="../reference/iso_plot_continuous_flow_data.html">iso_plot_continuous_flow_data</a></span><span class="op">(</span><span class="va">lins</span>, data <span class="op">=</span> <span class="fl">44</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">file_datetime</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/linearity_chromatograms-1.png" width="768"></p>
<div id="summary-1" class="section level2">
<h2 class="hasAnchor">
<a href="#summary-1" class="anchor"></a>Summary</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculate linearity summary</span>
<span class="va">linearity_summary</span> <span class="op">&lt;-</span> 
  <span class="va">lins</span> <span class="op">%&gt;%</span> 
  <span class="co"># retrieve data table</span>
  <span class="fu"><a href="../reference/iso_get_peak_table.html">iso_get_peak_table</a></span><span class="op">(</span>
    select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">amp44</span>, <span class="va">area44</span>, <span class="va">d13C</span><span class="op">)</span>,
    include_file_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">file_datetime</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># calculate linearity regression lines</span>
  <span class="fu">nest</span><span class="op">(</span>data <span class="op">=</span> <span class="op">-</span><span class="va">file_datetime</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    fit <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">d13C</span> <span class="op">~</span> <span class="va">amp44</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_strip_units.html">iso_strip_units</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
    coefs <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">fit</span>, <span class="fu">broom</span><span class="fu">::</span><span class="va"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">)</span>
  <span class="op">)</span>
<span class="co">#&gt; Info: aggregating peak table from 1 data file(s), including file info 'c(file_datetime)'</span>

<span class="co"># table</span>
<span class="va">linearity_summary</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span><span class="va">coefs</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">file_datetime</span>, <span class="va">term</span>, <span class="va">estimate</span>, <span class="va">std.error</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">term</span> <span class="op">==</span> <span class="st">"amp44"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    term <span class="op">=</span> <span class="st">"linearity [permil/V]"</span>,
    estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="va">estimate</span>, <span class="fl">2</span><span class="op">)</span>,
    std.error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="va">std.error</span>, <span class="fl">1</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">file_datetime</th>
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">2017-10-26 02:55:44</td>
<td align="left">linearity [permil/V]</td>
<td align="right">-0.017</td>
<td align="right">0.001</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># plot</span>
<span class="va">linearity_summary</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># use generic data plot function</span>
  <span class="fu"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">amp44</span>, y <span class="op">=</span> <span class="va">d13C</span>,
    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">file_datetime</span><span class="op">)</span>,
    points <span class="op">=</span> <span class="cn">TRUE</span>,
    panel <span class="op">=</span> <span class="va">file_datetime</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span>
  <span class="op">)</span>
<span class="co">#&gt; `geom_smooth()` using formula 'y ~ x'</span></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/linearity_summary-1.png" width="672"></p>
</div>
</div>
<div id="samples-and-standards" class="section level1">
<h1 class="hasAnchor">
<a href="#samples-and-standards" class="anchor"></a>Samples and Standards</h1>
<div id="load-peak-maps" class="section level2">
<h2 class="hasAnchor">
<a href="#load-peak-maps" class="anchor"></a>Load peak maps</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># this information is often maintained in a csv or Excel file instead</span>
<span class="co"># but generated here from scratch for demonstration purposes</span>
<span class="va">peak_maps</span> <span class="op">&lt;-</span> 
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
    <span class="co"># column names -&gt; defining 2 peak maps, 'std' and 'sample' here</span>
    <span class="co"># but could define an unlimited number of different maps</span>
    <span class="op">~</span><span class="va">compound</span>, <span class="op">~</span><span class="va">ref_nr</span>, <span class="op">~</span><span class="va">`rt:std`</span>,  <span class="op">~</span><span class="va">`rt:sample`</span>,
    <span class="co"># peak map data (row-by-row)</span>
    <span class="st">"CO2"</span>,          <span class="fl">1</span>,        <span class="fl">79</span>,                 <span class="fl">79</span>,
    <span class="st">"CO2"</span>,          <span class="fl">2</span>,      <span class="fl">178</span>,                <span class="fl">178</span>,
    <span class="st">"CO2"</span>,          <span class="fl">3</span>,      <span class="fl">278</span>,                <span class="fl">278</span>,
    <span class="st">"CO2"</span>,          <span class="fl">4</span>,      <span class="fl">377</span>,                <span class="fl">377</span>,
    <span class="st">"CO2"</span>,          <span class="fl">5</span>,      <span class="fl">477</span>,                <span class="fl">477</span>,
    <span class="st">"CO2"</span>,          <span class="fl">6</span>,      <span class="fl">576</span>,                <span class="fl">576</span>,
    <span class="st">"CO2"</span>,          <span class="fl">7</span>,      <span class="fl">676</span>,                <span class="fl">676</span>,
    <span class="st">"CO2"</span>,          <span class="fl">8</span>,      <span class="fl">775</span>,                <span class="fl">775</span>,
    <span class="st">"CO2"</span>,          <span class="fl">9</span>,      <span class="fl">875</span>,                <span class="fl">875</span>,
    <span class="st">"nC16"</span>,         <span class="cn">NA</span>,     <span class="fl">1156</span>,               <span class="fl">1156</span>,
    <span class="st">"nC17"</span>,         <span class="cn">NA</span>,     <span class="fl">1280</span>,               <span class="fl">1280</span>,
    <span class="st">"nC18"</span>,         <span class="cn">NA</span>,     <span class="fl">1409</span>,               <span class="fl">1409</span>,
    <span class="st">"nC19"</span>,         <span class="cn">NA</span>,     <span class="fl">1540</span>,               <span class="fl">1540</span>,
    <span class="st">"nC20"</span>,         <span class="cn">NA</span>,     <span class="fl">1670</span>,               <span class="fl">1670</span>,
    <span class="st">"nC21"</span>,         <span class="cn">NA</span>,     <span class="fl">1797</span>,               <span class="fl">1797</span>,
    <span class="st">"nC22"</span>,         <span class="cn">NA</span>,     <span class="fl">1921</span>,               <span class="fl">1921</span>,
    <span class="st">"nC23"</span>,         <span class="cn">NA</span>,     <span class="fl">2040</span>,               <span class="fl">2040</span>,
    <span class="st">"nC24"</span>,         <span class="cn">NA</span>,     <span class="fl">2156</span>,               <span class="fl">2156</span>,
    <span class="st">"nC25"</span>,         <span class="cn">NA</span>,     <span class="fl">2267</span>,               <span class="fl">2267</span>,
    <span class="st">"nC26"</span>,         <span class="cn">NA</span>,     <span class="fl">2375</span>,               <span class="fl">2375</span>,
    <span class="st">"nC27"</span>,         <span class="cn">NA</span>,     <span class="fl">2479</span>,               <span class="fl">2479</span>,
    <span class="st">"nC28"</span>,         <span class="cn">NA</span>,     <span class="fl">2580</span>,               <span class="fl">2580</span>,
    <span class="st">"nC29"</span>,         <span class="cn">NA</span>,     <span class="fl">2674</span>,               <span class="fl">2678</span>,
    <span class="st">"nC30"</span>,         <span class="cn">NA</span>,     <span class="fl">2770</span>,               <span class="fl">2773</span>,
    <span class="st">"nC31"</span>,         <span class="cn">NA</span>,     <span class="cn">NA</span>,               <span class="fl">2863</span>,
    <span class="st">"CO2"</span>,          <span class="fl">10</span>,     <span class="fl">3552</span>,               <span class="fl">3552</span>,
    <span class="st">"CO2"</span>,          <span class="fl">11</span>,     <span class="fl">3592</span>,               <span class="fl">3592</span>
  <span class="op">)</span>
<span class="va">peak_maps</span> <span class="op">%&gt;%</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">compound</th>
<th align="right">ref_nr</th>
<th align="right">rt:std</th>
<th align="right">rt:sample</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">CO2</td>
<td align="right">1</td>
<td align="right">79</td>
<td align="right">79</td>
</tr>
<tr class="even">
<td align="left">CO2</td>
<td align="right">2</td>
<td align="right">178</td>
<td align="right">178</td>
</tr>
<tr class="odd">
<td align="left">CO2</td>
<td align="right">3</td>
<td align="right">278</td>
<td align="right">278</td>
</tr>
<tr class="even">
<td align="left">CO2</td>
<td align="right">4</td>
<td align="right">377</td>
<td align="right">377</td>
</tr>
<tr class="odd">
<td align="left">CO2</td>
<td align="right">5</td>
<td align="right">477</td>
<td align="right">477</td>
</tr>
<tr class="even">
<td align="left">CO2</td>
<td align="right">6</td>
<td align="right">576</td>
<td align="right">576</td>
</tr>
<tr class="odd">
<td align="left">CO2</td>
<td align="right">7</td>
<td align="right">676</td>
<td align="right">676</td>
</tr>
<tr class="even">
<td align="left">CO2</td>
<td align="right">8</td>
<td align="right">775</td>
<td align="right">775</td>
</tr>
<tr class="odd">
<td align="left">CO2</td>
<td align="right">9</td>
<td align="right">875</td>
<td align="right">875</td>
</tr>
<tr class="even">
<td align="left">nC16</td>
<td align="right">NA</td>
<td align="right">1156</td>
<td align="right">1156</td>
</tr>
<tr class="odd">
<td align="left">nC17</td>
<td align="right">NA</td>
<td align="right">1280</td>
<td align="right">1280</td>
</tr>
<tr class="even">
<td align="left">nC18</td>
<td align="right">NA</td>
<td align="right">1409</td>
<td align="right">1409</td>
</tr>
<tr class="odd">
<td align="left">nC19</td>
<td align="right">NA</td>
<td align="right">1540</td>
<td align="right">1540</td>
</tr>
<tr class="even">
<td align="left">nC20</td>
<td align="right">NA</td>
<td align="right">1670</td>
<td align="right">1670</td>
</tr>
<tr class="odd">
<td align="left">nC21</td>
<td align="right">NA</td>
<td align="right">1797</td>
<td align="right">1797</td>
</tr>
<tr class="even">
<td align="left">nC22</td>
<td align="right">NA</td>
<td align="right">1921</td>
<td align="right">1921</td>
</tr>
<tr class="odd">
<td align="left">nC23</td>
<td align="right">NA</td>
<td align="right">2040</td>
<td align="right">2040</td>
</tr>
<tr class="even">
<td align="left">nC24</td>
<td align="right">NA</td>
<td align="right">2156</td>
<td align="right">2156</td>
</tr>
<tr class="odd">
<td align="left">nC25</td>
<td align="right">NA</td>
<td align="right">2267</td>
<td align="right">2267</td>
</tr>
<tr class="even">
<td align="left">nC26</td>
<td align="right">NA</td>
<td align="right">2375</td>
<td align="right">2375</td>
</tr>
<tr class="odd">
<td align="left">nC27</td>
<td align="right">NA</td>
<td align="right">2479</td>
<td align="right">2479</td>
</tr>
<tr class="even">
<td align="left">nC28</td>
<td align="right">NA</td>
<td align="right">2580</td>
<td align="right">2580</td>
</tr>
<tr class="odd">
<td align="left">nC29</td>
<td align="right">NA</td>
<td align="right">2674</td>
<td align="right">2678</td>
</tr>
<tr class="even">
<td align="left">nC30</td>
<td align="right">NA</td>
<td align="right">2770</td>
<td align="right">2773</td>
</tr>
<tr class="odd">
<td align="left">nC31</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">2863</td>
</tr>
<tr class="even">
<td align="left">CO2</td>
<td align="right">10</td>
<td align="right">3552</td>
<td align="right">3552</td>
</tr>
<tr class="odd">
<td align="left">CO2</td>
<td align="right">11</td>
<td align="right">3592</td>
<td align="right">3592</td>
</tr>
</tbody>
</table>
</div>
<div id="fetch-peak-table" class="section level2">
<h2 class="hasAnchor">
<a href="#fetch-peak-table" class="anchor"></a>Fetch peak table (*)</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># identify peaks</span>
<span class="va">peak_table_w_ids</span> <span class="op">&lt;-</span> <span class="va">iso_files</span> <span class="op">%&gt;%</span> 
  <span class="co"># focus on standards and samples only</span>
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_filter_files.html">iso_filter_files</a></span><span class="op">(</span><span class="va">type</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"std"</span>, <span class="st">"sample"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># filter out analyses that</span>
  <span class="co">## a) did not inject</span>
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_filter_files.html">iso_filter_files</a></span><span class="op">(</span><span class="op">!</span><span class="va">Analysis</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2031</span>, <span class="fl">2040</span>, <span class="fl">2069</span>, <span class="fl">2098</span>, <span class="fl">2116</span>, <span class="fl">2138</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co">## b) had double or rogue peaks from mis-injection</span>
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_filter_files.html">iso_filter_files</a></span><span class="op">(</span><span class="op">!</span><span class="va">Analysis</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2044</span>, <span class="fl">2132</span>, <span class="fl">2134</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># map peaks</span>
  <span class="fu"><a href="../reference/iso_map_peaks.html">iso_map_peaks</a></span><span class="op">(</span><span class="va">peak_maps</span>, map_id <span class="op">=</span> <span class="va">type</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># peak table</span>
  <span class="fu"><a href="../reference/iso_get_peak_table.html">iso_get_peak_table</a></span><span class="op">(</span>include_file_info <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Info: applying file filter, keeping 40 of 45 files</span>
<span class="co">#&gt; Info: applying file filter, keeping 34 of 40 files</span>
<span class="co">#&gt; Info: applying file filter, keeping 32 of 34 files</span>
<span class="co">#&gt; Info: 829 of 973 peaks in 32 files were successfully mapped using 2 peak maps ('std', 'sample'). 144 peak(s) could not be mapped. 7 expected peak(s) are missing.</span>
<span class="co">#&gt; Info: aggregating peak table from 32 data file(s), including file info 'everything()'</span></code></pre></div>
</div>
<div id="inspect-peak-mappings" class="section level2">
<h2 class="hasAnchor">
<a href="#inspect-peak-mappings" class="anchor"></a>Inspect peak mappings</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># use same plotting as earlier, except now with peak features added in</span>
<span class="va">iso_files</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_filter_files.html">iso_filter_files</a></span><span class="op">(</span><span class="va">Analysis</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2046</span>, <span class="fl">2106</span>, <span class="fl">2107</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_plot_continuous_flow_data.html">iso_plot_continuous_flow_data</a></span><span class="op">(</span>
    <span class="co"># select data and aesthetics</span>
    data <span class="op">=</span> <span class="fl">44</span>, color <span class="op">=</span> <span class="va">id1</span>, panel <span class="op">=</span> <span class="va">Analysis</span>,
    <span class="co"># zoom in on time interval</span>
    time_interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">3200</span><span class="op">)</span>,
    <span class="co"># provide our peak table with ids</span>
    peak_table <span class="op">=</span> <span class="va">peak_table_w_ids</span>, 
    <span class="co"># define peak labels, this can be any valid expression</span>
    peak_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_format.html">iso_format</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">peak_info</span>, <span class="va">d13C</span><span class="op">)</span>, 
    <span class="co"># specify which labels to show (removing the !is_identified or putting a </span>
    <span class="co"># restriction by retention time can help a lot with busy chromatograms)</span>
    peak_label_filter <span class="op">=</span> <span class="va">is_identified</span> <span class="op">|</span> <span class="op">!</span><span class="va">is_identified</span> <span class="op">|</span> <span class="va">is_missing</span>
  <span class="op">)</span>  <span class="op">+</span>
  <span class="co"># customize resulting ggplot</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span>
<span class="co">#&gt; Info: applying file filter, keeping 3 of 45 files</span>
<span class="co">#&gt; Warning: ggrepel: 1 unlabeled data points (too many overlaps). Consider</span>
<span class="co">#&gt; increasing max.overlaps</span></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/example_chromatograms_with_peaks-1.png" width="768"></p>
</div>
<div id="overview-of-unclear-peak-mappings" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-of-unclear-peak-mappings" class="anchor"></a>Overview of unclear peak mappings</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># look at missing and unidentified peaks summary (not run during knitting)</span>
<span class="co"># -&gt; check if any of the missing peaks are unexpected (should be there but aren't)</span>
<span class="co"># -&gt; check if any unidentified peaks should be added to the peak maps</span>
<span class="co"># -&gt; check if any ambiguous peaks need clearer peak map retention times</span>
<span class="co"># when in doubt, look at the chromatograms of the problematic files!</span>
<span class="co"># as needed: iterate on peak map update, then peak mapping inspection</span>
<span class="va">peak_table_w_ids</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_get_problematic_peak_mappings.html">iso_get_problematic_peak_mappings</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_summarize_peak_mappings.html">iso_summarize_peak_mappings</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="reference-peaks" class="section level1">
<h1 class="hasAnchor">
<a href="#reference-peaks" class="anchor"></a>Reference peaks</h1>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># examine variation in the reference peaks</span>
<span class="va">peak_table_w_ids</span> <span class="op">%&gt;%</span> 
  <span class="co"># focus on reference peaks only</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">ref_nr</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># mark ref peak used for raw delta values (assuming the same in all anlysis)</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    ref_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">ref_nr</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">is_ref</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"*"</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">fct_inorder</span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># visualize</span>
  <span class="fu"><a href="../reference/iso_plot_ref_peaks.html">iso_plot_ref_peaks</a></span><span class="op">(</span>
    <span class="co"># specify the ratios to visualize</span>
    x <span class="op">=</span> <span class="va">Analysis</span>, ratio <span class="op">=</span> <span class="va">`r45/44`</span>, fill <span class="op">=</span> <span class="va">ref_info</span>,
    panel_scales <span class="op">=</span> <span class="st">"fixed"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Analysis"</span>, fill <span class="op">=</span> <span class="st">"Reference\npeak"</span><span class="op">)</span></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/ref_peak_variation-1.png" width="960"></p>
</div>
<div id="analyte-peaks" class="section level1">
<h1 class="hasAnchor">
<a href="#analyte-peaks" class="anchor"></a>Analyte peaks</h1>
<div id="select-analyte-peaks" class="section level2">
<h2 class="hasAnchor">
<a href="#select-analyte-peaks" class="anchor"></a>Select analyte peaks (*)</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># focus on analyte peaks and calculate useful summary statistics</span>
<span class="va">peak_table_analytes</span> <span class="op">&lt;-</span> <span class="va">peak_table_w_ids</span> <span class="op">%&gt;%</span> 
  <span class="co"># omit reference peaks for further processing (i.e. analyte peaks only)</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">ref_nr</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># for each analysis, calculate a few useful summary statistics</span>
  <span class="fu"><a href="../reference/iso_mutate_peak_table.html">iso_mutate_peak_table</a></span><span class="op">(</span>
    group_by <span class="op">=</span> <span class="va">file_id</span>,
    rel_area <span class="op">=</span> <span class="va">area44</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">area44</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
    <span class="co"># calculate mean area for all peaks</span>
    mean_area <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">area44</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
    <span class="co"># calculate mean area and amplitude for identified peaks</span>
    mean_area_identified <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">area44</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">compound</span><span class="op">)</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
    mean_amp_identified <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">amp44</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">compound</span><span class="op">)</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="op">)</span>
<span class="co">#&gt; Info: mutating peak table grouped by 'file_id', column(s) 'rel_area', 'mean_area', 'mean_area_identified', 'mean_amp_identified' added.</span></code></pre></div>
</div>
<div id="first-look" class="section level2">
<h2 class="hasAnchor">
<a href="#first-look" class="anchor"></a>First look</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">peak_table_analytes</span> <span class="op">%&gt;%</span> 
  <span class="co"># focus on identified peaks (comment out this line to see ALL peaks)</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">compound</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># visualize with convenience function iso_plot_data</span>
  <span class="fu"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span><span class="op">(</span>
    <span class="co"># choose x and y (multiple y possible)</span>
    x <span class="op">=</span> <span class="va">area44</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">amp44</span>, <span class="va">d13C</span><span class="op">)</span>,
    <span class="co"># choose aesthetics</span>
    color <span class="op">=</span> <span class="va">compound</span>, shape <span class="op">=</span> <span class="va">type</span>, label <span class="op">=</span> <span class="va">compound</span>, size <span class="op">=</span> <span class="fl">3</span>,
    <span class="co"># decide what geoms to include</span>
    points <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="co"># further customize ggplot with a log scale x axis</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/first_look_sample_and_standard_peaks-1.png" width="672"></p>
</div>
<div id="optionally---use-interactive-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#optionally---use-interactive-plot" class="anchor"></a>Optionally - use interactive plot</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># optinally, use an interactive plot to explore your data</span>
<span class="co"># - make sure you install the plotly library --&gt; install.packages("plotly")</span>
<span class="co"># - switch to eval=TRUE in the options of this chunk to include in knit</span>
<span class="co"># - this should work for all plots in this example processing file</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com">plotly</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span>dynamicTicks <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div id="evaluate-signal-yield" class="section level2">
<h2 class="hasAnchor">
<a href="#evaluate-signal-yield" class="anchor"></a>Evaluate signal yield</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># evaluate yield</span>
<span class="co"># (only makes sense if both injection volume and concentration are available)</span>
<span class="va">peak_table_analytes</span> <span class="op">%&gt;%</span> 
  <span class="co"># focus on standards</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"std"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># calculate injection amount</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>injection <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_with_units.html">iso_double_with_units</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">injection_volume</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">concentration</span><span class="op">)</span>, units <span class="op">=</span> <span class="st">"ng"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># visualize</span>
  <span class="fu"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span><span class="op">(</span>
    <span class="co"># x and y</span>
    x <span class="op">=</span> <span class="va">injection</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">mean_area_identified</span>, <span class="va">mean_amp_identified</span><span class="op">)</span>,
    <span class="co"># aesthetics</span>
    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">injection_volume</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">concentration</span><span class="op">)</span>, 
    size <span class="op">=</span> <span class="va">file_datetime</span>,
    points <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="co"># modify plot with trendline and axis limits</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="cn">NULL</span>, shape <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html">expand_limits</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span>, x <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; `geom_smooth()` using formula 'y ~ x'</span></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/yield-1.png" width="672"></p>
</div>
</div>
<div id="isotope-standard-values" class="section level1">
<h1 class="hasAnchor">
<a href="#isotope-standard-values" class="anchor"></a>Isotope standard values</h1>
<div id="load-isotope-standards" class="section level2">
<h2 class="hasAnchor">
<a href="#load-isotope-standards" class="anchor"></a>Load isotope standards</h2>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># this information is often maintained in a csv or Excel file instead</span>
<span class="co"># but generated here from scratch for demonstration purposes</span>
<span class="va">standards</span> <span class="op">&lt;-</span> 
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
    <span class="op">~</span><span class="va">compound</span>,   <span class="op">~</span><span class="va">true_d13C</span>,
    <span class="st">"nC16"</span>,         <span class="op">-</span><span class="fl">26.15</span>,
    <span class="st">"nC17"</span>,         <span class="op">-</span><span class="fl">31.88</span>,
    <span class="st">"nC18"</span>,         <span class="op">-</span><span class="fl">32.70</span>,
    <span class="st">"nC19"</span>,         <span class="op">-</span><span class="fl">31.99</span>,
    <span class="st">"nC20"</span>,         <span class="op">-</span><span class="fl">33.97</span>,
    <span class="st">"nC21"</span>,         <span class="op">-</span><span class="fl">28.83</span>,
    <span class="st">"nC22"</span>,         <span class="op">-</span><span class="fl">33.77</span>,
    <span class="st">"nC23"</span>,         <span class="op">-</span><span class="fl">33.37</span>,
    <span class="st">"nC24"</span>,         <span class="op">-</span><span class="fl">32.13</span>,
    <span class="st">"nC25"</span>,         <span class="op">-</span><span class="fl">28.46</span>,
    <span class="st">"nC26"</span>,         <span class="op">-</span><span class="fl">32.94</span>,
    <span class="st">"nC27"</span>,         <span class="op">-</span><span class="fl">30.49</span>,
    <span class="st">"nC28"</span>,         <span class="op">-</span><span class="fl">33.20</span>,
    <span class="st">"nC29"</span>,         <span class="op">-</span><span class="fl">29.10</span>,
    <span class="st">"nC30"</span>,         <span class="op">-</span><span class="fl">29.84</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    type <span class="op">=</span> <span class="st">"std"</span>, 
    true_d13C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_with_units.html">iso_double_with_units</a></span><span class="op">(</span><span class="va">true_d13C</span>, <span class="st">"permil"</span><span class="op">)</span>
  <span class="op">)</span>
<span class="va">standards</span> <span class="op">%&gt;%</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">compound</th>
<th align="right">true_d13C</th>
<th align="left">type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">nC16</td>
<td align="right">-26.15</td>
<td align="left">std</td>
</tr>
<tr class="even">
<td align="left">nC17</td>
<td align="right">-31.88</td>
<td align="left">std</td>
</tr>
<tr class="odd">
<td align="left">nC18</td>
<td align="right">-32.70</td>
<td align="left">std</td>
</tr>
<tr class="even">
<td align="left">nC19</td>
<td align="right">-31.99</td>
<td align="left">std</td>
</tr>
<tr class="odd">
<td align="left">nC20</td>
<td align="right">-33.97</td>
<td align="left">std</td>
</tr>
<tr class="even">
<td align="left">nC21</td>
<td align="right">-28.83</td>
<td align="left">std</td>
</tr>
<tr class="odd">
<td align="left">nC22</td>
<td align="right">-33.77</td>
<td align="left">std</td>
</tr>
<tr class="even">
<td align="left">nC23</td>
<td align="right">-33.37</td>
<td align="left">std</td>
</tr>
<tr class="odd">
<td align="left">nC24</td>
<td align="right">-32.13</td>
<td align="left">std</td>
</tr>
<tr class="even">
<td align="left">nC25</td>
<td align="right">-28.46</td>
<td align="left">std</td>
</tr>
<tr class="odd">
<td align="left">nC26</td>
<td align="right">-32.94</td>
<td align="left">std</td>
</tr>
<tr class="even">
<td align="left">nC27</td>
<td align="right">-30.49</td>
<td align="left">std</td>
</tr>
<tr class="odd">
<td align="left">nC28</td>
<td align="right">-33.20</td>
<td align="left">std</td>
</tr>
<tr class="even">
<td align="left">nC29</td>
<td align="right">-29.10</td>
<td align="left">std</td>
</tr>
<tr class="odd">
<td align="left">nC30</td>
<td align="right">-29.84</td>
<td align="left">std</td>
</tr>
</tbody>
</table>
</div>
<div id="add-isotope-standards" class="section level2">
<h2 class="hasAnchor">
<a href="#add-isotope-standards" class="anchor"></a>Add isotope standards (*)</h2>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">peak_table_w_stds</span> <span class="op">&lt;-</span> 
  <span class="va">peak_table_analytes</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_add_standards.html">iso_add_standards</a></span><span class="op">(</span>stds <span class="op">=</span> <span class="va">standards</span>, match_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"type"</span>, <span class="st">"compound"</span><span class="op">)</span><span class="op">)</span> 
<span class="co">#&gt; Info: matching standards by 'type' and 'compound' - added 15 standard entries to 420 out of 628 rows, added new column 'is_std_peak' to identify standard peaks</span></code></pre></div>
</div>
</div>
<div id="calibration" class="section level1">
<h1 class="hasAnchor">
<a href="#calibration" class="anchor"></a>Calibration</h1>
<div id="single-analysis-calibration-for-qa" class="section level2">
<h2 class="hasAnchor">
<a href="#single-analysis-calibration-for-qa" class="anchor"></a>Single analysis calibration (for QA)</h2>
<div id="generate-calibrations" class="section level3">
<h3 class="hasAnchor">
<a href="#generate-calibrations" class="anchor"></a>Generate calibrations</h3>
<p>Determine calibrations fits for all individual standard analyses.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stds_w_calibs</span> <span class="op">&lt;-</span> <span class="va">peak_table_w_stds</span> <span class="op">%&gt;%</span>
  <span class="co"># focus on standards</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"std"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># remove unassigned peaks</span>
  <span class="fu"><a href="../reference/iso_remove_problematic_peak_mappings.html">iso_remove_problematic_peak_mappings</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># prepare for calibration by defining the grouping column(s) </span>
  <span class="fu"><a href="../reference/iso_prepare_for_calibration.html">iso_prepare_for_calibration</a></span><span class="op">(</span>group_by <span class="op">=</span> <span class="va">Analysis</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># run calibration</span>
  <span class="fu"><a href="../reference/iso_generate_calibration.html">iso_generate_calibration</a></span><span class="op">(</span>model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">d13C</span> <span class="op">~</span> <span class="va">true_d13C</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># unnest some useful file information for visualization</span>
  <span class="fu"><a href="../reference/iso_get_calibration_data.html">iso_get_calibration_data</a></span><span class="op">(</span>
    select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">file_datetime</span>, <span class="va">injection_volume</span>, <span class="va">seed_oxidation</span>, <span class="va">mean_area_identified</span><span class="op">)</span><span class="op">)</span> 
<span class="co">#&gt; Info: retrieving data column(s) 'c(file_datetime, injection_volume, seed_oxidation, mean_area_identified)', keeping remaining data in nested 'all_data'</span>
<span class="co">#&gt; Info: removing 6 of 426 peak table entries because of problematic peak identifications (unidentified, missing or ambiguous)</span>
<span class="co">#&gt; Info: preparing data for calibration by grouping based on 'Analysis'</span>
<span class="co">#&gt; Info: generating calibration based on 1 model ('lm(d13C ~ true_d13C)') for 28 data group(s) with standards filter 'is_std_peak'. Storing residuals in new column 'resid'. Storing calibration info in new column 'in_calib'.</span>

<span class="co"># check for problematic calibrations</span>
<span class="va">stds_w_calibs</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/iso_get_problematic_calibrations.html">iso_get_problematic_calibrations</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">problematic.calibs</span>
<span class="co">#&gt; Info: there were no problematic calibrations</span>
<span class="co"># View(problematic.calibs)</span>

<span class="co"># move forward only with good calibrations</span>
<span class="va">stds_w_calibs</span> <span class="op">&lt;-</span> <span class="va">stds_w_calibs</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/iso_remove_problematic_calibrations.html">iso_remove_problematic_calibrations</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Info: there are no problematic calibrations</span></code></pre></div>
</div>
<div id="coefficients" class="section level3">
<h3 class="hasAnchor">
<a href="#coefficients" class="anchor"></a>Coefficients</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># look at coefficients and summary</span>
<span class="va">stds_w_calibs</span> <span class="op">%&gt;%</span> 
  <span class="co"># unnest calibration parameters</span>
  <span class="fu"><a href="../reference/iso_get_calibration_parameters.html">iso_get_calibration_parameters</a></span><span class="op">(</span>
    select_from_coefs <span class="op">=</span> 
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">term</span>, <span class="va">estimate</span>, SE <span class="op">=</span> <span class="va">std.error</span>, <span class="va">signif</span><span class="op">)</span>,
    select_from_summary <span class="op">=</span> 
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>fit_R2 <span class="op">=</span> <span class="va">adj.r.squared</span>, fit_RSD <span class="op">=</span> <span class="va">sigma</span>, residual_df <span class="op">=</span> <span class="va">df.residual</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="co">#&gt; Info: retrieving coefficient column(s) 'c(term, estimate, SE = std.error, signif)' for calibration</span>
<span class="co">#&gt; Info: retrieving summary column(s) 'c(fit_R2 = adj.r.squared, fit_RSD = sigma, residual_df = df.residual)' for calibration</span></code></pre></div>
<table class="table">
<colgroup>
<col width="4%">
<col width="10%">
<col width="8%">
<col width="9%">
<col width="11%">
<col width="11%">
<col width="6%">
<col width="6%">
<col width="4%">
<col width="3%">
<col width="8%">
<col width="3%">
<col width="4%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th align="right">Analysis</th>
<th align="left">file_datetime</th>
<th align="left">seed_oxidation</th>
<th align="right">injection_volume</th>
<th align="right">mean_area_identified</th>
<th align="left">calib</th>
<th align="right">calib_points</th>
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="left">signif</th>
<th align="right">fit_R2</th>
<th align="right">fit_RSD</th>
<th align="right">residual_df</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2034</td>
<td align="left">2017-10-26 09:15:48</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">1.316609</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">11.2671</td>
<td align="right">0.9756</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9870</td>
<td align="right">0.2706</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2041</td>
<td align="left">2017-10-26 20:50:38</td>
<td align="left">no</td>
<td align="right">3.0</td>
<td align="right">10.728124</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">10.3123</td>
<td align="right">3.0026</td>
<td align="left">** (p &lt; 0.01)</td>
<td align="right">0.8869</td>
<td align="right">0.8330</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2047</td>
<td align="left">2017-10-27 05:50:04</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">13.834178</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">11.2081</td>
<td align="right">0.3546</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9983</td>
<td align="right">0.0984</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2093</td>
<td align="left">2017-10-30 00:32:04</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">2.032492</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">12.0237</td>
<td align="right">0.6659</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9941</td>
<td align="right">0.1847</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2099</td>
<td align="left">2017-10-30 10:33:19</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">2.497390</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">10.3700</td>
<td align="right">0.5911</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9949</td>
<td align="right">0.1640</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2114</td>
<td align="left">2017-10-31 10:08:42</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">5.675072</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">11.3763</td>
<td align="right">0.3359</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9984</td>
<td align="right">0.0932</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2035</td>
<td align="left">2017-10-26 10:50:43</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">5.356130</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">10.8131</td>
<td align="right">0.4285</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9974</td>
<td align="right">0.1189</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2096</td>
<td align="left">2017-10-30 05:48:23</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">8.855793</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">11.2949</td>
<td align="right">0.2081</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9994</td>
<td align="right">0.0577</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2100</td>
<td align="left">2017-10-30 12:08:16</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">9.864856</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">11.1531</td>
<td align="right">0.1618</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9996</td>
<td align="right">0.0449</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2115</td>
<td align="left">2017-10-31 11:43:46</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">10.838746</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">11.2240</td>
<td align="right">0.1824</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9995</td>
<td align="right">0.0506</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2139</td>
<td align="left">2017-11-02 15:13:36</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">29.445250</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">11.2577</td>
<td align="right">0.2570</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9991</td>
<td align="right">0.0713</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2032</td>
<td align="left">2017-10-26 06:05:49</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">5.237014</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">11.2381</td>
<td align="right">0.3698</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9981</td>
<td align="right">0.1026</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2036</td>
<td align="left">2017-10-26 12:25:48</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">10.256694</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">10.8792</td>
<td align="right">0.3646</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9981</td>
<td align="right">0.1011</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2045</td>
<td align="left">2017-10-27 02:40:08</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">1.786624</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">10.8889</td>
<td align="right">0.6412</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9943</td>
<td align="right">0.1779</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2056</td>
<td align="left">2017-10-27 19:34:08</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14.721991</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">11.0069</td>
<td align="right">0.3724</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9981</td>
<td align="right">0.1033</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2075</td>
<td align="left">2017-10-28 20:27:22</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">6.011649</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">11.2325</td>
<td align="right">0.3605</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9982</td>
<td align="right">0.1000</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2097</td>
<td align="left">2017-10-30 07:23:28</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">16.704496</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">11.3383</td>
<td align="right">0.2171</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9993</td>
<td align="right">0.0602</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2101</td>
<td align="left">2017-10-30 13:43:23</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">19.140429</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">11.0189</td>
<td align="right">0.1998</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9994</td>
<td align="right">0.0554</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2136</td>
<td align="left">2017-11-02 04:38:25</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">9.705883</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">10.9667</td>
<td align="right">0.1148</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9998</td>
<td align="right">0.0318</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2140</td>
<td align="left">2017-11-02 16:48:30</td>
<td align="left">yes</td>
<td align="right">2.0</td>
<td align="right">58.566406</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">10.7605</td>
<td align="right">0.1660</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9996</td>
<td align="right">0.0460</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2033</td>
<td align="left">2017-10-26 07:40:55</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">9.967239</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">11.0859</td>
<td align="right">0.4703</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9969</td>
<td align="right">0.1305</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2046</td>
<td align="left">2017-10-27 04:15:02</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">7.189101</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">11.1801</td>
<td align="right">0.4632</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9970</td>
<td align="right">0.1285</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2060</td>
<td align="left">2017-10-27 23:54:33</td>
<td align="left">no</td>
<td align="right">1.0</td>
<td align="right">34.014913</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">11.4129</td>
<td align="right">0.8419</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9904</td>
<td align="right">0.2336</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2086</td>
<td align="left">2017-10-29 13:58:06</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">7.014310</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">11.1096</td>
<td align="right">0.1856</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9995</td>
<td align="right">0.0515</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2102</td>
<td align="left">2017-10-30 15:18:16</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">45.260003</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">10.7432</td>
<td align="right">0.4240</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9974</td>
<td align="right">0.1176</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2113</td>
<td align="left">2017-10-31 08:33:47</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">1.426427</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">11.5001</td>
<td align="right">1.0634</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9846</td>
<td align="right">0.2950</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2117</td>
<td align="left">2017-10-31 14:53:43</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">87.052984</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">9.7739</td>
<td align="right">1.1193</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9815</td>
<td align="right">0.3105</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2137</td>
<td align="left">2017-11-02 06:13:18</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">24.517030</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">(Intercept)</td>
<td align="right">11.3123</td>
<td align="right">0.1869</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9995</td>
<td align="right">0.0519</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2034</td>
<td align="left">2017-10-26 09:15:48</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">1.316609</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">1.0145</td>
<td align="right">0.0311</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9870</td>
<td align="right">0.2706</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2041</td>
<td align="left">2017-10-26 20:50:38</td>
<td align="left">no</td>
<td align="right">3.0</td>
<td align="right">10.728124</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">1.0085</td>
<td align="right">0.0958</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.8869</td>
<td align="right">0.8330</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2047</td>
<td align="left">2017-10-27 05:50:04</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">13.834178</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">1.0137</td>
<td align="right">0.0113</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9983</td>
<td align="right">0.0984</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2093</td>
<td align="left">2017-10-30 00:32:04</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">2.032492</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">1.0366</td>
<td align="right">0.0213</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9941</td>
<td align="right">0.1847</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2099</td>
<td align="left">2017-10-30 10:33:19</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">2.497390</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">0.9830</td>
<td align="right">0.0189</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9949</td>
<td align="right">0.1640</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2114</td>
<td align="left">2017-10-31 10:08:42</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">5.675072</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">1.0121</td>
<td align="right">0.0107</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9984</td>
<td align="right">0.0932</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2035</td>
<td align="left">2017-10-26 10:50:43</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">5.356130</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">0.9995</td>
<td align="right">0.0137</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9974</td>
<td align="right">0.1189</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2096</td>
<td align="left">2017-10-30 05:48:23</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">8.855793</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">1.0110</td>
<td align="right">0.0066</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9994</td>
<td align="right">0.0577</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2100</td>
<td align="left">2017-10-30 12:08:16</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">9.864856</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">1.0066</td>
<td align="right">0.0052</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9996</td>
<td align="right">0.0449</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2115</td>
<td align="left">2017-10-31 11:43:46</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">10.838746</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">1.0082</td>
<td align="right">0.0058</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9995</td>
<td align="right">0.0506</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2139</td>
<td align="left">2017-11-02 15:13:36</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">29.445250</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">1.0149</td>
<td align="right">0.0082</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9991</td>
<td align="right">0.0713</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2032</td>
<td align="left">2017-10-26 06:05:49</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">5.237014</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">1.0118</td>
<td align="right">0.0118</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9981</td>
<td align="right">0.1026</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2036</td>
<td align="left">2017-10-26 12:25:48</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">10.256694</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">1.0001</td>
<td align="right">0.0116</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9981</td>
<td align="right">0.1011</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2045</td>
<td align="left">2017-10-27 02:40:08</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">1.786624</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">1.0076</td>
<td align="right">0.0205</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9943</td>
<td align="right">0.1779</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2056</td>
<td align="left">2017-10-27 19:34:08</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">14.721991</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">1.0071</td>
<td align="right">0.0119</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9981</td>
<td align="right">0.1033</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2075</td>
<td align="left">2017-10-28 20:27:22</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">6.011649</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">1.0133</td>
<td align="right">0.0115</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9982</td>
<td align="right">0.1000</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2097</td>
<td align="left">2017-10-30 07:23:28</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">16.704496</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">1.0123</td>
<td align="right">0.0069</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9993</td>
<td align="right">0.0602</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2101</td>
<td align="left">2017-10-30 13:43:23</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">19.140429</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">1.0020</td>
<td align="right">0.0064</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9994</td>
<td align="right">0.0554</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2136</td>
<td align="left">2017-11-02 04:38:25</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">9.705883</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">1.0030</td>
<td align="right">0.0037</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9998</td>
<td align="right">0.0318</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2140</td>
<td align="left">2017-11-02 16:48:30</td>
<td align="left">yes</td>
<td align="right">2.0</td>
<td align="right">58.566406</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">0.9974</td>
<td align="right">0.0053</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9996</td>
<td align="right">0.0460</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2033</td>
<td align="left">2017-10-26 07:40:55</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">9.967239</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">1.0076</td>
<td align="right">0.0150</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9969</td>
<td align="right">0.1305</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2046</td>
<td align="left">2017-10-27 04:15:02</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">7.189101</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">1.0137</td>
<td align="right">0.0148</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9970</td>
<td align="right">0.1285</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2060</td>
<td align="left">2017-10-27 23:54:33</td>
<td align="left">no</td>
<td align="right">1.0</td>
<td align="right">34.014913</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">1.0217</td>
<td align="right">0.0269</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9904</td>
<td align="right">0.2336</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2086</td>
<td align="left">2017-10-29 13:58:06</td>
<td align="left">yes</td>
<td align="right">1.5</td>
<td align="right">7.014310</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">1.0049</td>
<td align="right">0.0059</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9995</td>
<td align="right">0.0515</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2102</td>
<td align="left">2017-10-30 15:18:16</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">45.260003</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">0.9978</td>
<td align="right">0.0135</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9974</td>
<td align="right">0.1176</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2113</td>
<td align="left">2017-10-31 08:33:47</td>
<td align="left">yes</td>
<td align="right">0.5</td>
<td align="right">1.426427</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">1.0174</td>
<td align="right">0.0339</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9846</td>
<td align="right">0.2950</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">2117</td>
<td align="left">2017-10-31 14:53:43</td>
<td align="left">yes</td>
<td align="right">3.0</td>
<td align="right">87.052984</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">0.9734</td>
<td align="right">0.0357</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9815</td>
<td align="right">0.3105</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2137</td>
<td align="left">2017-11-02 06:13:18</td>
<td align="left">yes</td>
<td align="right">1.0</td>
<td align="right">24.517030</td>
<td align="left">lm(d13C ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C</td>
<td align="right">1.0120</td>
<td align="right">0.0060</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9995</td>
<td align="right">0.0519</td>
<td align="right">13</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># visualize the calibration coefficients</span>
<span class="va">stds_w_calibs</span> <span class="op">%&gt;%</span> 
  <span class="co"># plot calibration parameters</span>
  <span class="fu"><a href="../reference/iso_plot_calibration_parameters.html">iso_plot_calibration_parameters</a></span><span class="op">(</span>
    <span class="co"># x-axis, could also be e.g. Analysis or file_datetime (also use date_breaks!)</span>
    x <span class="op">=</span> <span class="va">mean_area_identified</span>,
    <span class="co"># aesthetics</span>
    color <span class="op">=</span> <span class="va">seed_oxidation</span>, size <span class="op">=</span> <span class="va">mean_area_identified</span>,
    <span class="co"># highlight RSD threshold</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>term <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="st">"RSD"</span><span class="op">)</span>, threshold <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,
               mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">threshold</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
  <span class="op">)</span> </code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/single_analysis_calibration_coefficients-1.png" width="672"></p>
</div>
<div id="residuals" class="section level3">
<h3 class="hasAnchor">
<a href="#residuals" class="anchor"></a>Residuals</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stds_w_calibs</span> <span class="op">%&gt;%</span> 
  <span class="co"># pull out all peak data to including residuals</span>
  <span class="fu"><a href="../reference/iso_get_calibration_data.html">iso_get_calibration_data</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># focus on standard peaks</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">is_std_peak</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># calculate area deviation from mean</span>
  <span class="fu"><a href="../reference/iso_mutate_peak_table.html">iso_mutate_peak_table</a></span><span class="op">(</span>
    group_by <span class="op">=</span> <span class="va">Analysis</span>,
    area_dev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_with_units.html">iso_double_with_units</a></span><span class="op">(</span><span class="op">(</span><span class="va">area44</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">area44</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="st">"%"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># visualize</span>
  <span class="fu"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span><span class="op">(</span>
    <span class="co"># x and y </span>
    x <span class="op">=</span> <span class="va">compound</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>residual <span class="op">=</span> <span class="va">resid</span>, `area dev. from mean` <span class="op">=</span> <span class="va">area_dev</span><span class="op">)</span>,
    <span class="co"># grouping and aesthetics</span>
    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">Analysis</span>, <span class="va">calib</span><span class="op">)</span>, color <span class="op">=</span> <span class="va">seed_oxidation</span>, linetype <span class="op">=</span> <span class="va">calib</span>,
    <span class="co"># geoms</span>
    lines <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span>
<span class="co">#&gt; Info: retrieving all data</span>
<span class="co">#&gt; Info: mutating peak table grouped by 'Analysis', column(s) 'area_dev' added.</span></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/single_analysis_residuals-1.png" width="672"></p>
</div>
</div>
<div id="global-calibration-with-all-standards" class="section level2">
<h2 class="hasAnchor">
<a href="#global-calibration-with-all-standards" class="anchor"></a>Global Calibration with all standards</h2>
<div id="generate-calibrations-1" class="section level3">
<h3 class="hasAnchor">
<a href="#generate-calibrations-1" class="anchor"></a>Generate calibrations (*)</h3>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># define a global calibration across all standards</span>
<span class="va">global_calibs</span> <span class="op">&lt;-</span> 
  <span class="va">peak_table_w_stds</span> <span class="op">%&gt;%</span>
  <span class="co"># remove (most) problematic peaks to speed up calibration calculations</span>
  <span class="co"># note: could additionally remove unidentified peaks if they are of no interest</span>
  <span class="fu"><a href="../reference/iso_remove_problematic_peak_mappings.html">iso_remove_problematic_peak_mappings</a></span><span class="op">(</span>remove_unidentified <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># prepare for calibration (no grouping to go across all analyses)</span>
  <span class="fu"><a href="../reference/iso_prepare_for_calibration.html">iso_prepare_for_calibration</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># run different calibrations</span>
  <span class="fu"><a href="../reference/iso_generate_calibration.html">iso_generate_calibration</a></span><span class="op">(</span>
    model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      linear <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">d13C</span> <span class="op">~</span> <span class="va">true_d13C</span><span class="op">)</span>,
      with_area <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">d13C</span> <span class="op">~</span> <span class="va">true_d13C</span> <span class="op">+</span> <span class="va">area44</span><span class="op">)</span>,
      with_area_cross <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">d13C</span> <span class="op">~</span> <span class="va">true_d13C</span> <span class="op">*</span> <span class="va">area44</span><span class="op">)</span>
    <span class="op">)</span>,
    <span class="co"># specify which peaks to include in the calibration, here:</span>
    <span class="co"># - all std_peaks (this filter should always be included!)</span>
    <span class="co"># - standard peaks between 5 and 100 Vs</span>
    <span class="co"># - only analyses with seed oxidation (same as all the samples)</span>
    use_in_calib <span class="op">=</span> <span class="va">is_std_peak</span> <span class="op">&amp;</span> <span class="va">area44</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_with_units.html">iso_double_with_units</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"Vs"</span><span class="op">)</span> <span class="op">&amp;</span> 
      <span class="va">area44</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_with_units.html">iso_double_with_units</a></span><span class="op">(</span><span class="fl">100</span>, <span class="st">"Vs"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">seed_oxidation</span> <span class="op">==</span> <span class="st">"yes"</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_remove_problematic_calibrations.html">iso_remove_problematic_calibrations</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Info: removing 7 of 628 peak table entries because of problematic peak identifications (missing or ambiguous)</span>
<span class="co">#&gt; Info: preparing data for calibration by nesting the entire dataset</span>
<span class="co">#&gt; Info: generating calibration based on 3 models (linear = 'lm(d13C ~ true_d13C)', with_area = 'lm(d13C ~ true_d13C + area44)', with_area_cross = 'lm(d13C ~ true_d13C * area44)') for 1 data group(s) with standards filter 'is_std_peak &amp; area44 &gt; iso_double_with_units(5, "Vs") &amp; area44 &lt; ...'. Storing residuals in new column 'resid'. Storing calibration info in new column 'in_calib'.</span>
<span class="co">#&gt; Info: there are no problematic calibrations</span></code></pre></div>
</div>
<div id="coefficients-1" class="section level3">
<h3 class="hasAnchor">
<a href="#coefficients-1" class="anchor"></a>Coefficients</h3>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># look at coefficients and summary</span>
<span class="va">global_calibs</span> <span class="op">%&gt;%</span> 
  <span class="co"># unnest calibration parameters</span>
  <span class="fu"><a href="../reference/iso_get_calibration_parameters.html">iso_get_calibration_parameters</a></span><span class="op">(</span>
    select_from_coefs <span class="op">=</span> 
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">term</span>, <span class="va">estimate</span>, SE <span class="op">=</span> <span class="va">std.error</span>, <span class="va">signif</span><span class="op">)</span>,
    select_from_summary <span class="op">=</span> 
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>fit_R2 <span class="op">=</span> <span class="va">adj.r.squared</span>, fit_RSD <span class="op">=</span> <span class="va">sigma</span>, residual_df <span class="op">=</span> <span class="va">df.residual</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="co">#&gt; Info: retrieving coefficient column(s) 'c(term, estimate, SE = std.error, signif)' for calibration</span>
<span class="co">#&gt; Info: retrieving summary column(s) 'c(fit_R2 = adj.r.squared, fit_RSD = sigma, residual_df = df.residual)' for calibration</span></code></pre></div>
<table class="table">
<colgroup>
<col width="15%">
<col width="12%">
<col width="16%">
<col width="8%">
<col width="6%">
<col width="15%">
<col width="6%">
<col width="7%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left">calib</th>
<th align="right">calib_points</th>
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="left">signif</th>
<th align="right">fit_R2</th>
<th align="right">fit_RSD</th>
<th align="right">residual_df</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">linear</td>
<td align="right">311</td>
<td align="left">(Intercept)</td>
<td align="right">11.0412</td>
<td align="right">0.1113</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9962</td>
<td align="right">0.139</td>
<td align="right">309</td>
</tr>
<tr class="even">
<td align="left">with_area</td>
<td align="right">311</td>
<td align="left">(Intercept)</td>
<td align="right">11.0931</td>
<td align="right">0.1028</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9967</td>
<td align="right">0.128</td>
<td align="right">308</td>
</tr>
<tr class="odd">
<td align="left">with_area_cross</td>
<td align="right">311</td>
<td align="left">(Intercept)</td>
<td align="right">11.3321</td>
<td align="right">0.1414</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9968</td>
<td align="right">0.127</td>
<td align="right">307</td>
</tr>
<tr class="even">
<td align="left">with_area</td>
<td align="right">311</td>
<td align="left">area44</td>
<td align="right">-0.0027</td>
<td align="right">0.0004</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9967</td>
<td align="right">0.128</td>
<td align="right">308</td>
</tr>
<tr class="odd">
<td align="left">with_area_cross</td>
<td align="right">311</td>
<td align="left">area44</td>
<td align="right">-0.0149</td>
<td align="right">0.0050</td>
<td align="left">** (p &lt; 0.01)</td>
<td align="right">0.9968</td>
<td align="right">0.127</td>
<td align="right">307</td>
</tr>
<tr class="even">
<td align="left">linear</td>
<td align="right">311</td>
<td align="left">true_d13C</td>
<td align="right">1.0057</td>
<td align="right">0.0036</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9962</td>
<td align="right">0.139</td>
<td align="right">309</td>
</tr>
<tr class="odd">
<td align="left">with_area</td>
<td align="right">311</td>
<td align="left">true_d13C</td>
<td align="right">1.0057</td>
<td align="right">0.0033</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9967</td>
<td align="right">0.128</td>
<td align="right">308</td>
</tr>
<tr class="even">
<td align="left">with_area_cross</td>
<td align="right">311</td>
<td align="left">true_d13C</td>
<td align="right">1.0133</td>
<td align="right">0.0045</td>
<td align="left">*** (p &lt; 0.001)</td>
<td align="right">0.9968</td>
<td align="right">0.127</td>
<td align="right">307</td>
</tr>
<tr class="odd">
<td align="left">with_area_cross</td>
<td align="right">311</td>
<td align="left">true_d13C:area44</td>
<td align="right">-0.0004</td>
<td align="right">0.0002</td>
<td align="left">* (p &lt; 0.05)</td>
<td align="right">0.9968</td>
<td align="right">0.127</td>
<td align="right">307</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># visualize coefficients for the different global calibrations</span>
<span class="va">global_calibs</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/iso_plot_calibration_parameters.html">iso_plot_calibration_parameters</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/global_calibration_coefficients-1.png" width="672"></p>
</div>
<div id="residuals-1" class="section level3">
<h3 class="hasAnchor">
<a href="#residuals-1" class="anchor"></a>Residuals</h3>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">global_calibs</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_plot_residuals.html">iso_plot_residuals</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">compound</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">Analysis</span>, <span class="va">calib</span><span class="op">)</span>, 
    points <span class="op">=</span> <span class="cn">FALSE</span>, lines <span class="op">=</span> <span class="cn">TRUE</span>,
    trendlines <span class="op">=</span> <span class="cn">FALSE</span>, value_ranges <span class="op">=</span> <span class="cn">FALSE</span>
  <span class="op">)</span> </code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/global_calibration_residuals-1.png" width="768"></p>
</div>
<div id="apply-global-calibration" class="section level3">
<h3 class="hasAnchor">
<a href="#apply-global-calibration" class="anchor"></a>Apply global calibration (*)</h3>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># note that depending on the number of data points, this may take a while</span>
<span class="co"># for faster calculations, chose calculate_error = FALSE</span>
<span class="va">global_calibs_applied</span> <span class="op">&lt;-</span> 
  <span class="va">global_calibs</span> <span class="op">%&gt;%</span> 
  <span class="co"># which calibration to use? can include multiple if desired to see the result</span>
  <span class="co"># in this case, the area conscious calibrations are not necessary</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">calib</span> <span class="op">==</span> <span class="st">"linear"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># apply calibration indication what should be calcculated</span>
  <span class="fu"><a href="../reference/iso_apply_calibration.html">iso_apply_calibration</a></span><span class="op">(</span><span class="va">true_d13C</span>, calculate_error <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Info: applying calibration to infer 'true_d13C' for 1 data group(s) in 1 model(s); storing resulting value in new column 'true_d13C_pred' and estimated error in new column 'true_d13C_pred_se'. This may take a moment... finished.</span>

<span class="co"># calibration ranges</span>
<span class="va">global_calibs_with_ranges</span> <span class="op">&lt;-</span>
  <span class="va">global_calibs_applied</span> <span class="op">%&gt;%</span> 
  <span class="co"># evaluate calibration range for the measured area.Vs and predicted d13C</span>
  <span class="fu"><a href="../reference/iso_evaluate_calibration_range.html">iso_evaluate_calibration_range</a></span><span class="op">(</span><span class="va">area44</span>, <span class="va">true_d13C_pred</span><span class="op">)</span> 
<span class="co">#&gt; Info: evaluating range for terms 'area44' and 'true_d13C_pred' in calibration for 1 data group(s) in 1 model(s); storing resulting summary for each data entry in new column 'in_range'.</span>

<span class="co"># show calibration ranges</span>
<span class="va">global_calibs_with_ranges</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_get_calibration_range.html">iso_get_calibration_range</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_remove_list_columns.html">iso_remove_list_columns</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; Info: retrieving all calibration range information for calibration</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">calib</th>
<th align="right">calib_points</th>
<th align="left">term</th>
<th align="left">units</th>
<th align="right">min</th>
<th align="right">max</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">linear</td>
<td align="right">311</td>
<td align="left">area44</td>
<td align="left">Vs</td>
<td align="right">5.03</td>
<td align="right">91.46</td>
</tr>
<tr class="even">
<td align="left">linear</td>
<td align="right">311</td>
<td align="left">true_d13C_pred</td>
<td align="left">permil</td>
<td align="right">-34.09</td>
<td align="right">-25.94</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># create calibrated peak table</span>
<span class="va">peak_table_calibrated</span> <span class="op">&lt;-</span> <span class="va">global_calibs_with_ranges</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_get_calibration_data.html">iso_get_calibration_data</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Info: retrieving all data</span></code></pre></div>
</div>
</div>
</div>
<div id="evaluation" class="section level1">
<h1 class="hasAnchor">
<a href="#evaluation" class="anchor"></a>Evaluation</h1>
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># replicate earlier overview plot but now with the calibrated delta values</span>
<span class="co"># and with a higlight of the calibration ranges and which points are in range</span>
<span class="va">peak_table_calibrated</span> <span class="op">%&gt;%</span> 
  <span class="co"># focus on identified peaks (comment out this line to see ALL peaks)</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">compound</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># visualize with convenience function iso_plot_data</span>
  <span class="fu"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span><span class="op">(</span>
    <span class="co"># choose x and y (multiple y possible)</span>
    x <span class="op">=</span> <span class="va">area44</span>, y <span class="op">=</span> <span class="va">true_d13C_pred</span>,
    <span class="co"># choose aesthetics</span>
    color <span class="op">=</span> <span class="va">in_range</span>, shape <span class="op">=</span> <span class="va">type</span>, label <span class="op">=</span> <span class="va">compound</span>, size <span class="op">=</span> <span class="fl">3</span>,
    <span class="co"># decide what geoms to include</span>
    points <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># highlight calibration range</span>
  <span class="fu"><a href="../reference/iso_mark_calibration_range.html">iso_mark_calibration_range</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># further customize ggplot with a log scale x axis</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># legend</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.direction <span class="op">=</span> <span class="st">"vertical"</span><span class="op">)</span></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/data_overview-1.png" width="672"></p>
</div>
<div id="standards" class="section level2">
<h2 class="hasAnchor">
<a href="#standards" class="anchor"></a>Standards</h2>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># visualize how standard line up after calibration</span>
<span class="va">peak_table_calibrated</span> <span class="op">%&gt;%</span> 
  <span class="co"># focus on peaks in calibration</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">in_calib</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># visualize</span>
  <span class="fu"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span><span class="op">(</span>
    <span class="co"># x and y</span>
    x <span class="op">=</span> <span class="va">true_d13C</span>, y <span class="op">=</span> <span class="va">true_d13C_pred</span>, y_error <span class="op">=</span> <span class="va">true_d13C_pred_se</span>,
    <span class="co"># aesthetics</span>
    color <span class="op">=</span> <span class="va">compound</span>, size <span class="op">=</span> <span class="va">area44</span>,
    <span class="co"># geoms</span>
    points <span class="op">=</span> <span class="cn">TRUE</span>,
    <span class="co"># add 1:1 trendline</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> </code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/standards-1.png" width="672"></p>
</div>
<div id="data" class="section level2">
<h2 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h2>
<div id="isotopic-values" class="section level3">
<h3 class="hasAnchor">
<a href="#isotopic-values" class="anchor"></a>Isotopic values</h3>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Warning: data outside the calibration range MUST be taken with a</span>
<span class="co"># grain of salt, especially at the low signal area/amplitude end</span>
<span class="va">peak_table_calibrated</span> <span class="op">%&gt;%</span> 
  <span class="co"># focus on samples</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"sample"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># focus on identified peaks (comment out this line to see ALL peaks)</span>
  <span class="co"># if there's a lot of data, might need to hone in on a few at a time</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">compound</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># visualize</span>
  <span class="fu"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span><span class="op">(</span>
    <span class="co"># x and y</span>
    x <span class="op">=</span> <span class="va">sample</span>, y <span class="op">=</span> <span class="va">true_d13C_pred</span>, y_error <span class="op">=</span> <span class="va">true_d13C_pred_se</span>,
    <span class="co"># aesthetics</span>
    color <span class="op">=</span> <span class="va">in_range</span>, size <span class="op">=</span> <span class="va">rel_area</span>, 
    <span class="co"># paneling</span>
    panel <span class="op">=</span> <span class="va">compound</span>, panel_scales <span class="op">=</span> <span class="st">"fixed"</span>,
    <span class="co"># geoms</span>
    points <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># mark calibration range (include optionally)</span>
  <span class="fu"><a href="../reference/iso_mark_calibration_range.html">iso_mark_calibration_range</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># color palette (here example of manual: www.google.com/search?q=color+picker)</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>
    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#984EA3"</span>, <span class="st">"#E41A1C"</span>, <span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span>, <span class="st">"#4DAF4A"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="co"># clarify size scale</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html">scale_size_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span><span class="op">)</span>, 
                        labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="va">x</span>, <span class="st">"%"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># plot labels</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/samples-1.png" width="960"></p>
</div>
<div id="relative-abundances" class="section level3">
<h3 class="hasAnchor">
<a href="#relative-abundances" class="anchor"></a>Relative abundances</h3>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># visualize relative abundances</span>
<span class="va">peak_table_calibrated</span> <span class="op">%&gt;%</span> 
  <span class="co"># focus on samples</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"sample"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># focus on identified peaks (comment out this line to see ALL peaks)</span>
  <span class="co">#filter(!is.na(compound)) %&gt;% </span>
  <span class="co"># visualize</span>
  <span class="fu"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span><span class="op">(</span>
    <span class="co"># x and y</span>
    x <span class="op">=</span> <span class="va">sample</span>, y <span class="op">=</span> <span class="va">rel_area</span>,
    <span class="co"># aesthetics</span>
    fill <span class="op">=</span> <span class="va">compound</span>,
    <span class="co"># barchart</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="co"># scales</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="va">x</span>, <span class="st">"%"</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># plot labels</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"Relative abundance (by area)"</span><span class="op">)</span></code></pre></div>
<p><img src="gc_irms_example_carbon_files/figure-html/abundances-1.png" width="672"></p>
</div>
<div id="summary-2" class="section level3">
<h3 class="hasAnchor">
<a href="#summary-2" class="anchor"></a>Summary</h3>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># generate data summary</span>
<span class="va">peak_data</span> <span class="op">&lt;-</span> 
  <span class="va">peak_table_calibrated</span> <span class="op">%&gt;%</span> 
  <span class="co"># focus on identified peaks in the samples</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"sample"</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">compound</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">sample</span>, <span class="va">compound</span>, <span class="va">Analysis</span>, 
         <span class="va">area44</span>, <span class="va">true_d13C_pred</span>, <span class="va">true_d13C_pred_se</span>, <span class="va">in_range</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">sample</span>, <span class="va">compound</span>, <span class="va">Analysis</span><span class="op">)</span> 

<span class="co"># summarize replicates</span>
<span class="co"># this example data set does not contain any replicates but typically all</span>
<span class="co"># analyses should in which case a statistical data summary can be useful</span>
<span class="va">peak_data_summary</span> <span class="op">&lt;-</span> 
  <span class="va">peak_data</span> <span class="op">%&gt;%</span> 
  <span class="co"># here: only peaks within the area calibration range are included</span>
  <span class="co"># you have to explicitly decide which peaks you trust if they are out of range</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span>
    <span class="va">in_range</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"in range"</span>, <span class="st">"&lt;'true_d13C_pred' range"</span>, <span class="st">"&gt;'true_d13C_pred' range"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># summarize for each sample and compound</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">sample</span>, <span class="va">compound</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_summarize_data_table.html">iso_summarize_data_table</a></span><span class="op">(</span><span class="va">area44</span>, <span class="va">true_d13C_pred</span><span class="op">)</span>

<span class="va">peak_data_summary</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_make_units_explicit.html">iso_make_units_explicit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="14%">
<col width="9%">
<col width="3%">
<col width="17%">
<col width="10%">
<col width="28%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th align="left">sample</th>
<th align="left">compound</th>
<th align="right">n</th>
<th align="right">area44 mean [Vs]</th>
<th align="right">area44 sd</th>
<th align="right">true_d13C_pred mean [permil]</th>
<th align="right">true_d13C_pred sd</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">CTNA</td>
<td align="left">nC22</td>
<td align="right">1</td>
<td align="right">10.53</td>
<td align="right">NA</td>
<td align="right">-28.46</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">CTNA</td>
<td align="left">nC24</td>
<td align="right">1</td>
<td align="right">14.63</td>
<td align="right">NA</td>
<td align="right">-28.22</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">CTNA</td>
<td align="left">nC25</td>
<td align="right">1</td>
<td align="right">23.56</td>
<td align="right">NA</td>
<td align="right">-27.09</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">CTNA</td>
<td align="left">nC26</td>
<td align="right">1</td>
<td align="right">67.20</td>
<td align="right">NA</td>
<td align="right">-28.29</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">CTNA</td>
<td align="left">nC27</td>
<td align="right">1</td>
<td align="right">46.40</td>
<td align="right">NA</td>
<td align="right">-27.78</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">CTNA</td>
<td align="left">nC28</td>
<td align="right">1</td>
<td align="right">22.36</td>
<td align="right">NA</td>
<td align="right">-29.04</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">CTNA</td>
<td align="left">nC29</td>
<td align="right">1</td>
<td align="right">34.20</td>
<td align="right">NA</td>
<td align="right">-29.42</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">CTNA</td>
<td align="left">nC30</td>
<td align="right">1</td>
<td align="right">18.60</td>
<td align="right">NA</td>
<td align="right">-30.80</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">CTNA</td>
<td align="left">nC31</td>
<td align="right">1</td>
<td align="right">10.82</td>
<td align="right">NA</td>
<td align="right">-33.12</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Niwot_Tundra1</td>
<td align="left">nC27</td>
<td align="right">1</td>
<td align="right">6.04</td>
<td align="right">NA</td>
<td align="right">-31.82</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">Niwot_Tundra1</td>
<td align="left">nC29</td>
<td align="right">1</td>
<td align="right">19.08</td>
<td align="right">NA</td>
<td align="right">-31.64</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Niwot_Tundra1</td>
<td align="left">nC31</td>
<td align="right">1</td>
<td align="right">11.63</td>
<td align="right">NA</td>
<td align="right">-31.78</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">Niwot_Tundra2</td>
<td align="left">nC27</td>
<td align="right">1</td>
<td align="right">7.44</td>
<td align="right">NA</td>
<td align="right">-31.73</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Niwot_Tundra2</td>
<td align="left">nC29</td>
<td align="right">1</td>
<td align="right">24.67</td>
<td align="right">NA</td>
<td align="right">-31.57</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">Niwot_Tundra2</td>
<td align="left">nC31</td>
<td align="right">1</td>
<td align="right">11.65</td>
<td align="right">NA</td>
<td align="right">-31.84</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">SJER</td>
<td align="left">nC27</td>
<td align="right">1</td>
<td align="right">7.41</td>
<td align="right">NA</td>
<td align="right">-36.49</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">SJER</td>
<td align="left">nC29</td>
<td align="right">1</td>
<td align="right">17.53</td>
<td align="right">NA</td>
<td align="right">-36.48</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">SJER</td>
<td align="left">nC31</td>
<td align="right">1</td>
<td align="right">35.01</td>
<td align="right">NA</td>
<td align="right">-38.30</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="final" class="section level1">
<h1 class="hasAnchor">
<a href="#final" class="anchor"></a>Final</h1>
<p>Final data processing and visualization usually depends on the type of data and the metadata available for contextualization (e.g. core depth, source organism, age, etc.). The relevant metadata can be added easily with <code><a href="https://rdrr.io/pkg/isoreader/man/iso_add_file_info.html">iso_add_file_info()</a></code> during the initial data load / file info procesing. Alternatively, just call <code><a href="https://rdrr.io/pkg/isoreader/man/iso_add_file_info.html">iso_add_file_info()</a></code> again at this later point or use dplyr’s <code>left_join</code> directly.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># @user: add final data processing and plot(s)</span></code></pre></div>
</div>
<div id="export" class="section level1">
<h1 class="hasAnchor">
<a href="#export" class="anchor"></a>Export</h1>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># export the global calibration with all its information and data to Excel</span>
<span class="va">peak_table_calibrated</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_export_calibration_to_excel.html">iso_export_calibration_to_excel</a></span><span class="op">(</span>
    filepath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"%Y%m%d_gc_irms_example_carbon_export.xlsx"</span><span class="op">)</span>,
    <span class="co"># include data summary as an additional useful tab</span>
    `data summary` <span class="op">=</span> <span class="va">peak_data_summary</span>
  <span class="op">)</span>
<span class="co">#&gt; Info: exporting calibrations into Excel '20211104_gc_irms_example_carbon_export.xlsx'...</span>
<span class="co">#&gt; Info: retrieving all data</span>
<span class="co">#&gt; Info: retrieving all coefficient information for calibration</span>
<span class="co">#&gt; Info: retrieving all summary information for calibration</span>
<span class="co">#&gt; Info: retrieving all calibration range information for calibration</span>
<span class="co">#&gt; Info: export complete, created tabs 'data summary', 'all data', 'calib coefs', 'calib summary' and 'calib range'.</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Sebastian Kopf.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
