<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How does Isodat calculate R? • isoprocessor</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="How does Isodat calculate R?">
<meta property="og:description" content="isoprocessor">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-106138361-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-106138361-4');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">isoprocessor</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="in active development">0.6.11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/dual_inlet.html">Dual Inlet</a>
</li>
<li>
  <a href="../articles/continuous_flow.html">Continuous Flow</a>
</li>
<li>
  <a href="../articles/scan.html">Scan</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Processing Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ea_irms_example_carbon.html">Bulk carbon isotope analysis</a>
    </li>
    <li>
      <a href="../articles/gc_irms_example_carbon.html">Compound specific carbon isotope analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/isoverse/isoprocessor">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="isodat_calculations_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="isodat_calculations_files/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="isodat_calculations_files/pagedtable-1.1/js/pagedtable.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>How does Isodat calculate R?</h1>
            <h3 class="subtitle">Example: 66/64 SO2 ratios</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/isoverse/isoprocessor/blob/master/vignettes/isodat_calculations.Rmd"><code>vignettes/isodat_calculations.Rmd</code></a></small>
      <div class="hidden name"><code>isodat_calculations.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/isoverse/isoreader">isoreader</a></span><span class="op">)</span> <span class="co"># isoreader.isoverse.org</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/isoverse/isoprocessor">isoprocessor</a></span><span class="op">)</span> <span class="co"># isoprocessor.isoverse.org</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>collapse <span class="op">=</span> <span class="cn">TRUE</span>, comment <span class="op">=</span> <span class="st">"#&gt;"</span><span class="op">)</span></code></pre></div>
<p>Using isoreader version 1.3.1 and isoprocessor version 0.6.11.</p>
<div id="continuous-flow" class="section level1">
<h1 class="hasAnchor">
<a href="#continuous-flow" class="anchor"></a>Continuous Flow</h1>
<div id="read-data" class="section level2">
<h2 class="hasAnchor">
<a href="#read-data" class="anchor"></a>Read Data</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">iso_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_read_continuous_flow.html">iso_read_continuous_flow</a></span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span>
<span class="co">#&gt; Info: preparing to read 2 data files (all will be cached)...</span>
<span class="co">#&gt; Info: reading file 'data/21848__SW_50.dxf' with '.dxf' reader...</span>
<span class="co">#&gt; Info: reading file 'data/21870__BSA2 CA3_sm.dxf' with '.dxf' reader...</span>
<span class="co">#&gt; Info: finished reading 2 files in 3.15 secs</span>
<span class="va">iso_files</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_get_data_summary.html">iso_get_data_summary</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Info: aggregating data summary from 2 data file(s)</span>
<span class="co">#&gt; # A tibble: 2 × 6</span>
<span class="co">#&gt;   file_id    raw_data      file_info  method_info  vendor_data_tab… file_path   </span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;glue&gt;        &lt;chr&gt;      &lt;chr&gt;        &lt;chr&gt;            &lt;chr&gt;       </span>
<span class="co">#&gt; 1 21848__SW… 6681 time po… 19 entries standards, … 5 rows, 30 colu… data/21848_…</span>
<span class="co">#&gt; 2 21870__BS… 6681 time po… 20 entries standards, … 5 rows, 30 colu… data/21870_…</span></code></pre></div>
</div>
<div id="chroms" class="section level2">
<h2 class="hasAnchor">
<a href="#chroms" class="anchor"></a>Chroms</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">iso_files</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_calculate_ratios.html">iso_calculate_ratios</a></span><span class="op">(</span><span class="st">"66/64"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_plot_continuous_flow_data.html">iso_plot_continuous_flow_data</a></span><span class="op">(</span>panel <span class="op">=</span> <span class="va">category</span>, color <span class="op">=</span> <span class="va">data</span>, linetype <span class="op">=</span> <span class="va">`Identifier 1`</span><span class="op">)</span>
<span class="co">#&gt; Info: calculating ratio(s) in 2 data file(s): r66/64</span></code></pre></div>
<p><img src="isodat_calculations_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
</div>
<div id="file-info" class="section level2">
<h2 class="hasAnchor">
<a href="#file-info" class="anchor"></a>File Info</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">iso_files</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_get_file_info.html">iso_get_file_info</a></span><span class="op">(</span>
  select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    dt <span class="op">=</span> <span class="va">file_datetime</span>,
    <span class="va">Analysis</span>,
    <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"Ident"</span><span class="op">)</span>,
    <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">matches</a></span><span class="op">(</span><span class="st">"Method"</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; Info: aggregating file info from 2 data file(s), selecting info columns 'c(dt = file_datetime, Analysis, starts_with("Ident"), matches("Method"))'</span>
<span class="co">#&gt; # A tibble: 2 × 7</span>
<span class="co">#&gt;   file_id dt                  Analysis `Identifier 1` `Identifier 2` `EA Method`</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;dttm&gt;              &lt;chr&gt;    &lt;chr&gt;          &lt;chr&gt;          &lt;chr&gt;      </span>
<span class="co">#&gt; 1 21848_… 2018-04-27 22:32:52 21848    SW_50          3              FFW_SO2_no…</span>
<span class="co">#&gt; 2 21870_… 2018-04-28 07:36:05 21870    BSA2 CA3_sm    25             FFW_SO2_no…</span>
<span class="co">#&gt; # … with 1 more variable: Method &lt;chr&gt;</span></code></pre></div>
</div>
<div id="resistors" class="section level2">
<h2 class="hasAnchor">
<a href="#resistors" class="anchor"></a>Resistors</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">iso_files</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_get_resistors.html">iso_get_resistors</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Info: aggregating resistors info from 2 data file(s)</span>
<span class="co">#&gt; # A tibble: 4 × 4</span>
<span class="co">#&gt;   file_id                  cup       R.Ohm mass </span>
<span class="co">#&gt;   &lt;chr&gt;                  &lt;int&gt;       &lt;dbl&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1 21848__SW_50.dxf           1   300000000 64   </span>
<span class="co">#&gt; 2 21848__SW_50.dxf           2 30000000000 66   </span>
<span class="co">#&gt; 3 21870__BSA2 CA3_sm.dxf     1   300000000 64   </span>
<span class="co">#&gt; 4 21870__BSA2 CA3_sm.dxf     2 30000000000 66</span></code></pre></div>
</div>
<div id="standards" class="section level2">
<h2 class="hasAnchor">
<a href="#standards" class="anchor"></a>Standards</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">iso_files</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_get_standards.html">iso_get_standards</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Info: aggregating standards info from 2 data file(s)</span>
<span class="co">#&gt; # A tibble: 8 × 9</span>
<span class="co">#&gt;   file_id     standard gas   delta_name delta_value reference element ratio_name</span>
<span class="co">#&gt;   &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;            &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;     </span>
<span class="co">#&gt; 1 21848__SW_… SO2_zero SO2   d 18O/16O            0 VSMOW     H       R 2H/1H   </span>
<span class="co">#&gt; 2 21848__SW_… SO2_zero SO2   d 18O/16O            0 VSMOW     O       R 17O/16O </span>
<span class="co">#&gt; 3 21848__SW_… SO2_zero SO2   d 18O/16O            0 VSMOW     O       R 18O/16O </span>
<span class="co">#&gt; 4 21848__SW_… SO2_zero SO2   d 34S/32S            0 VCDT      S       R 34S/32S </span>
<span class="co">#&gt; 5 21870__BSA… SO2_zero SO2   d 18O/16O            0 VSMOW     H       R 2H/1H   </span>
<span class="co">#&gt; 6 21870__BSA… SO2_zero SO2   d 18O/16O            0 VSMOW     O       R 17O/16O </span>
<span class="co">#&gt; 7 21870__BSA… SO2_zero SO2   d 18O/16O            0 VSMOW     O       R 18O/16O </span>
<span class="co">#&gt; 8 21870__BSA… SO2_zero SO2   d 34S/32S            0 VCDT      S       R 34S/32S </span>
<span class="co">#&gt; # … with 1 more variable: ratio_value &lt;dbl&gt;</span></code></pre></div>
</div>
<div id="data-table" class="section level2">
<h2 class="hasAnchor">
<a href="#data-table" class="anchor"></a>Data Table</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">iso_files</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_get_vendor_data_table.html">iso_get_vendor_data_table</a></span><span class="op">(</span>with_explicit_units <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Info: aggregating vendor data table with explicit units from 2 data file(s)</span>
<span class="co">#&gt; # A tibble: 10 × 31</span>
<span class="co">#&gt;    file_id      Nr. `Start [s]` `Rt [s]` `End [s]` `Ampl 64 [mV]` `Ampl 66 [mV]`</span>
<span class="co">#&gt;    &lt;chr&gt;      &lt;int&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;</span>
<span class="co">#&gt;  1 21848__SW…     1        108.     128.      184.          1503.          7209.</span>
<span class="co">#&gt;  2 21848__SW…     2        585.     621.      754.          1372.          6697.</span>
<span class="co">#&gt;  3 21848__SW…     3       1123.    1143.     1201.          1501.          7200.</span>
<span class="co">#&gt;  4 21848__SW…     4       1203.    1223.     1282.          1523.          7307.</span>
<span class="co">#&gt;  5 21848__SW…     5       1282.    1302.     1373.          1532.          7350.</span>
<span class="co">#&gt;  6 21870__BS…     1        108.     128.      188.          1565.          7512.</span>
<span class="co">#&gt;  7 21870__BS…     2        583.     617.      715.           521.          2503.</span>
<span class="co">#&gt;  8 21870__BS…     3       1123.    1143.     1198.          1538.          7383.</span>
<span class="co">#&gt;  9 21870__BS…     4       1203.    1223.     1281.          1559.          7483.</span>
<span class="co">#&gt; 10 21870__BS…     5       1282.    1302.     1366.          1565.          7514.</span>
<span class="co">#&gt; # … with 24 more variables: BGD 64 [mV] &lt;dbl&gt;, BGD 66 [mV] &lt;dbl&gt;,</span>
<span class="co">#&gt; #   rIntensity 64 [mVs] &lt;dbl&gt;, rIntensity 66 [mVs] &lt;dbl&gt;,</span>
<span class="co">#&gt; #   rIntensity All [mVs] &lt;dbl&gt;, Intensity 64 [Vs] &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Intensity 66 [Vs] &lt;dbl&gt;, Intensity All [Vs] &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Sample Dilution [%] &lt;dbl&gt;, List First Peak &lt;int&gt;, rR 66SO2/64SO2 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Rps 66SO2/64SO2 &lt;dbl&gt;, Is Ref.? &lt;int&gt;, R 66SO2/64SO2 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Ref. Name &lt;chr&gt;, rd 66SO2/64SO2 [permil] &lt;dbl&gt;, …</span></code></pre></div>
</div>
<div id="calculations" class="section level2">
<h2 class="hasAnchor">
<a href="#calculations" class="anchor"></a>Calculations</h2>
<p>These are the calculations that Isodat does. Not saying they are correct, it’s just what it does.</p>
<div id="fetch-all-information" class="section level3">
<h3 class="hasAnchor">
<a href="#fetch-all-information" class="anchor"></a>Fetch all information</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># retrieve data table, resistors and standards, the relevant data for the calculations</span>
<span class="va">all_data</span>  <span class="op">&lt;-</span>
  <span class="va">iso_files</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_get_all_data.html">iso_get_all_data</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">file_id</span>, <span class="va">resistors</span>, <span class="va">standards</span>, <span class="va">vendor_data_table</span><span class="op">)</span>
<span class="co">#&gt; Info: aggregating all data from 2 data file(s)</span>
<span class="va">all_data</span>
<span class="co">#&gt; # A tibble: 2 × 4</span>
<span class="co">#&gt;   file_id                resistors        standards        vendor_data_table</span>
<span class="co">#&gt;   &lt;chr&gt;                  &lt;list&gt;           &lt;list&gt;           &lt;list&gt;           </span>
<span class="co">#&gt; 1 21848__SW_50.dxf       &lt;tibble [2 × 3]&gt; &lt;tibble [4 × 8]&gt; &lt;tibble [5 × 30]&gt;</span>
<span class="co">#&gt; 2 21870__BSA2 CA3_sm.dxf &lt;tibble [2 × 3]&gt; &lt;tibble [4 × 8]&gt; &lt;tibble [5 × 30]&gt;</span></code></pre></div>
</div>
<div id="do-the-calculations" class="section level3">
<h3 class="hasAnchor">
<a href="#do-the-calculations" class="anchor"></a>Do the calculations</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculations</span>
<span class="va">calculations</span> <span class="op">&lt;-</span> 
  <span class="va">all_data</span> <span class="op">%&gt;%</span> 
  <span class="co"># unpack the vendor data table</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span><span class="va">vendor_data_table</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># do each set of calculations within each file</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">file_id</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># do all the calculations</span>
  <span class="co"># only columns required for all of the following are rIntensity 64 </span>
  <span class="co">#   and rIntensity 66 (+ resistors and standards)</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    <span class="co"># rIntensity All is just the sum of the r(ecorded) intensities</span>
    `rIntensity All new` <span class="op">=</span> <span class="va">`rIntensity 64`</span> <span class="op">+</span> <span class="va">`rIntensity 66`</span>,
    <span class="co"># the intensity of the major ion is just scaled from mVs to Vs</span>
    `Intensity 64 new` <span class="op">=</span> <span class="va">`rIntensity 64`</span> <span class="op">/</span> <span class="fl">1000</span>,
    <span class="co"># the other intensities are scaled by the resistor ratio to account for </span>
    <span class="co">#   different signal amplification</span>
    resistor_ratio <span class="op">=</span> <span class="fu">map_dbl</span><span class="op">(</span>
      <span class="va">resistors</span>, 
      <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">.x</span>, <span class="va">R.Ohm</span><span class="op">[</span><span class="va">mass</span> <span class="op">==</span> <span class="st">"64"</span><span class="op">]</span> <span class="op">/</span> <span class="va">R.Ohm</span><span class="op">[</span><span class="va">mass</span> <span class="op">==</span> <span class="st">"66"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,
    `Intensity 66 new` <span class="op">=</span> <span class="va">`rIntensity 66`</span> <span class="op">/</span> <span class="fl">1000</span> <span class="op">*</span> <span class="va">resistor_ratio</span>,
    <span class="co"># IntensityAll then again is just the some of the scaled intensities</span>
    `Intensity All new` <span class="op">=</span> <span class="va">`Intensity 64 new`</span> <span class="op">+</span> <span class="va">`Intensity 66 new`</span>,
    <span class="co"># the r(ecorded) ratio is just based on the r(ecorded)Intensities</span>
    `rR 66SO2/64SO2 new` <span class="op">=</span> <span class="va">`rIntensity 66`</span> <span class="op">/</span> <span class="va">`rIntensity 64`</span>,
    <span class="co"># whereas the actual Ratio is based on known reference ratios and linear </span>
    <span class="co"># extrapolation (as far as I can tell) between the reference peaks</span>
    <span class="co">## 1. known isotopic composition of the ref peaks (Rps)</span>
    `Rps 66SO2/64SO2 new` <span class="op">=</span> <span class="fu">map2_dbl</span><span class="op">(</span>
      <span class="va">standards</span>, <span class="va">`Is Ref.?`</span>,
        <span class="co"># nb 1: they only calculate this for reference peaks (silly anyways, </span>
        <span class="co">#       it's always the same!)</span>
        <span class="co"># nb 2: the SO2 ref gas here (SO2_zero) was defined with delta of 0 in </span>
        <span class="co">#       both S and O, hence using the ref ratios directly in the following calculation</span>
        <span class="co"># nb 3: note that isodat does not consider the isotopologue 64=32+17+17 </span>
        <span class="co">#       so their ratio is actually slightly wrong!! </span>
        <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">.x</span>, <span class="va">ratio_value</span><span class="op">[</span><span class="va">ratio_name</span> <span class="op">==</span> <span class="st">"R 34S/32S"</span><span class="op">]</span> <span class="op">+</span> 
                    <span class="fl">2</span> <span class="op">*</span> <span class="va">ratio_value</span><span class="op">[</span><span class="va">ratio_name</span> <span class="op">==</span> <span class="st">"R 18O/16O"</span><span class="op">]</span><span class="op">)</span>
        <span class="co"># correct would be the following (but the difference is in the 7th digit, </span>
        <span class="co">#    see for yourself what difference it makes in the final deltas):</span>
        <span class="co">#~ with(.x, ratio_value[ratio_name == "R 34S/32S"] + 2 * ratio_value[ratio_name == "R 18O/16O"] + ratio_value[ratio_name == "R 17O/16O"]^2)</span>
       <span class="op">)</span>,
    <span class="co">## 2. linearly extrapolated ref ratio at all retention times</span>
    ref_ratio_at_Rt <span class="op">=</span> 
      <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, 
         data <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>
           x <span class="op">=</span> <span class="va">Rt</span><span class="op">[</span><span class="va">`Is Ref.?`</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span>, 
           y <span class="op">=</span> <span class="va">`rR 66SO2/64SO2 new`</span><span class="op">[</span><span class="va">`Is Ref.?`</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
      <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>newdata <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Rt</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="op">)</span>,
    <span class="co">## 3. resulting calculated 66/64 ratio (note that since these relie on rR only, </span>
    <span class="co">#     the whole resistor shenanegans are not actually necessary)</span>
    `R 66SO2/64SO2 new` <span class="op">=</span> <span class="va">`rR 66SO2/64SO2 new`</span> <span class="op">/</span> <span class="va">ref_ratio_at_Rt</span> <span class="op">*</span> <span class="va">`Rps 66SO2/64SO2 new`</span>,
    <span class="co"># the delta value is then just calculated based on the standard definition R/R - 1)</span>
    `d 66SO2/64SO2 new` <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="va">`R 66SO2/64SO2 new`</span> <span class="op">/</span> <span class="va">`Rps 66SO2/64SO2 new`</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1000</span><span class="op">)</span> <span class="op">%&gt;%</span> 
      <span class="co"># due to inacuracies at the 10^-13 level in most machine calculations, rounding to 10 digits</span>
      <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>,
    <span class="co"># or more elegantly directly from the rR and extrapolated ref ratios</span>
    `d 66SO2/64SO2 new2` <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="va">`rR 66SO2/64SO2 new`</span> <span class="op">/</span> <span class="va">ref_ratio_at_Rt</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1000</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> </code></pre></div>
</div>
<div id="compare" class="section level3">
<h3 class="hasAnchor">
<a href="#compare" class="anchor"></a>Compare</h3>
<p>Now let’s compare all the isodat values with what we got. The suffix <code>new</code> indicates what we calculated</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># look at new rIntensity calculations --&gt; identical? yes</span>
<span class="va">calculations</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Nr.</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"rIntensity"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html">paged_table</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Nr."],"name":[1],"type":["int"],"align":["right"]},{"label":["rIntensity 64"],"name":[2],"type":["dbl[mVs]"],"align":["right"]},{"label":["rIntensity 66"],"name":[3],"type":["dbl[mVs]"],"align":["right"]},{"label":["rIntensity All"],"name":[4],"type":["dbl[mVs]"],"align":["right"]},{"label":["rIntensity All new"],"name":[5],"type":["dbl[mVs]"],"align":["right"]}],"data":[{"1":"1","2":"28713.04","3":"137742.74","4":"166455.78","5":"166455.78"},{"1":"2","2":"43951.76","3":"214895.61","4":"258847.36","5":"258847.36"},{"1":"3","2":"28595.79","3":"137197.59","4":"165793.38","5":"165793.38"},{"1":"4","2":"29404.11","3":"141082.77","4":"170486.89","5":"170486.89"},{"1":"5","2":"29604.37","3":"142032.35","4":"171636.72","5":"171636.72"},{"1":"1","2":"30155.52","3":"144848.76","4":"175004.29","5":"175004.29"},{"1":"2","2":"16516.98","3":"79791.83","4":"96308.81","5":"96308.81"},{"1":"3","2":"29352.44","3":"140947.04","4":"170299.48","5":"170299.48"},{"1":"4","2":"30107.68","3":"144587.37","4":"174695.05","5":"174695.05"},{"1":"5","2":"30277.75","3":"145393.18","4":"175670.93","5":"175670.93"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># look at new Intensity calculations --&gt; identical? yes</span>
<span class="va">calculations</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Nr.</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"Intensity"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html">paged_table</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Nr."],"name":[1],"type":["int"],"align":["right"]},{"label":["Intensity 64"],"name":[2],"type":["dbl[Vs]"],"align":["right"]},{"label":["Intensity 66"],"name":[3],"type":["dbl[Vs]"],"align":["right"]},{"label":["Intensity All"],"name":[4],"type":["dbl[Vs]"],"align":["right"]},{"label":["Intensity 64 new"],"name":[5],"type":["dbl[mVs]"],"align":["right"]},{"label":["Intensity 66 new"],"name":[6],"type":["dbl[mVs]"],"align":["right"]},{"label":["Intensity All new"],"name":[7],"type":["dbl[mVs]"],"align":["right"]}],"data":[{"1":"1","2":"28.71304","3":"1.3774274","4":"30.09046","5":"28.71304","6":"1.3774274","7":"30.09046"},{"1":"2","2":"43.95176","3":"2.1489561","4":"46.10071","5":"43.95176","6":"2.1489561","7":"46.10071"},{"1":"3","2":"28.59579","3":"1.3719759","4":"29.96777","5":"28.59579","6":"1.3719759","7":"29.96777"},{"1":"4","2":"29.40411","3":"1.4108277","4":"30.81494","5":"29.40411","6":"1.4108277","7":"30.81494"},{"1":"5","2":"29.60437","3":"1.4203235","4":"31.02469","5":"29.60437","6":"1.4203235","7":"31.02469"},{"1":"1","2":"30.15552","3":"1.4484876","4":"31.60401","5":"30.15552","6":"1.4484876","7":"31.60401"},{"1":"2","2":"16.51698","3":"0.7979183","4":"17.31490","5":"16.51698","6":"0.7979183","7":"17.31490"},{"1":"3","2":"29.35244","3":"1.4094704","4":"30.76191","5":"29.35244","6":"1.4094704","7":"30.76191"},{"1":"4","2":"30.10768","3":"1.4458737","4":"31.55355","5":"30.10768","6":"1.4458737","7":"31.55355"},{"1":"5","2":"30.27775","3":"1.4539318","4":"31.73168","5":"30.27775","6":"1.4539318","7":"31.73168"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># look at new ratio calculations --&gt; identical? yes</span>
<span class="va">calculations</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Nr.</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">matches</a></span><span class="op">(</span><span class="st">"R(ps)? 66"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html">paged_table</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Nr."],"name":[1],"type":["int"],"align":["right"]},{"label":["rR 66SO2/64SO2"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Rps 66SO2/64SO2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["R 66SO2/64SO2"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["rR 66SO2/64SO2 new"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Rps 66SO2/64SO2 new"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["R 66SO2/64SO2 new"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"4.797220","3":"0.0481613","4":"0.04816130","5":"4.797220","6":"0.0481613","7":"0.04816130"},{"1":"2","2":"4.889352","3":"NA","4":"0.04908427","5":"4.889352","6":"0.0481613","7":"0.04908427"},{"1":"3","2":"4.797825","3":"NA","4":"0.04816336","5":"4.797825","6":"0.0481613","7":"0.04816336"},{"1":"4","2":"4.798063","3":"NA","4":"0.04816543","5":"4.798063","6":"0.0481613","7":"0.04816543"},{"1":"5","2":"4.797682","3":"0.0481613","4":"0.04816130","5":"4.797682","6":"0.0481613","7":"0.04816130"},{"1":"1","2":"4.803391","3":"0.0481613","4":"0.04816130","5":"4.803391","6":"0.0481613","7":"0.04816130"},{"1":"2","2":"4.830897","3":"NA","4":"0.04844302","5":"4.830897","6":"0.0481613","7":"0.04844302"},{"1":"3","2":"4.801885","3":"NA","4":"0.04815842","5":"4.801885","6":"0.0481613","7":"0.04815842"},{"1":"4","2":"4.802342","3":"NA","4":"0.04816397","5":"4.802342","6":"0.0481613","7":"0.04816397"},{"1":"5","2":"4.801981","3":"0.0481613","4":"0.04816130","5":"4.801981","6":"0.0481613","7":"0.04816130"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># look at delta calculations --&gt; identical? yes</span>
<span class="va">calculations</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Nr.</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"d 66"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html">paged_table</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Nr."],"name":[1],"type":["int"],"align":["right"]},{"label":["d 66SO2/64SO2"],"name":[2],"type":["dbl[permil]"],"align":["right"]},{"label":["d 66SO2/64SO2 new"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["d 66SO2/64SO2 new2"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"0.00000000","3":"0.00000000","4":"0.00000000"},{"1":"2","2":"19.16413759","3":"19.16413759","4":"19.16413759"},{"1":"3","2":"0.04277384","3":"0.04277384","4":"0.04277384"},{"1":"4","2":"0.08584772","3":"0.08584772","4":"0.08584772"},{"1":"5","2":"0.00000000","3":"0.00000000","4":"0.00000000"},{"1":"1","2":"0.00000000","3":"0.00000000","4":"0.00000000"},{"1":"2","2":"5.84941884","3":"5.84941884","4":"5.84941884"},{"1":"3","2":"-0.05974813","3":"-0.05974813","4":"-0.05974813"},{"1":"4","2":"0.05536365","3":"0.05536365","4":"0.05536365"},{"1":"5","2":"0.00000000","3":"0.00000000","4":"0.00000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<div id="dual-inlet" class="section level1">
<h1 class="hasAnchor">
<a href="#dual-inlet" class="anchor"></a>Dual Inlet</h1>
<div id="read-data-1" class="section level2">
<h2 class="hasAnchor">
<a href="#read-data-1" class="anchor"></a>Read Data</h2>
<p>Using isoreader version 1.3.1.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">iso_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_read_dual_inlet.html">iso_read_dual_inlet</a></span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span>
<span class="co">#&gt; Info: preparing to read 4 data files (all will be cached)...</span>
<span class="co">#&gt; Info: reading file 'data/SP0.did' with '.did' reader...</span>
<span class="co">#&gt; Info: reading file 'data/SP1.did' with '.did' reader...</span>
<span class="co">#&gt; Info: reading file 'data/SP2.did' with '.did' reader...</span>
<span class="co">#&gt; Info: reading file 'data/SP3.did' with '.did' reader...</span>
<span class="co">#&gt; Info: finished reading 4 files in 2.56 secs</span>
<span class="va">iso_files</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_get_data_summary.html">iso_get_data_summary</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Info: aggregating data summary from 4 data file(s)</span>
<span class="co">#&gt; # A tibble: 4 × 6</span>
<span class="co">#&gt;   file_id raw_data          file_info method_info    vendor_data_tab… file_path </span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;glue&gt;            &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;            &lt;chr&gt;     </span>
<span class="co">#&gt; 1 SP0.did 8 cycles, 5 ions… 15 entri… standards, re… 8 rows, 8 colum… data/SP0.…</span>
<span class="co">#&gt; 2 SP1.did 8 cycles, 5 ions… 15 entri… standards, re… 8 rows, 8 colum… data/SP1.…</span>
<span class="co">#&gt; 3 SP2.did 8 cycles, 5 ions… 15 entri… standards, re… 8 rows, 8 colum… data/SP2.…</span>
<span class="co">#&gt; 4 SP3.did 8 cycles, 5 ions… 15 entri… standards, re… 8 rows, 8 colum… data/SP3.…</span></code></pre></div>
</div>
<div id="voltages" class="section level2">
<h2 class="hasAnchor">
<a href="#voltages" class="anchor"></a>Voltages</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">iso_files</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_calculate_ratios.html">iso_calculate_ratios</a></span><span class="op">(</span><span class="st">"45/44"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_plot_dual_inlet_data.html">iso_plot_dual_inlet_data</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Info: calculating ratio(s) in 4 data file(s): r45/44</span></code></pre></div>
<p><img src="isodat_calculations_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
</div>
<div id="data-table-1" class="section level2">
<h2 class="hasAnchor">
<a href="#data-table-1" class="anchor"></a>Data Table</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">iso_files</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_get_vendor_data_table.html">iso_get_vendor_data_table</a></span><span class="op">(</span>with_explicit_units <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Info: aggregating vendor data table with explicit units from 4 data file(s)</span>
<span class="co">#&gt; # A tibble: 32 × 9</span>
<span class="co">#&gt;    file_id cycle `d 45N2O/44N2O` `d 46N2O/44N2O` `d 18O/16O` `d 15N/14N`</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;int&gt;           &lt;dbl&gt;           &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt;  1 SP0.did     1          0.0696           -6.42       -6.47      0.246 </span>
<span class="co">#&gt;  2 SP0.did     2         -0.0252           -6.99       -7.04      0.161 </span>
<span class="co">#&gt;  3 SP0.did     3         -0.152            -6.43       -6.48      0.0133</span>
<span class="co">#&gt;  4 SP0.did     4         -0.0402           -6.79       -6.84      0.140 </span>
<span class="co">#&gt;  5 SP0.did     5          0.0236           -6.38       -6.43      0.196 </span>
<span class="co">#&gt;  6 SP0.did     6         -0.0685           -6.26       -6.30      0.0962</span>
<span class="co">#&gt;  7 SP0.did     7         -0.112            -6.41       -6.46      0.0541</span>
<span class="co">#&gt;  8 SP0.did     8         -0.0870           -6.60       -6.65      0.0859</span>
<span class="co">#&gt;  9 SP1.did     1          0.0213           -5.82       -5.87      0.179 </span>
<span class="co">#&gt; 10 SP1.did     2         -0.0117           -6.28       -6.33      0.157 </span>
<span class="co">#&gt; # … with 22 more rows, and 3 more variables: d 17O/16O &lt;dbl&gt;,</span>
<span class="co">#&gt; #   AT% 15N/14N &lt;dbl&gt;, AT% 18O/16O &lt;dbl&gt;</span></code></pre></div>
</div>
<div id="calculations-1" class="section level2">
<h2 class="hasAnchor">
<a href="#calculations-1" class="anchor"></a>Calculations</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculate ratios</span>
<span class="va">ratios</span> <span class="op">&lt;-</span> 
  <span class="va">iso_files</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_calculate_ratios.html">iso_calculate_ratios</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"45/44"</span>, <span class="st">"46/44"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_get_raw_data.html">iso_get_raw_data</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">file_id</span>, <span class="va">type</span>, <span class="va">cycle</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"r"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Info: calculating ratio(s) in 4 data file(s): r45/44, r46/44</span>
<span class="co">#&gt; Info: aggregating raw data from 4 data file(s)</span>
<span class="va">ratios</span>
<span class="co">#&gt; # A tibble: 68 × 5</span>
<span class="co">#&gt;    file_id type     cycle `r45/44` `r46/44`</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;    &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt;  1 SP0.did standard     0    0.809    0.596</span>
<span class="co">#&gt;  2 SP0.did standard     1    0.809    0.597</span>
<span class="co">#&gt;  3 SP0.did standard     2    0.810    0.597</span>
<span class="co">#&gt;  4 SP0.did standard     3    0.810    0.597</span>
<span class="co">#&gt;  5 SP0.did standard     4    0.810    0.597</span>
<span class="co">#&gt;  6 SP0.did standard     5    0.811    0.597</span>
<span class="co">#&gt;  7 SP0.did standard     6    0.811    0.597</span>
<span class="co">#&gt;  8 SP0.did standard     7    0.811    0.597</span>
<span class="co">#&gt;  9 SP0.did standard     8    0.811    0.597</span>
<span class="co">#&gt; 10 SP0.did sample       1    0.809    0.593</span>
<span class="co">#&gt; # … with 58 more rows</span>
  
<span class="co"># get bracketing standards</span>
<span class="va">pre_standard</span> <span class="op">&lt;-</span> <span class="va">ratios</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"standard"</span>, <span class="va">cycle</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">cycle</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>cycle <span class="op">=</span> <span class="va">cycle</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">post_standard</span> <span class="op">&lt;-</span> <span class="va">ratios</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"standard"</span>, <span class="va">cycle</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">cycle</span><span class="op">)</span><span class="op">)</span>
<span class="va">standards</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">pre_standard</span>, <span class="va">post_standard</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"file_id"</span>, <span class="st">"cycle"</span>, <span class="st">"type"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># calculate deltas based on average of bracketing standards</span>
<span class="va">deltas</span> <span class="op">&lt;-</span> <span class="va">ratios</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"sample"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">left_join</span><span class="op">(</span><span class="va">standards</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"file_id"</span>, <span class="st">"cycle"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    `d45/44` <span class="op">=</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">`r45/44`</span> <span class="op">/</span> <span class="op">(</span><span class="va">`r45/44.x`</span> <span class="op">+</span> <span class="va">`r45/44.y`</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1e3</span>,
    `d46/44` <span class="op">=</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">`r46/44`</span> <span class="op">/</span> <span class="op">(</span><span class="va">`r46/44.x`</span> <span class="op">+</span> <span class="va">`r46/44.y`</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1e3</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">file_id</span>, <span class="va">cycle</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"d"</span><span class="op">)</span><span class="op">)</span>
<span class="va">deltas</span>
<span class="co">#&gt; # A tibble: 32 × 4</span>
<span class="co">#&gt;    file_id cycle `d45/44` `d46/44`</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt;  1 SP0.did     1   0.0696    -6.42</span>
<span class="co">#&gt;  2 SP0.did     2  -0.0252    -6.99</span>
<span class="co">#&gt;  3 SP0.did     3  -0.152     -6.43</span>
<span class="co">#&gt;  4 SP0.did     4  -0.0402    -6.79</span>
<span class="co">#&gt;  5 SP0.did     5   0.0236    -6.38</span>
<span class="co">#&gt;  6 SP0.did     6  -0.0685    -6.26</span>
<span class="co">#&gt;  7 SP0.did     7  -0.112     -6.41</span>
<span class="co">#&gt;  8 SP0.did     8  -0.0870    -6.60</span>
<span class="co">#&gt;  9 SP1.did     1   0.0213    -5.82</span>
<span class="co">#&gt; 10 SP1.did     2  -0.0117    -6.28</span>
<span class="co">#&gt; # … with 22 more rows</span></code></pre></div>
</div>
<div id="compare-1" class="section level2">
<h2 class="hasAnchor">
<a href="#compare-1" class="anchor"></a>Compare</h2>
<p>Compare this with the vendor data table.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># check identical --&gt; correct</span>
<span class="va">deltas</span> <span class="op">%&gt;%</span> 
  <span class="fu">left_join</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_get_vendor_data_table.html">iso_get_vendor_data_table</a></span><span class="op">(</span><span class="va">iso_files</span><span class="op">)</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"file_id"</span>, <span class="st">"cycle"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/paged_table.html">paged_table</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Info: aggregating vendor data table from 4 data file(s)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["file_id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["cycle"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["d45/44"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["d46/44"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["d 45N2O/44N2O"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["d 46N2O/44N2O"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["d 18O/16O"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["d 15N/14N"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["d 17O/16O"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["AT% 15N/14N"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["AT% 18O/16O"],"name":[11],"type":["dbl"],"align":["right"]}],"data":[{"1":"SP0.did","2":"1","3":"0.0695836377","4":"-6.416335","5":"0.0695836377","6":"-6.416335","7":"-6.467569","8":"0.24579113","9":"-3.342506","10":"0.3665618","11":"0.1988270"},{"1":"SP0.did","2":"2","3":"-0.0251587139","4":"-6.986262","5":"-0.0251587139","6":"-6.986262","7":"-7.040467","8":"0.16147242","9":"-3.639092","10":"0.3665310","11":"0.1987126"},{"1":"SP0.did","2":"3","3":"-0.1517973573","4":"-6.430527","5":"-0.1517973573","6":"-6.430527","7":"-6.478408","8":"0.01326727","9":"-3.348116","10":"0.3664769","11":"0.1988248"},{"1":"SP0.did","2":"4","3":"-0.0402017180","4":"-6.787766","5":"-0.0402017180","6":"-6.787766","7":"-6.840185","8":"0.14029757","9":"-3.535398","10":"0.3665233","11":"0.1987526"},{"1":"SP0.did","2":"5","3":"0.0236056519","4":"-6.377333","5":"0.0236056519","6":"-6.377333","7":"-6.427542","8":"0.19636878","9":"-3.321787","10":"0.3665437","11":"0.1988350"},{"1":"SP0.did","2":"6","3":"-0.0684716192","4":"-6.255927","5":"-0.0684716192","6":"-6.255927","7":"-6.303747","8":"0.09622743","9":"-3.257711","10":"0.3665072","11":"0.1988597"},{"1":"SP0.did","2":"7","3":"-0.1124020573","4":"-6.406739","5":"-0.1124020573","6":"-6.406739","7":"-6.455050","8":"0.05407265","9":"-3.336025","10":"0.3664918","11":"0.1988295"},{"1":"SP0.did","2":"8","3":"-0.0869839840","4":"-6.595829","5":"-0.0869839840","6":"-6.595829","7":"-6.646015","8":"0.08590830","9":"-3.434878","10":"0.3665034","11":"0.1987914"},{"1":"SP1.did","2":"1","3":"0.0212730886","4":"-5.819413","5":"0.0212730886","6":"-5.819413","7":"-5.865226","8":"0.17888676","9":"-3.030765","10":"0.3665374","11":"0.1989473"},{"1":"SP1.did","2":"2","3":"-0.0116962027","4":"-6.284945","5":"-0.0116962027","6":"-6.284945","7":"-6.333880","8":"0.15674029","9":"-3.273308","10":"0.3665293","11":"0.1988537"},{"1":"SP1.did","2":"3","3":"-0.0463690661","4":"-6.503373","5":"-0.0463690661","6":"-6.503373","7":"-6.553472","8":"0.12614671","9":"-3.386972","10":"0.3665181","11":"0.1988099"},{"1":"SP1.did","2":"4","3":"0.0401688063","4":"-6.720651","5":"0.0401688063","6":"-6.720651","7":"-6.773803","8":"0.22304384","9":"-3.501031","10":"0.3665535","11":"0.1987659"},{"1":"SP1.did","2":"5","3":"-0.1129069358","4":"-6.554617","5":"-0.1129069358","6":"-6.554617","7":"-6.604076","8":"0.05752545","9":"-3.413167","10":"0.3664930","11":"0.1987998"},{"1":"SP1.did","2":"6","3":"-0.1219932706","4":"-6.776263","5":"-0.1219932706","6":"-6.776263","7":"-6.827312","8":"0.05393796","9":"-3.528733","10":"0.3664917","11":"0.1987552"},{"1":"SP1.did","2":"7","3":"-0.0505676935","4":"-6.501813","5":"-0.0505676935","6":"-6.501813","7":"-6.551835","8":"0.12168749","9":"-3.386124","10":"0.3665165","11":"0.1988102"},{"1":"SP1.did","2":"8","3":"-0.0760722410","4":"-6.697782","5":"-0.0760722410","6":"-6.697782","7":"-6.748935","8":"0.10013503","9":"-3.488157","10":"0.3665086","11":"0.1987708"},{"1":"SP2.did","2":"1","3":"-0.0104912284","4":"-6.550781","5":"-0.0104912284","6":"-6.550781","7":"-6.601812","8":"0.16516961","9":"-3.411995","10":"0.3665324","11":"0.1988002"},{"1":"SP2.did","2":"2","3":"0.0605773867","4":"-6.021719","5":"0.0605773867","6":"-6.021719","7":"-6.069728","8":"0.22568605","9":"-3.136594","10":"0.3665544","11":"0.1989065"},{"1":"SP2.did","2":"3","3":"-0.0780668219","4":"-6.067451","5":"-0.0780668219","6":"-6.067451","7":"-6.113647","8":"0.08105577","9":"-3.159324","10":"0.3665016","11":"0.1988977"},{"1":"SP2.did","2":"4","3":"0.0002553778","4":"-6.436831","5":"0.0002553778","6":"-6.436831","7":"-6.487140","8":"0.17340577","9":"-3.352636","10":"0.3665354","11":"0.1988231"},{"1":"SP2.did","2":"5","3":"0.0247515090","4":"-6.236027","5":"0.0247515090","6":"-6.236027","7":"-6.285150","8":"0.19376771","9":"-3.248086","10":"0.3665428","11":"0.1988634"},{"1":"SP2.did","2":"6","3":"-0.0937535613","4":"-6.216417","5":"-0.0937535613","6":"-6.216417","7":"-6.263532","8":"0.06856498","9":"-3.236897","10":"0.3664971","11":"0.1988678"},{"1":"SP2.did","2":"7","3":"-0.0568623304","4":"-6.120747","5":"-0.0568623304","6":"-6.120747","7":"-6.167693","8":"0.10479976","9":"-3.187294","10":"0.3665103","11":"0.1988869"},{"1":"SP2.did","2":"8","3":"-0.0910373433","4":"-6.588009","5":"-0.0910373433","6":"-6.588009","7":"-6.638071","8":"0.08143323","9":"-3.430765","10":"0.3665018","11":"0.1987930"},{"1":"SP3.did","2":"1","3":"-0.0958119009","4":"-6.499102","5":"-0.0958119009","6":"-6.499102","7":"-6.548394","8":"0.07401480","9":"-3.384344","10":"0.3664991","11":"0.1988109"},{"1":"SP3.did","2":"2","3":"-0.0259333662","4":"-6.351999","5":"-0.0259333662","6":"-6.351999","7":"-6.401235","8":"0.14356826","9":"-3.308170","10":"0.3665245","11":"0.1988403"},{"1":"SP3.did","2":"3","3":"0.0310188620","4":"-5.923685","5":"0.0310188620","6":"-5.923685","7":"-5.970465","8":"0.19194824","9":"-3.085225","10":"0.3665421","11":"0.1989263"},{"1":"SP3.did","2":"4","3":"-0.1192634397","4":"-6.597849","5":"-0.1192634397","6":"-6.597849","7":"-6.647546","8":"0.05200280","9":"-3.435670","10":"0.3664910","11":"0.1987911"},{"1":"SP3.did","2":"5","3":"-0.1118974919","4":"-6.807892","5":"-0.1118974919","6":"-6.807892","7":"-6.859346","8":"0.06541157","9":"-3.545318","10":"0.3664959","11":"0.1987488"},{"1":"SP3.did","2":"6","3":"-0.0831944606","4":"-6.359629","5":"-0.0831944606","6":"-6.359629","7":"-6.408029","8":"0.08353169","9":"-3.311687","10":"0.3665025","11":"0.1988389"},{"1":"SP3.did","2":"7","3":"-0.0551040500","4":"-6.226498","5":"-0.0551040500","6":"-6.226498","7":"-6.274297","8":"0.10949816","9":"-3.242468","10":"0.3665120","11":"0.1988656"},{"1":"SP3.did","2":"8","3":"-0.1356149378","4":"-5.975262","5":"-0.1356149378","6":"-5.975262","7":"-6.019838","8":"0.01802859","9":"-3.110775","10":"0.3664786","11":"0.1989164"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>delta 18O and delta 15N can be calculated from delta 45 and delta 46 with 17O correction (e.g. using Jan Kaiser and Thomas Röckmann in “Correction of mass spectrometric isotope ratio measurements for isobaric isotopologues of O2, CO, CO2, N2O and SO2”,Rapid Communications in Mass Spectrometry, 2008, 3997–4008).</p>
<p>Note that both the delta calcluations and 17O correction will be available through functions in <a href="isoprocessor.isoverse.org">isoprocessor</a> at some point (might be already, this file may be out of date).</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Sebastian Kopf.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
