<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EA-IRMS data processing example: carbon • isoprocessor</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="EA-IRMS data processing example: carbon">
<meta property="og:description" content="isoprocessor">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-106138361-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-106138361-4');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">isoprocessor</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="in active development">0.6.11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/dual_inlet.html">Dual Inlet</a>
</li>
<li>
  <a href="../articles/continuous_flow.html">Continuous Flow</a>
</li>
<li>
  <a href="../articles/scan.html">Scan</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Processing Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ea_irms_example_carbon.html">Bulk carbon isotope analysis</a>
    </li>
    <li>
      <a href="../articles/gc_irms_example_carbon.html">Compound specific carbon isotope analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/isoverse/isoprocessor">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ea_irms_example_carbon_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>EA-IRMS data processing example: carbon</h1>
            <h3 class="subtitle">bulk carbon isotopes</h3>
            
            <h4 class="date">2021-03-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/isoverse/isoprocessor/blob/master/vignettes/ea_irms_example_carbon.Rmd"><code>vignettes/ea_irms_example_carbon.Rmd</code></a></small>
      <div class="hidden name"><code>ea_irms_example_carbon.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This is an example of a data processing pipeline for bulk Elemental Analyser Isotope Ratio Mass Spectrometry (EA-IRMS) carbon isotope measurements. It can be downloaded as a template (or just to see the plain-text code) by following the <code>Source</code> link above. Knitting for stand-alone data analysis works best to <code>HTML</code> rather than the website rendering you see here. To make this formatting change simply delete line #6 in the template file (the line that says <code>rmarkdown::html_vignette:</code>).</p>
<p>Note that all code chunks that contain a critical step towards the final data (i.e. do more than visualization or a data summary) are marked with <code>(*)</code> in the header to make it easier to follow all key steps during interactive use.</p>
<p>This example was run using <strong><a href="http://isoreader.kopflab.org">isoreader</a> version 1.3.0</strong> and <strong><a href="http://isoprocessor.kopflab.org/">isoprocessor</a> version 0.6.11</strong>. If you want to reproduce the example, please make sure that you have these or newer versions of both packages installed:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># restart your R session (this command only works in RStudio)</span>
<span class="fu">.rs.restartR</span><span class="op">(</span><span class="op">)</span>

<span class="co"># installs the development tools package if not yet installed</span>
<span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"devtools"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span> 

<span class="co"># installs the newest version of isoreader and isoprocessor</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"isoverse/isoreader"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"isoverse/isoprocessor"</span><span class="op">)</span></code></pre></div>
</div>
<div id="load-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#load-packages" class="anchor"></a>Load packages</h1>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co"># general data wrangling and plotting</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/isoverse/isoreader">isoreader</a></span><span class="op">)</span> <span class="co"># reading the raw data files</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/isoverse/isoprocessor">isoprocessor</a></span><span class="op">)</span> <span class="co"># processing the data</span></code></pre></div>
</div>
<div id="load-data" class="section level1">
<h1 class="hasAnchor">
<a href="#load-data" class="anchor"></a>Load data</h1>
<div id="read-raw-data-files" class="section level2">
<h2 class="hasAnchor">
<a href="#read-raw-data-files" class="anchor"></a>Read raw data files (*)</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># set file path(s) to data files, folders or rds collections </span>
<span class="co"># can be multiple folders or mix of folders and files, using example data set here</span>
<span class="va">data_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/iso_get_processor_example.html">iso_get_processor_example</a></span><span class="op">(</span><span class="st">"ea_irms_example_carbon.cf.rds"</span><span class="op">)</span>

<span class="co"># read files</span>
<span class="va">iso_files_raw</span> <span class="op">&lt;-</span> 
  <span class="co"># path to data files</span>
  <span class="va">data_path</span> <span class="op">%&gt;%</span> 
  <span class="co"># read data files in parallel for fast read</span>
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_read_continuous_flow.html">iso_read_continuous_flow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co"># filter out files with read errors (e.g. from aborted analysis)</span>
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_filter_files_with_problems.html">iso_filter_files_with_problems</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Info: preparing to read 1 data files (all will be cached)...</span>
<span class="co">#&gt; Info: reading file 'ea_irms_example_carbon.cf.rds' with '.cf.rds' reader...</span>
<span class="co">#&gt; Info: loaded 121 data files from R Data Storage</span>
<span class="co">#&gt; Info: finished reading 1 files in 0.46 secs</span>
<span class="co">#&gt; Info: removing 0/121 files that have any error (keeping 121)</span></code></pre></div>
</div>
<div id="process-file-info-peak-table" class="section level2">
<h2 class="hasAnchor">
<a href="#process-file-info-peak-table" class="anchor"></a>Process file info &amp; peak table (*)</h2>
<div id="peak-table" class="section level3">
<h3 class="hasAnchor">
<a href="#peak-table" class="anchor"></a>Peak Table</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># process peak table</span>
<span class="va">iso_files_w_peak_table</span> <span class="op">&lt;-</span> <span class="va">iso_files_raw</span> <span class="op">%&gt;%</span> 
  <span class="co"># set peak table from vendor data table</span>
  <span class="fu"><a href="../reference/iso_set_peak_table_from_vendor_data_table.html">iso_set_peak_table_automatically_from_vendor_data_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># convert units from mV to V for amplitudes and area</span>
  <span class="fu"><a href="../reference/iso_convert_peak_table_units.html">iso_convert_peak_table_units</a></span><span class="op">(</span>V <span class="op">=</span> <span class="va">mV</span>, Vs <span class="op">=</span> <span class="va">mVs</span><span class="op">)</span> 
<span class="co">#&gt; Info: setting peak table for 121 file(s) from vendor data table with the following renames:</span>
<span class="co">#&gt; - for 121 file(s): 'Nr.'-&gt;'peak_nr', 'Is Ref.?'-&gt;'is_ref', 'Start'-&gt;'rt_start', 'Rt'-&gt;'rt', 'End'-&gt;'rt_end', 'Ampl 28'-&gt;'amp28', 'Ampl 29'-&gt;'amp29', 'Ampl 30'-&gt;'amp30', 'Ampl 44'-&gt;'amp44', 'Ampl 45'-&gt;'amp45', 'Ampl 46'-&gt;'amp46', 'BGD 28'-&gt;'bgrd28_start', 'BGD 29'-&gt;'bgrd29_start', 'BGD 30'-&gt;'bgrd30_start', 'BGD 44'-&gt;'bgrd44_start', 'BGD 45'-&gt;'bgrd45_start', 'BGD 46'-&gt;'bgrd46_start', 'BGD 28'-&gt;'bgrd28_end', 'BGD 29'-&gt;'bgrd29_end', 'BGD 30'-&gt;'bgrd30_end', 'BGD 44'-&gt;'bgrd44_end', 'BGD 45'-&gt;'bgrd45_end', 'BGD 46'-&gt;'bgrd46_end', 'rIntensity 28'-&gt;'area28', 'rIntensity 29'-&gt;'area29', 'rIntensity 30'-&gt;'area30', 'rIntensity 44'-&gt;'area44', 'rIntensity 45'-&gt;'area45', 'rIntensity 46'-&gt;'area46', 'rR 29N2/28N2'-&gt;'r29/28', 'rR 45CO2/44CO2'-&gt;'r45/44', 'rR 46CO2/44CO2'-&gt;'r46/44', 'rd 29N2/28N2'-&gt;'rd29/28', 'rd 45CO2/44CO2'-&gt;'rd45/44', 'rd 46CO2/44CO2'-&gt;'rd46/44', 'd 29N2/28N2'-&gt;'d29/28', 'd 45CO2/44CO2'-&gt;'d45/44', 'd 46CO2/44CO2'-&gt;'d46/44', 'd 15N/14N'-&gt;'d15N', 'd 13C/12C'-&gt;'d13C', 'd 18O/16O'-&gt;'d18O', 'd 17O/16O'-&gt;'d17O', 'AT% 15N/14N'-&gt;'at15N', 'AT% 13C/12C'-&gt;'at13C', 'AT% 18O/16O'-&gt;'at18O'</span>
<span class="co">#&gt; Info: converting peak table column units where applicable from 'mV'-&gt;'V' and 'mVs'-&gt;'Vs' for columns matching 'everything()'</span></code></pre></div>
</div>
<div id="file-info" class="section level3">
<h3 class="hasAnchor">
<a href="#file-info" class="anchor"></a>File Info</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># process file information</span>
<span class="va">iso_files_w_file_info</span> <span class="op">&lt;-</span> <span class="va">iso_files_w_peak_table</span> <span class="op">%&gt;%</span> 
  <span class="co"># rename key file info columns</span>
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_rename_file_info.html">iso_rename_file_info</a></span><span class="op">(</span>
    id1 <span class="op">=</span> <span class="va">`Identifier 1`</span>, id2 <span class="op">=</span> <span class="va">`Identifier 2`</span>, prep <span class="op">=</span> <span class="va">Preparation</span>,
    seq_nr <span class="op">=</span> <span class="va">Row</span>, analysis <span class="op">=</span> <span class="va">Analysis</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># parse text info into numbers</span>
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_parse_file_info.html">iso_parse_file_info</a></span><span class="op">(</span>number <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">seq_nr</span>, <span class="va">analysis</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># process specific sequence file information</span>
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_mutate_file_info.html">iso_mutate_file_info</a></span><span class="op">(</span>
    <span class="co"># what is the type of each analysis?</span>
    type <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
      <span class="va">id1</span> <span class="op">==</span> <span class="st">"empty"</span>      <span class="op">~</span> <span class="st">"empty"</span>,
      <span class="va">id1</span> <span class="op">==</span> <span class="st">"blank"</span>      <span class="op">~</span> <span class="st">"blank"</span>,
      <span class="va">prep</span> <span class="op">==</span> <span class="st">"lin.std"</span>   <span class="op">~</span> <span class="st">"linearity"</span>,
      <span class="va">prep</span> <span class="op">==</span> <span class="st">"drift.std"</span> <span class="op">~</span> <span class="st">"drift"</span>,
      <span class="va">id1</span> <span class="op">==</span> <span class="st">"pugel"</span>      <span class="op">~</span> <span class="st">"scale1"</span>,
      <span class="va">id1</span> <span class="op">==</span> <span class="st">"EDTA2"</span>      <span class="op">~</span> <span class="st">"scale2"</span>,
      <span class="cn">TRUE</span>                <span class="op">~</span> <span class="st">"sample"</span>
    <span class="op">)</span>,
    <span class="co"># what is the mass of the sample?</span>
    mass <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_number.html">parse_number</a></span><span class="op">(</span><span class="va">id2</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_with_units.html">iso_double_with_units</a></span><span class="op">(</span><span class="st">"ug"</span><span class="op">)</span>,
    <span class="co"># what folder are the data files in? (usually folder = sequence)</span>
    folder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html">basename</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/basename.html">dirname</a></span><span class="op">(</span><span class="va">file_path</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># focus only on the relevant file info, discarding the rest</span>
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_select_file_info.html">iso_select_file_info</a></span><span class="op">(</span><span class="va">folder</span>, <span class="va">analysis</span>, <span class="va">seq_nr</span>, <span class="va">file_datetime</span>, <span class="va">id1</span>, <span class="va">id2</span>, <span class="va">type</span>, <span class="va">mass</span><span class="op">)</span>
<span class="co">#&gt; Info: renaming the following file info across 121 data file(s): 'Identifier 1'-&gt;'id1', 'Identifier 2'-&gt;'id2', 'Preparation'-&gt;'prep', 'Row'-&gt;'seq_nr', 'Analysis'-&gt;'analysis'</span>
<span class="co">#&gt; Info: parsing 2 file info columns for 121 data file(s):</span>
<span class="co">#&gt;  - to number: 'seq_nr', 'analysis'</span>
<span class="co">#&gt; Info: mutating file info for 121 data file(s)</span>
<span class="co">#&gt; Info: selecting/renaming the following file info across 121 data file(s): 'folder', 'analysis', 'seq_nr', 'file_datetime', 'id1', 'id2', 'type', 'mass'</span></code></pre></div>
</div>
<div id="file-filter" class="section level3">
<h3 class="hasAnchor">
<a href="#file-filter" class="anchor"></a>File Filter</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># filter out files we don't want to process futher</span>
<span class="va">iso_files_without_empty</span> <span class="op">&lt;-</span> <span class="va">iso_files_w_file_info</span> <span class="op">%&gt;%</span> 
  <span class="co"># filter out emptys at the beginning of the run</span>
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_filter_files.html">iso_filter_files</a></span><span class="op">(</span><span class="va">type</span> <span class="op">!=</span> <span class="st">"empty"</span><span class="op">)</span> 
<span class="co">#&gt; Info: applying file filter, keeping 118 of 121 files</span></code></pre></div>
</div>
<div id="peak-mapping" class="section level3">
<h3 class="hasAnchor">
<a href="#peak-mapping" class="anchor"></a>Peak Mapping</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># identify peaks</span>
<span class="va">peak_map</span> <span class="op">&lt;-</span> 
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
    <span class="op">~</span><span class="va">compound</span>,     <span class="op">~</span><span class="va">ref_nr</span>, <span class="op">~</span><span class="va">rt</span>,
    <span class="co"># peak map data (row-by-row)</span>
    <span class="st">"CO2 analyte"</span>, <span class="cn">NA</span>,        <span class="fl">300</span>,
    <span class="st">"CO2 ref"</span>,          <span class="fl">1</span>,      <span class="fl">415</span>,
    <span class="st">"CO2 ref"</span>,          <span class="fl">2</span>,      <span class="fl">465</span>
  <span class="op">)</span>
<span class="va">peak_map</span> <span class="op">%&gt;%</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">compound</th>
<th align="right">ref_nr</th>
<th align="right">rt</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">CO2 analyte</td>
<td align="right">NA</td>
<td align="right">300</td>
</tr>
<tr class="even">
<td align="left">CO2 ref</td>
<td align="right">1</td>
<td align="right">415</td>
</tr>
<tr class="odd">
<td align="left">CO2 ref</td>
<td align="right">2</td>
<td align="right">465</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">iso_files_w_mapped_peaks</span> <span class="op">&lt;-</span> <span class="va">iso_files_without_empty</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/iso_map_peaks.html">iso_map_peaks</a></span><span class="op">(</span><span class="va">peak_map</span><span class="op">)</span>
<span class="co">#&gt; Info: 354 of 707 peaks in 118 files were successfully mapped using a single peak map. 353 peak(s) could not be mapped.</span>

<span class="co"># show first few rows of the peak mappings summary (unmapped peaks = N2)</span>
<span class="va">iso_files_w_mapped_peaks</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_summarize_peak_mappings.html">iso_summarize_peak_mappings</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="14%">
<col width="5%">
<col width="7%">
<col width="5%">
<col width="66%">
</colgroup>
<thead><tr class="header">
<th align="left">file_id</th>
<th align="left">mapped</th>
<th align="left">ambiguous</th>
<th align="left">missing</th>
<th align="left">peak_info</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">19602__blank_0.dxf</td>
<td align="left">3/6</td>
<td align="left">0/3</td>
<td align="left">0/3</td>
<td align="left">?? (58.94), ?? (108.7), ?? (186.2), CO2 analyte (304.7), CO2 ref (427.2), CO2 ref (477.1)</td>
</tr>
<tr class="even">
<td align="left">19603__acn1_44.dxf</td>
<td align="left">3/6</td>
<td align="left">0/3</td>
<td align="left">0/3</td>
<td align="left">?? (58.94), ?? (108.7), ?? (156.8), CO2 analyte (304.1), CO2 ref (427.4), CO2 ref (477.1)</td>
</tr>
<tr class="odd">
<td align="left">19604__EDTA2_70.dxf</td>
<td align="left">3/6</td>
<td align="left">0/3</td>
<td align="left">0/3</td>
<td align="left">?? (58.94), ?? (108.7), ?? (156.5), CO2 analyte (303.9), CO2 ref (427.4), CO2 ref (477.1)</td>
</tr>
<tr class="even">
<td align="left">19605__pugel_73.dxf</td>
<td align="left">3/6</td>
<td align="left">0/3</td>
<td align="left">0/3</td>
<td align="left">?? (58.94), ?? (108.7), ?? (156.5), CO2 analyte (304.1), CO2 ref (427.4), CO2 ref (477.1)</td>
</tr>
<tr class="odd">
<td align="left">19606__acn1_9.dxf</td>
<td align="left">3/6</td>
<td align="left">0/3</td>
<td align="left">0/3</td>
<td align="left">?? (58.94), ?? (108.7), ?? (157.4), CO2 analyte (304.7), CO2 ref (427.4), CO2 ref (477.1)</td>
</tr>
<tr class="even">
<td align="left">19607__acn1_22.dxf</td>
<td align="left">3/6</td>
<td align="left">0/3</td>
<td align="left">0/3</td>
<td align="left">?? (58.94), ?? (108.7), ?? (156.3), CO2 analyte (303.9), CO2 ref (427.4), CO2 ref (477.1)</td>
</tr>
<tr class="odd">
<td align="left">19608__acn1_30.dxf</td>
<td align="left">3/6</td>
<td align="left">0/3</td>
<td align="left">0/3</td>
<td align="left">?? (58.94), ?? (108.7), ?? (156.8), CO2 analyte (304.1), CO2 ref (427.4), CO2 ref (477.1)</td>
</tr>
<tr class="even">
<td align="left">19609__acn1_39.dxf</td>
<td align="left">3/6</td>
<td align="left">0/3</td>
<td align="left">0/3</td>
<td align="left">?? (58.94), ?? (108.7), ?? (156.3), CO2 analyte (303.5), CO2 ref (427.4), CO2 ref (477.1)</td>
</tr>
<tr class="odd">
<td align="left">19610__acn1_47.dxf</td>
<td align="left">3/6</td>
<td align="left">0/3</td>
<td align="left">0/3</td>
<td align="left">?? (58.94), ?? (108.7), ?? (156.8), CO2 analyte (303.7), CO2 ref (427.4), CO2 ref (477.1)</td>
</tr>
<tr class="even">
<td align="left">19611__acn1_62.dxf</td>
<td align="left">3/6</td>
<td align="left">0/3</td>
<td align="left">0/3</td>
<td align="left">?? (58.94), ?? (108.7), ?? (156.1), CO2 analyte (303), CO2 ref (427.4), CO2 ref (477.1)</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># assign final collection of iso_files to a simpler name</span>
<span class="va">iso_files</span> <span class="op">&lt;-</span> <span class="va">iso_files_w_mapped_peaks</span></code></pre></div>
</div>
</div>
<div id="show-file-information" class="section level2">
<h2 class="hasAnchor">
<a href="#show-file-information" class="anchor"></a>Show file information</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># display file information</span>
<span class="va">iso_files</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_get_file_info.html">iso_get_file_info</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_make_units_explicit.html">iso_make_units_explicit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Info: aggregating file info from 118 data file(s)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="19%">
<col width="14%">
<col width="8%">
<col width="6%">
<col width="19%">
<col width="5%">
<col width="3%">
<col width="9%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="left">file_id</th>
<th align="left">folder</th>
<th align="right">analysis</th>
<th align="right">seq_nr</th>
<th align="left">file_datetime</th>
<th align="left">id1</th>
<th align="left">id2</th>
<th align="left">type</th>
<th align="right">mass [ug]</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">19602__blank_0.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19602</td>
<td align="right">4</td>
<td align="left">2019-06-25 15:51:45</td>
<td align="left">blank</td>
<td align="left">0</td>
<td align="left">blank</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">19603__acn1_44.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19603</td>
<td align="right">5</td>
<td align="left">2019-06-25 16:01:29</td>
<td align="left">acn1</td>
<td align="left">44</td>
<td align="left">drift</td>
<td align="right">44</td>
</tr>
<tr class="odd">
<td align="left">19604__EDTA2_70.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19604</td>
<td align="right">6</td>
<td align="left">2019-06-25 16:11:14</td>
<td align="left">EDTA2</td>
<td align="left">70</td>
<td align="left">scale2</td>
<td align="right">70</td>
</tr>
<tr class="even">
<td align="left">19605__pugel_73.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19605</td>
<td align="right">7</td>
<td align="left">2019-06-25 16:20:59</td>
<td align="left">pugel</td>
<td align="left">73</td>
<td align="left">scale1</td>
<td align="right">73</td>
</tr>
<tr class="odd">
<td align="left">19606__acn1_9.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19606</td>
<td align="right">8</td>
<td align="left">2019-06-25 16:30:44</td>
<td align="left">acn1</td>
<td align="left">9</td>
<td align="left">linearity</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="left">19607__acn1_22.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19607</td>
<td align="right">9</td>
<td align="left">2019-06-25 16:40:28</td>
<td align="left">acn1</td>
<td align="left">22</td>
<td align="left">linearity</td>
<td align="right">22</td>
</tr>
<tr class="odd">
<td align="left">19608__acn1_30.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19608</td>
<td align="right">10</td>
<td align="left">2019-06-25 16:50:13</td>
<td align="left">acn1</td>
<td align="left">30</td>
<td align="left">linearity</td>
<td align="right">30</td>
</tr>
<tr class="even">
<td align="left">19609__acn1_39.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19609</td>
<td align="right">11</td>
<td align="left">2019-06-25 16:59:57</td>
<td align="left">acn1</td>
<td align="left">39</td>
<td align="left">linearity</td>
<td align="right">39</td>
</tr>
<tr class="odd">
<td align="left">19610__acn1_47.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19610</td>
<td align="right">12</td>
<td align="left">2019-06-25 17:09:45</td>
<td align="left">acn1</td>
<td align="left">47</td>
<td align="left">linearity</td>
<td align="right">47</td>
</tr>
<tr class="even">
<td align="left">19611__acn1_62.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19611</td>
<td align="right">13</td>
<td align="left">2019-06-25 17:19:34</td>
<td align="left">acn1</td>
<td align="left">62</td>
<td align="left">linearity</td>
<td align="right">62</td>
</tr>
<tr class="odd">
<td align="left">19612__acn1_70.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19612</td>
<td align="right">14</td>
<td align="left">2019-06-25 17:29:19</td>
<td align="left">acn1</td>
<td align="left">70</td>
<td align="left">linearity</td>
<td align="right">70</td>
</tr>
<tr class="even">
<td align="left">19613__acn1_79.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19613</td>
<td align="right">15</td>
<td align="left">2019-06-25 17:39:23</td>
<td align="left">acn1</td>
<td align="left">79</td>
<td align="left">linearity</td>
<td align="right">79</td>
</tr>
<tr class="odd">
<td align="left">19614__acn1_93.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19614</td>
<td align="right">16</td>
<td align="left">2019-06-25 17:49:07</td>
<td align="left">acn1</td>
<td align="left">93</td>
<td align="left">linearity</td>
<td align="right">93</td>
</tr>
<tr class="even">
<td align="left">19615__acn1_114.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19615</td>
<td align="right">17</td>
<td align="left">2019-06-25 17:58:52</td>
<td align="left">acn1</td>
<td align="left">114</td>
<td align="left">linearity</td>
<td align="right">114</td>
</tr>
<tr class="odd">
<td align="left">19616__EDTA2_74.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19616</td>
<td align="right">18</td>
<td align="left">2019-06-25 18:08:36</td>
<td align="left">EDTA2</td>
<td align="left">74</td>
<td align="left">scale2</td>
<td align="right">74</td>
</tr>
<tr class="even">
<td align="left">19617__acn1_45.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19617</td>
<td align="right">19</td>
<td align="left">2019-06-25 18:18:20</td>
<td align="left">acn1</td>
<td align="left">45</td>
<td align="left">drift</td>
<td align="right">45</td>
</tr>
<tr class="odd">
<td align="left">19618__3-1_81.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19618</td>
<td align="right">20</td>
<td align="left">2019-06-25 18:28:05</td>
<td align="left">3-1</td>
<td align="left">81</td>
<td align="left">sample</td>
<td align="right">81</td>
</tr>
<tr class="even">
<td align="left">19619__3-2_65.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19619</td>
<td align="right">21</td>
<td align="left">2019-06-25 18:39:47</td>
<td align="left">3-2</td>
<td align="left">65</td>
<td align="left">sample</td>
<td align="right">65</td>
</tr>
<tr class="odd">
<td align="left">19620__3-3_79.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19620</td>
<td align="right">22</td>
<td align="left">2019-06-25 18:49:32</td>
<td align="left">3-3</td>
<td align="left">79</td>
<td align="left">sample</td>
<td align="right">79</td>
</tr>
<tr class="even">
<td align="left">19621__3-4_91.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19621</td>
<td align="right">23</td>
<td align="left">2019-06-25 18:59:16</td>
<td align="left">3-4</td>
<td align="left">91</td>
<td align="left">sample</td>
<td align="right">91</td>
</tr>
<tr class="odd">
<td align="left">19622__3-5_92.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19622</td>
<td align="right">24</td>
<td align="left">2019-06-25 19:09:01</td>
<td align="left">3-5</td>
<td align="left">92</td>
<td align="left">sample</td>
<td align="right">92</td>
</tr>
<tr class="even">
<td align="left">19623__3-6_111.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19623</td>
<td align="right">25</td>
<td align="left">2019-06-25 19:18:45</td>
<td align="left">3-6</td>
<td align="left">111</td>
<td align="left">sample</td>
<td align="right">111</td>
</tr>
<tr class="odd">
<td align="left">19624__acn1_44.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19624</td>
<td align="right">26</td>
<td align="left">2019-06-25 19:28:29</td>
<td align="left">acn1</td>
<td align="left">44</td>
<td align="left">drift</td>
<td align="right">44</td>
</tr>
<tr class="even">
<td align="left">19625__EDTA2_71.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19625</td>
<td align="right">27</td>
<td align="left">2019-06-25 19:38:14</td>
<td align="left">EDTA2</td>
<td align="left">71</td>
<td align="left">scale2</td>
<td align="right">71</td>
</tr>
<tr class="odd">
<td align="left">19626__3-7_89.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19626</td>
<td align="right">28</td>
<td align="left">2019-06-25 19:47:59</td>
<td align="left">3-7</td>
<td align="left">89</td>
<td align="left">sample</td>
<td align="right">89</td>
</tr>
<tr class="even">
<td align="left">19627__3-8_90.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19627</td>
<td align="right">29</td>
<td align="left">2019-06-25 19:57:43</td>
<td align="left">3-8</td>
<td align="left">90</td>
<td align="left">sample</td>
<td align="right">90</td>
</tr>
<tr class="odd">
<td align="left">19628__3-9_90.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19628</td>
<td align="right">30</td>
<td align="left">2019-06-25 20:07:27</td>
<td align="left">3-9</td>
<td align="left">90</td>
<td align="left">sample</td>
<td align="right">90</td>
</tr>
<tr class="even">
<td align="left">19629__3-10_100.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19629</td>
<td align="right">31</td>
<td align="left">2019-06-25 20:17:12</td>
<td align="left">3-10</td>
<td align="left">100</td>
<td align="left">sample</td>
<td align="right">100</td>
</tr>
<tr class="odd">
<td align="left">19630__3-11_68.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19630</td>
<td align="right">32</td>
<td align="left">2019-06-25 20:26:56</td>
<td align="left">3-11</td>
<td align="left">68</td>
<td align="left">sample</td>
<td align="right">68</td>
</tr>
<tr class="even">
<td align="left">19631__3-12_81.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19631</td>
<td align="right">33</td>
<td align="left">2019-06-25 20:36:45</td>
<td align="left">3-12</td>
<td align="left">81</td>
<td align="left">sample</td>
<td align="right">81</td>
</tr>
<tr class="odd">
<td align="left">19632__acn1_44.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19632</td>
<td align="right">34</td>
<td align="left">2019-06-25 20:46:29</td>
<td align="left">acn1</td>
<td align="left">44</td>
<td align="left">drift</td>
<td align="right">44</td>
</tr>
<tr class="even">
<td align="left">19633__pugel_69.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19633</td>
<td align="right">35</td>
<td align="left">2019-06-25 20:56:13</td>
<td align="left">pugel</td>
<td align="left">69</td>
<td align="left">scale1</td>
<td align="right">69</td>
</tr>
<tr class="odd">
<td align="left">19634__EDTA2_73.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19634</td>
<td align="right">36</td>
<td align="left">2019-06-25 21:05:58</td>
<td align="left">EDTA2</td>
<td align="left">73</td>
<td align="left">scale2</td>
<td align="right">73</td>
</tr>
<tr class="even">
<td align="left">19635__3-13_85.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19635</td>
<td align="right">37</td>
<td align="left">2019-06-25 21:15:42</td>
<td align="left">3-13</td>
<td align="left">85</td>
<td align="left">sample</td>
<td align="right">85</td>
</tr>
<tr class="odd">
<td align="left">19636__3-14_52.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19636</td>
<td align="right">38</td>
<td align="left">2019-06-25 21:25:27</td>
<td align="left">3-14</td>
<td align="left">52</td>
<td align="left">sample</td>
<td align="right">52</td>
</tr>
<tr class="even">
<td align="left">19637__3-15_42.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19637</td>
<td align="right">39</td>
<td align="left">2019-06-25 21:35:11</td>
<td align="left">3-15</td>
<td align="left">42</td>
<td align="left">sample</td>
<td align="right">42</td>
</tr>
<tr class="odd">
<td align="left">19638__3-16_85.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19638</td>
<td align="right">40</td>
<td align="left">2019-06-25 21:44:55</td>
<td align="left">3-16</td>
<td align="left">85</td>
<td align="left">sample</td>
<td align="right">85</td>
</tr>
<tr class="even">
<td align="left">19639__3-17_109.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19639</td>
<td align="right">41</td>
<td align="left">2019-06-25 21:55:21</td>
<td align="left">3-17</td>
<td align="left">109</td>
<td align="left">sample</td>
<td align="right">109</td>
</tr>
<tr class="odd">
<td align="left">19640__3-18_102.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19640</td>
<td align="right">42</td>
<td align="left">2019-06-25 22:05:05</td>
<td align="left">3-18</td>
<td align="left">102</td>
<td align="left">sample</td>
<td align="right">102</td>
</tr>
<tr class="even">
<td align="left">19641__acn1_45.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19641</td>
<td align="right">43</td>
<td align="left">2019-06-25 22:14:49</td>
<td align="left">acn1</td>
<td align="left">45</td>
<td align="left">drift</td>
<td align="right">45</td>
</tr>
<tr class="odd">
<td align="left">19642__EDTA_74.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19642</td>
<td align="right">44</td>
<td align="left">2019-06-25 22:24:34</td>
<td align="left">EDTA</td>
<td align="left">74</td>
<td align="left">sample</td>
<td align="right">74</td>
</tr>
<tr class="even">
<td align="left">19643__3-19_92.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19643</td>
<td align="right">45</td>
<td align="left">2019-06-25 22:34:18</td>
<td align="left">3-19</td>
<td align="left">92</td>
<td align="left">sample</td>
<td align="right">92</td>
</tr>
<tr class="odd">
<td align="left">19644__blank_0.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19644</td>
<td align="right">46</td>
<td align="left">2019-06-25 22:44:03</td>
<td align="left">blank</td>
<td align="left">0</td>
<td align="left">blank</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">19645__3-20_82.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19645</td>
<td align="right">47</td>
<td align="left">2019-06-25 22:53:47</td>
<td align="left">3-20</td>
<td align="left">82</td>
<td align="left">sample</td>
<td align="right">82</td>
</tr>
<tr class="odd">
<td align="left">19646__3-21_98.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19646</td>
<td align="right">48</td>
<td align="left">2019-06-25 23:03:32</td>
<td align="left">3-21</td>
<td align="left">98</td>
<td align="left">sample</td>
<td align="right">98</td>
</tr>
<tr class="even">
<td align="left">19647__3-22_71.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19647</td>
<td align="right">49</td>
<td align="left">2019-06-25 23:13:16</td>
<td align="left">3-22</td>
<td align="left">71</td>
<td align="left">sample</td>
<td align="right">71</td>
</tr>
<tr class="odd">
<td align="left">19648__3-23_74.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19648</td>
<td align="right">50</td>
<td align="left">2019-06-25 23:23:00</td>
<td align="left">3-23</td>
<td align="left">74</td>
<td align="left">sample</td>
<td align="right">74</td>
</tr>
<tr class="even">
<td align="left">19649__acn1_44.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19649</td>
<td align="right">51</td>
<td align="left">2019-06-25 23:32:45</td>
<td align="left">acn1</td>
<td align="left">44</td>
<td align="left">drift</td>
<td align="right">44</td>
</tr>
<tr class="odd">
<td align="left">19650__EDTA2_70.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19650</td>
<td align="right">52</td>
<td align="left">2019-06-25 23:42:29</td>
<td align="left">EDTA2</td>
<td align="left">70</td>
<td align="left">scale2</td>
<td align="right">70</td>
</tr>
<tr class="even">
<td align="left">19651__3-24_59.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19651</td>
<td align="right">53</td>
<td align="left">2019-06-25 23:52:13</td>
<td align="left">3-24</td>
<td align="left">59</td>
<td align="left">sample</td>
<td align="right">59</td>
</tr>
<tr class="odd">
<td align="left">19652__3-25_81.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19652</td>
<td align="right">54</td>
<td align="left">2019-06-26 00:01:59</td>
<td align="left">3-25</td>
<td align="left">81</td>
<td align="left">sample</td>
<td align="right">81</td>
</tr>
<tr class="even">
<td align="left">19653__3-26_81.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19653</td>
<td align="right">55</td>
<td align="left">2019-06-26 00:11:43</td>
<td align="left">3-26</td>
<td align="left">81</td>
<td align="left">sample</td>
<td align="right">81</td>
</tr>
<tr class="odd">
<td align="left">19654__3-27_69.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19654</td>
<td align="right">56</td>
<td align="left">2019-06-26 00:21:27</td>
<td align="left">3-27</td>
<td align="left">69</td>
<td align="left">sample</td>
<td align="right">69</td>
</tr>
<tr class="even">
<td align="left">19655__3-28_97.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19655</td>
<td align="right">57</td>
<td align="left">2019-06-26 00:31:12</td>
<td align="left">3-28</td>
<td align="left">97</td>
<td align="left">sample</td>
<td align="right">97</td>
</tr>
<tr class="odd">
<td align="left">19656__3-29_90.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19656</td>
<td align="right">58</td>
<td align="left">2019-06-26 00:40:56</td>
<td align="left">3-29</td>
<td align="left">90</td>
<td align="left">sample</td>
<td align="right">90</td>
</tr>
<tr class="even">
<td align="left">19657__act1_43.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19657</td>
<td align="right">59</td>
<td align="left">2019-06-26 00:56:06</td>
<td align="left">act1</td>
<td align="left">43</td>
<td align="left">drift</td>
<td align="right">43</td>
</tr>
<tr class="odd">
<td align="left">19658__EDTA2_72.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19658</td>
<td align="right">60</td>
<td align="left">2019-06-26 01:05:50</td>
<td align="left">EDTA2</td>
<td align="left">72</td>
<td align="left">scale2</td>
<td align="right">72</td>
</tr>
<tr class="even">
<td align="left">19659__3-30_88.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19659</td>
<td align="right">61</td>
<td align="left">2019-06-26 01:15:35</td>
<td align="left">3-30</td>
<td align="left">88</td>
<td align="left">sample</td>
<td align="right">88</td>
</tr>
<tr class="odd">
<td align="left">19660__3-31_88.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19660</td>
<td align="right">62</td>
<td align="left">2019-06-26 01:25:19</td>
<td align="left">3-31</td>
<td align="left">88</td>
<td align="left">sample</td>
<td align="right">88</td>
</tr>
<tr class="even">
<td align="left">19661__3-32_61.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19661</td>
<td align="right">63</td>
<td align="left">2019-06-26 01:35:03</td>
<td align="left">3-32</td>
<td align="left">61</td>
<td align="left">sample</td>
<td align="right">61</td>
</tr>
<tr class="odd">
<td align="left">19662__3-33_76.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19662</td>
<td align="right">64</td>
<td align="left">2019-06-26 01:44:48</td>
<td align="left">3-33</td>
<td align="left">76</td>
<td align="left">sample</td>
<td align="right">76</td>
</tr>
<tr class="even">
<td align="left">19663__3-34_78.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19663</td>
<td align="right">65</td>
<td align="left">2019-06-26 01:54:32</td>
<td align="left">3-34</td>
<td align="left">78</td>
<td align="left">sample</td>
<td align="right">78</td>
</tr>
<tr class="odd">
<td align="left">19664__3-35_99.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19664</td>
<td align="right">66</td>
<td align="left">2019-06-26 02:04:17</td>
<td align="left">3-35</td>
<td align="left">99</td>
<td align="left">sample</td>
<td align="right">99</td>
</tr>
<tr class="even">
<td align="left">19665__act1_45.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19665</td>
<td align="right">67</td>
<td align="left">2019-06-26 02:14:01</td>
<td align="left">act1</td>
<td align="left">45</td>
<td align="left">drift</td>
<td align="right">45</td>
</tr>
<tr class="odd">
<td align="left">19666__EDTA2_70.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19666</td>
<td align="right">68</td>
<td align="left">2019-06-26 02:23:45</td>
<td align="left">EDTA2</td>
<td align="left">70</td>
<td align="left">scale2</td>
<td align="right">70</td>
</tr>
<tr class="even">
<td align="left">19667__3-36_53.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19667</td>
<td align="right">69</td>
<td align="left">2019-06-26 02:33:30</td>
<td align="left">3-36</td>
<td align="left">53</td>
<td align="left">sample</td>
<td align="right">53</td>
</tr>
<tr class="odd">
<td align="left">19668__3-40_96.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19668</td>
<td align="right">70</td>
<td align="left">2019-06-26 02:43:15</td>
<td align="left">3-40</td>
<td align="left">96</td>
<td align="left">sample</td>
<td align="right">96</td>
</tr>
<tr class="even">
<td align="left">19669__3-41_80.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19669</td>
<td align="right">71</td>
<td align="left">2019-06-26 02:53:00</td>
<td align="left">3-41</td>
<td align="left">80</td>
<td align="left">sample</td>
<td align="right">80</td>
</tr>
<tr class="odd">
<td align="left">19670__3-42_95.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19670</td>
<td align="right">72</td>
<td align="left">2019-06-26 03:02:44</td>
<td align="left">3-42</td>
<td align="left">95</td>
<td align="left">sample</td>
<td align="right">95</td>
</tr>
<tr class="even">
<td align="left">19671__3-43_106.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19671</td>
<td align="right">73</td>
<td align="left">2019-06-26 03:12:29</td>
<td align="left">3-43</td>
<td align="left">106</td>
<td align="left">sample</td>
<td align="right">106</td>
</tr>
<tr class="odd">
<td align="left">19672__3-44_114.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19672</td>
<td align="right">74</td>
<td align="left">2019-06-26 03:22:13</td>
<td align="left">3-44</td>
<td align="left">114</td>
<td align="left">sample</td>
<td align="right">114</td>
</tr>
<tr class="even">
<td align="left">19673__act1_48.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19673</td>
<td align="right">75</td>
<td align="left">2019-06-26 03:31:58</td>
<td align="left">act1</td>
<td align="left">48</td>
<td align="left">drift</td>
<td align="right">48</td>
</tr>
<tr class="odd">
<td align="left">19674__EDTA2_70.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19674</td>
<td align="right">76</td>
<td align="left">2019-06-26 03:41:42</td>
<td align="left">EDTA2</td>
<td align="left">70</td>
<td align="left">scale2</td>
<td align="right">70</td>
</tr>
<tr class="even">
<td align="left">19675__3-45_81.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19675</td>
<td align="right">77</td>
<td align="left">2019-06-26 03:51:27</td>
<td align="left">3-45</td>
<td align="left">81</td>
<td align="left">sample</td>
<td align="right">81</td>
</tr>
<tr class="odd">
<td align="left">19676__3-46_77.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19676</td>
<td align="right">78</td>
<td align="left">2019-06-26 04:01:11</td>
<td align="left">3-46</td>
<td align="left">77</td>
<td align="left">sample</td>
<td align="right">77</td>
</tr>
<tr class="even">
<td align="left">19677__3-47_67.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19677</td>
<td align="right">79</td>
<td align="left">2019-06-26 04:10:55</td>
<td align="left">3-47</td>
<td align="left">67</td>
<td align="left">sample</td>
<td align="right">67</td>
</tr>
<tr class="odd">
<td align="left">19678__blank_0.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19678</td>
<td align="right">80</td>
<td align="left">2019-06-26 04:20:40</td>
<td align="left">blank</td>
<td align="left">0</td>
<td align="left">blank</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">19679__3-53_87.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19679</td>
<td align="right">81</td>
<td align="left">2019-06-26 04:30:24</td>
<td align="left">3-53</td>
<td align="left">87</td>
<td align="left">sample</td>
<td align="right">87</td>
</tr>
<tr class="odd">
<td align="left">19680__3-56_81.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19680</td>
<td align="right">82</td>
<td align="left">2019-06-26 04:40:09</td>
<td align="left">3-56</td>
<td align="left">81</td>
<td align="left">sample</td>
<td align="right">81</td>
</tr>
<tr class="even">
<td align="left">19681__act1_47.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19681</td>
<td align="right">83</td>
<td align="left">2019-06-26 04:49:53</td>
<td align="left">act1</td>
<td align="left">47</td>
<td align="left">drift</td>
<td align="right">47</td>
</tr>
<tr class="odd">
<td align="left">19682__EDTA2_73.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19682</td>
<td align="right">84</td>
<td align="left">2019-06-26 04:59:37</td>
<td align="left">EDTA2</td>
<td align="left">73</td>
<td align="left">scale2</td>
<td align="right">73</td>
</tr>
<tr class="even">
<td align="left">19683__3-59_72.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19683</td>
<td align="right">85</td>
<td align="left">2019-06-26 05:09:22</td>
<td align="left">3-59</td>
<td align="left">72</td>
<td align="left">sample</td>
<td align="right">72</td>
</tr>
<tr class="odd">
<td align="left">19684__4-4_89.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19684</td>
<td align="right">86</td>
<td align="left">2019-06-26 05:19:07</td>
<td align="left">4-4</td>
<td align="left">89</td>
<td align="left">sample</td>
<td align="right">89</td>
</tr>
<tr class="even">
<td align="left">19685__4-5_97.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19685</td>
<td align="right">87</td>
<td align="left">2019-06-26 05:28:52</td>
<td align="left">4-5</td>
<td align="left">97</td>
<td align="left">sample</td>
<td align="right">97</td>
</tr>
<tr class="odd">
<td align="left">19686__4-6_84.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19686</td>
<td align="right">88</td>
<td align="left">2019-06-26 05:38:36</td>
<td align="left">4-6</td>
<td align="left">84</td>
<td align="left">sample</td>
<td align="right">84</td>
</tr>
<tr class="even">
<td align="left">19687__4-7_104.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19687</td>
<td align="right">89</td>
<td align="left">2019-06-26 05:48:20</td>
<td align="left">4-7</td>
<td align="left">104</td>
<td align="left">sample</td>
<td align="right">104</td>
</tr>
<tr class="odd">
<td align="left">19688__4-8_74.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19688</td>
<td align="right">90</td>
<td align="left">2019-06-26 05:58:05</td>
<td align="left">4-8</td>
<td align="left">74</td>
<td align="left">sample</td>
<td align="right">74</td>
</tr>
<tr class="even">
<td align="left">19689__act1_44.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19689</td>
<td align="right">91</td>
<td align="left">2019-06-26 06:07:49</td>
<td align="left">act1</td>
<td align="left">44</td>
<td align="left">drift</td>
<td align="right">44</td>
</tr>
<tr class="odd">
<td align="left">19690__pugel_70.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19690</td>
<td align="right">92</td>
<td align="left">2019-06-26 06:17:34</td>
<td align="left">pugel</td>
<td align="left">70</td>
<td align="left">scale1</td>
<td align="right">70</td>
</tr>
<tr class="even">
<td align="left">19691__EDTA2_71.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19691</td>
<td align="right">93</td>
<td align="left">2019-06-26 06:27:18</td>
<td align="left">EDTA2</td>
<td align="left">71</td>
<td align="left">scale2</td>
<td align="right">71</td>
</tr>
<tr class="odd">
<td align="left">19692__4-9_87.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19692</td>
<td align="right">94</td>
<td align="left">2019-06-26 06:37:03</td>
<td align="left">4-9</td>
<td align="left">87</td>
<td align="left">sample</td>
<td align="right">87</td>
</tr>
<tr class="even">
<td align="left">19693__4-10_70.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19693</td>
<td align="right">95</td>
<td align="left">2019-06-26 06:46:47</td>
<td align="left">4-10</td>
<td align="left">70</td>
<td align="left">sample</td>
<td align="right">70</td>
</tr>
<tr class="odd">
<td align="left">19694__4-11_63.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19694</td>
<td align="right">96</td>
<td align="left">2019-06-26 06:56:31</td>
<td align="left">4-11</td>
<td align="left">63</td>
<td align="left">sample</td>
<td align="right">63</td>
</tr>
<tr class="even">
<td align="left">19695__4-12_56.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19695</td>
<td align="right">97</td>
<td align="left">2019-06-26 07:06:16</td>
<td align="left">4-12</td>
<td align="left">56</td>
<td align="left">sample</td>
<td align="right">56</td>
</tr>
<tr class="odd">
<td align="left">19696__4-16_76.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19696</td>
<td align="right">98</td>
<td align="left">2019-06-26 07:16:00</td>
<td align="left">4-16</td>
<td align="left">76</td>
<td align="left">sample</td>
<td align="right">76</td>
</tr>
<tr class="even">
<td align="left">19697__4-17_92.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19697</td>
<td align="right">99</td>
<td align="left">2019-06-26 07:25:45</td>
<td align="left">4-17</td>
<td align="left">92</td>
<td align="left">sample</td>
<td align="right">92</td>
</tr>
<tr class="odd">
<td align="left">19698__act1_48.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19698</td>
<td align="right">100</td>
<td align="left">2019-06-26 07:35:29</td>
<td align="left">act1</td>
<td align="left">48</td>
<td align="left">drift</td>
<td align="right">48</td>
</tr>
<tr class="even">
<td align="left">19699__EDTA2_71.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19699</td>
<td align="right">101</td>
<td align="left">2019-06-26 07:45:14</td>
<td align="left">EDTA2</td>
<td align="left">71</td>
<td align="left">scale2</td>
<td align="right">71</td>
</tr>
<tr class="odd">
<td align="left">19700__4-18_63.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19700</td>
<td align="right">102</td>
<td align="left">2019-06-26 07:54:58</td>
<td align="left">4-18</td>
<td align="left">63</td>
<td align="left">sample</td>
<td align="right">63</td>
</tr>
<tr class="even">
<td align="left">19701__4-19_89.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19701</td>
<td align="right">103</td>
<td align="left">2019-06-26 08:04:43</td>
<td align="left">4-19</td>
<td align="left">89</td>
<td align="left">sample</td>
<td align="right">89</td>
</tr>
<tr class="odd">
<td align="left">19702__4-20_83.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19702</td>
<td align="right">104</td>
<td align="left">2019-06-26 08:14:27</td>
<td align="left">4-20</td>
<td align="left">83</td>
<td align="left">sample</td>
<td align="right">83</td>
</tr>
<tr class="even">
<td align="left">19703__4-21_106.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19703</td>
<td align="right">105</td>
<td align="left">2019-06-26 08:24:12</td>
<td align="left">4-21</td>
<td align="left">106</td>
<td align="left">sample</td>
<td align="right">106</td>
</tr>
<tr class="odd">
<td align="left">19704__4-22_59.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19704</td>
<td align="right">106</td>
<td align="left">2019-06-26 08:33:56</td>
<td align="left">4-22</td>
<td align="left">59</td>
<td align="left">sample</td>
<td align="right">59</td>
</tr>
<tr class="even">
<td align="left">19705__4-23_58.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19705</td>
<td align="right">107</td>
<td align="left">2019-06-26 08:43:41</td>
<td align="left">4-23</td>
<td align="left">58</td>
<td align="left">sample</td>
<td align="right">58</td>
</tr>
<tr class="odd">
<td align="left">19706__act1_48.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19706</td>
<td align="right">108</td>
<td align="left">2019-06-26 08:53:26</td>
<td align="left">act1</td>
<td align="left">48</td>
<td align="left">drift</td>
<td align="right">48</td>
</tr>
<tr class="even">
<td align="left">19707__EDTA2_70.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19707</td>
<td align="right">109</td>
<td align="left">2019-06-26 09:03:10</td>
<td align="left">EDTA2</td>
<td align="left">70</td>
<td align="left">scale2</td>
<td align="right">70</td>
</tr>
<tr class="odd">
<td align="left">19708__4-24_69.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19708</td>
<td align="right">110</td>
<td align="left">2019-06-26 09:12:55</td>
<td align="left">4-24</td>
<td align="left">69</td>
<td align="left">sample</td>
<td align="right">69</td>
</tr>
<tr class="even">
<td align="left">19709__4-29_79.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19709</td>
<td align="right">111</td>
<td align="left">2019-06-26 09:22:40</td>
<td align="left">4-29</td>
<td align="left">79</td>
<td align="left">sample</td>
<td align="right">79</td>
</tr>
<tr class="odd">
<td align="left">19710__4-30_62.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19710</td>
<td align="right">112</td>
<td align="left">2019-06-26 09:32:57</td>
<td align="left">4-30</td>
<td align="left">62</td>
<td align="left">sample</td>
<td align="right">62</td>
</tr>
<tr class="even">
<td align="left">19711__4-32_81.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19711</td>
<td align="right">113</td>
<td align="left">2019-06-26 09:42:42</td>
<td align="left">4-32</td>
<td align="left">81</td>
<td align="left">sample</td>
<td align="right">81</td>
</tr>
<tr class="odd">
<td align="left">19712__4-33_78.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19712</td>
<td align="right">114</td>
<td align="left">2019-06-26 09:52:26</td>
<td align="left">4-33</td>
<td align="left">78</td>
<td align="left">sample</td>
<td align="right">78</td>
</tr>
<tr class="even">
<td align="left">19713__4-35_55.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19713</td>
<td align="right">115</td>
<td align="left">2019-06-26 10:02:11</td>
<td align="left">4-35</td>
<td align="left">55</td>
<td align="left">sample</td>
<td align="right">55</td>
</tr>
<tr class="odd">
<td align="left">19714__act1_48.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19714</td>
<td align="right">116</td>
<td align="left">2019-06-26 10:11:55</td>
<td align="left">act1</td>
<td align="left">48</td>
<td align="left">drift</td>
<td align="right">48</td>
</tr>
<tr class="even">
<td align="left">19715__EDTA2_73.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19715</td>
<td align="right">117</td>
<td align="left">2019-06-26 10:21:39</td>
<td align="left">EDTA2</td>
<td align="left">73</td>
<td align="left">scale2</td>
<td align="right">73</td>
</tr>
<tr class="odd">
<td align="left">19716__4-36_59.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19716</td>
<td align="right">118</td>
<td align="left">2019-06-26 10:31:24</td>
<td align="left">4-36</td>
<td align="left">59</td>
<td align="left">sample</td>
<td align="right">59</td>
</tr>
<tr class="even">
<td align="left">19717__4-41_55.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19717</td>
<td align="right">119</td>
<td align="left">2019-06-26 10:41:08</td>
<td align="left">4-41</td>
<td align="left">55</td>
<td align="left">sample</td>
<td align="right">55</td>
</tr>
<tr class="odd">
<td align="left">19718__4-42_80.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19718</td>
<td align="right">120</td>
<td align="left">2019-06-26 10:50:53</td>
<td align="left">4-42</td>
<td align="left">80</td>
<td align="left">sample</td>
<td align="right">80</td>
</tr>
<tr class="even">
<td align="left">19719__4-47_57.dxf</td>
<td align="left">190625_EA_data</td>
<td align="right">19719</td>
<td align="right">121</td>
<td align="left">2019-06-26 11:00:37</td>
<td align="left">4-47</td>
<td align="left">57</td>
<td align="left">sample</td>
<td align="right">57</td>
</tr>
</tbody>
</table>
</div>
<div id="example-chromatograms" class="section level2">
<h2 class="hasAnchor">
<a href="#example-chromatograms" class="anchor"></a>Example chromatograms</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plot the chromatograms</span>
<span class="va">iso_files</span> <span class="op">%&gt;%</span> 
  <span class="co"># select a few analyses to show</span>
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_filter_files.html">iso_filter_files</a></span><span class="op">(</span><span class="va">analysis</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">19642</span>, <span class="fl">19656</span>, <span class="fl">19681</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># introduce a label column for coloring the lines</span>
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_mutate_file_info.html">iso_mutate_file_info</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"#%d: %s (%s)"</span>, <span class="va">analysis</span>, <span class="va">id1</span>, <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># generate plot</span>
  <span class="fu"><a href="../reference/iso_plot_continuous_flow_data.html">iso_plot_continuous_flow_data</a></span><span class="op">(</span>
    <span class="co"># select data and aesthetics</span>
    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">44</span><span class="op">)</span>, color <span class="op">=</span> <span class="va">label</span>, panel <span class="op">=</span> <span class="cn">NULL</span>,
    <span class="co"># peak labels for the analyte peak</span>
    peak_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_format.html">iso_format</a></span><span class="op">(</span><span class="va">id1</span>, <span class="va">rt</span>, <span class="va">d13C</span>, signif <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,
    peak_label_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, nudge_x <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,
    peak_label_filter <span class="op">=</span> <span class="va">compound</span> <span class="op">==</span> <span class="st">"CO2 analyte"</span>
  <span class="op">)</span> 
<span class="co">#&gt; Info: applying file filter, keeping 3 of 118 files</span>
<span class="co">#&gt; Info: mutating file info for 3 data file(s)</span></code></pre></div>
<p><img src="ea_irms_example_carbon_files/figure-html/example_chromatograms-1.png" width="768"></p>
</div>
<div id="reference-peaks" class="section level2">
<h2 class="hasAnchor">
<a href="#reference-peaks" class="anchor"></a>Reference peaks (*)</h2>
<p>Visualize the reference peaks. It looks like the sample at <code>seq_nr=66</code> has an abnormously high <code>r46/44</code> difference between the two reference peaks (&gt;0.5 permil). However, it is stable for <code>r45/44</code> so will likely be okay for d13C. Nevertheless, we’ll flag it as potentially problematic to keep an eye on the sample in the final data.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">iso_files</span> <span class="op">%&gt;%</span> 
  <span class="co"># get all peaks</span>
  <span class="fu"><a href="../reference/iso_get_peak_table.html">iso_get_peak_table</a></span><span class="op">(</span>include_file_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">seq_nr</span>, <span class="va">analysis</span>, <span class="va">type</span><span class="op">)</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># focus on reference peaks only and add reference info</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">ref_nr</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>ref_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">ref_nr</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">is_ref</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"*"</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># visualize</span>
  <span class="fu"><a href="../reference/iso_plot_ref_peaks.html">iso_plot_ref_peaks</a></span><span class="op">(</span>
    <span class="co"># specify the ratios to visualize</span>
    x <span class="op">=</span> <span class="va">seq_nr</span>, ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">`r45/44`</span>, <span class="va">`r46/44`</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">ref_info</span>,
    panel_scales <span class="op">=</span> <span class="st">"fixed"</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># mark ranges &amp; outliers</span>
  <span class="fu"><a href="../reference/iso_mark_x_range.html">iso_mark_x_range</a></span><span class="op">(</span>condition <span class="op">=</span> <span class="va">type</span> <span class="op">==</span> <span class="st">"sample"</span>, fill <span class="op">=</span> <span class="st">"peru"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_mark_value_range.html">iso_mark_value_range</a></span><span class="op">(</span>plus_minus_value <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_mark_outliers.html">iso_mark_outliers</a></span><span class="op">(</span>plus_minus_value <span class="op">=</span> <span class="fl">0.25</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_format.html">iso_format</a></span><span class="op">(</span><span class="va">seq_nr</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># add labels</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sequence #"</span>, fill <span class="op">=</span> <span class="st">"Reference\npeak"</span><span class="op">)</span></code></pre></div>
<p><img src="ea_irms_example_carbon_files/figure-html/ref_peak_variation-1.png" width="864"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">iso_files</span> <span class="op">&lt;-</span> <span class="va">iso_files</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_mutate_file_info.html">iso_mutate_file_info</a></span><span class="op">(</span>note <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">seq_nr</span> <span class="op">==</span> <span class="fl">66</span>, <span class="st">"ref peaks deviate &gt; 0.5 permil in r46/44"</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Info: mutating file info for 118 data file(s)</span></code></pre></div>
</div>
</div>
<div id="inspect-data" class="section level1">
<h1 class="hasAnchor">
<a href="#inspect-data" class="anchor"></a>Inspect data</h1>
<div id="fetch-peak-table" class="section level2">
<h2 class="hasAnchor">
<a href="#fetch-peak-table" class="anchor"></a>Fetch peak table (*)</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">peak_table</span> <span class="op">&lt;-</span> <span class="va">iso_files</span> <span class="op">%&gt;%</span> 
  <span class="co"># whole peak table</span>
  <span class="fu"><a href="../reference/iso_get_peak_table.html">iso_get_peak_table</a></span><span class="op">(</span>include_file_info <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># focus on analyte peak only</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">compound</span> <span class="op">==</span> <span class="st">"CO2 analyte"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># calculate 13C mean, sd and deviation from mean within each type</span>
  <span class="fu"><a href="../reference/iso_mutate_peak_table.html">iso_mutate_peak_table</a></span><span class="op">(</span>
    group_by <span class="op">=</span> <span class="va">type</span>,
    d13C_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">d13C</span><span class="op">)</span>,
    d13C_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">d13C</span><span class="op">)</span>,
    d13C_dev <span class="op">=</span> <span class="va">d13C</span> <span class="op">-</span> <span class="va">d13C_mean</span>
  <span class="op">)</span>
<span class="co">#&gt; Info: aggregating peak table from 118 data file(s), including file info 'everything()'</span>
<span class="co">#&gt; Info: mutating peak table grouped by 'type', column(s) 'd13C_mean', 'd13C_sd', 'd13C_dev' added.</span></code></pre></div>
</div>
<div id="first-look" class="section level2">
<h2 class="hasAnchor">
<a href="#first-look" class="anchor"></a>First look</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">peak_table</span> <span class="op">%&gt;%</span> 
  <span class="co"># visualize with convenience function iso_plot_data</span>
  <span class="fu"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span><span class="op">(</span>
    <span class="co"># choose x and y (multiple y possible)</span>
    x <span class="op">=</span> <span class="va">seq_nr</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">area44</span>, <span class="va">d13C</span><span class="op">)</span>,
    <span class="co"># choose other aesthetics</span>
    color <span class="op">=</span> <span class="va">type</span>, size <span class="op">=</span> <span class="fl">3</span>, 
    <span class="co"># add label (optionally, for interactive plot)</span>
    label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%s (%d)"</span>, <span class="va">id1</span>, <span class="va">analysis</span><span class="op">)</span><span class="op">)</span>,
    <span class="co"># decide what geoms to include</span>
    points <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span> </code></pre></div>
<p><img src="ea_irms_example_carbon_files/figure-html/all_data_first_look-1.png" width="672"></p>
</div>
<div id="optionally---use-interactive-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#optionally---use-interactive-plot" class="anchor"></a>Optionally - use interactive plot</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># optinally, use an interactive plot to explore your data</span>
<span class="co"># - make sure you install the plotly library --&gt; install.packages("plotly")</span>
<span class="co"># - switch to eval=TRUE in the options of this chunk to include in knit</span>
<span class="co"># - this should work for all plots in this example processing file</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com">plotly</a></span><span class="op">)</span>
<span class="fu"><a href="https://docs.ropensci.org/plotly/reference/ggplotly.html">ggplotly</a></span><span class="op">(</span>dynamicTicks <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div id="standards-variation" class="section level2">
<h2 class="hasAnchor">
<a href="#standards-variation" class="anchor"></a>Standards variation</h2>
<p>Examine the variation in each of the standards.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">peak_table</span> <span class="op">%&gt;%</span> 
  <span class="co"># everything but the sample</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">!=</span> <span class="st">"sample"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># generate plot</span>
  <span class="fu"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mass</span>, y <span class="op">=</span> <span class="va">d13C</span>, color <span class="op">=</span> <span class="va">type</span>, size <span class="op">=</span> <span class="fl">3</span>, points <span class="op">=</span> <span class="cn">TRUE</span>, panel <span class="op">=</span> <span class="va">type</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># mark +/- 1, 2, 3 std. deviation value ranges</span>
  <span class="fu"><a href="../reference/iso_mark_value_range.html">iso_mark_value_range</a></span><span class="op">(</span>plus_minus_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># mark outliers (those outside the 3 sigma range)</span>
  <span class="fu"><a href="../reference/iso_mark_outliers.html">iso_mark_outliers</a></span><span class="op">(</span>plus_minus_sd <span class="op">=</span> <span class="fl">3</span>, label <span class="op">=</span> <span class="va">analysis</span><span class="op">)</span></code></pre></div>
<p><img src="ea_irms_example_carbon_files/figure-html/standards_variation-1.png" width="672"></p>
</div>
<div id="identify-outliers" class="section level2">
<h2 class="hasAnchor">
<a href="#identify-outliers" class="anchor"></a>Identify outliers (*)</h2>
<p>Analysis #19691 is more than 3 standard deviations outside the scale2 standard mean and therefore explicitly flagged as an is_outlier.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># mark outlier</span>
<span class="va">peak_table</span> <span class="op">&lt;-</span> <span class="va">peak_table</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_mutate_peak_table.html">iso_mutate_peak_table</a></span><span class="op">(</span>is_outlier <span class="op">=</span> <span class="va">analysis</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">19691</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Info: mutating peak table, column(s) 'is_outlier' added.</span></code></pre></div>
</div>
</div>
<div id="calibrate-data" class="section level1">
<h1 class="hasAnchor">
<a href="#calibrate-data" class="anchor"></a>Calibrate data</h1>
<div id="add-calibration-information" class="section level2">
<h2 class="hasAnchor">
<a href="#add-calibration-information" class="anchor"></a>Add calibration information (*)</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># this information is often maintained in a csv or Excel file instead</span>
<span class="co"># but generated here from scratch for demonstration purposes</span>
<span class="va">standards</span> <span class="op">&lt;-</span> 
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
    <span class="op">~</span><span class="va">id1</span>,    <span class="op">~</span><span class="va">true_d13C</span>, <span class="op">~</span><span class="va">true_percent_C</span>,
    <span class="st">"acn1"</span>,  <span class="op">-</span><span class="fl">29.53</span>,     <span class="fl">71.09</span>,
    <span class="st">"act1"</span>,  <span class="op">-</span><span class="fl">29.53</span>,     <span class="fl">71.09</span>,
    <span class="st">"pugel"</span>, <span class="op">-</span><span class="fl">12.6</span>,      <span class="fl">44.02</span>,
    <span class="st">"EDTA2"</span>, <span class="op">-</span><span class="fl">40.38</span>,     <span class="fl">41.09</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    <span class="co"># add units</span>
    true_d13C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_with_units.html">iso_double_with_units</a></span><span class="op">(</span><span class="va">true_d13C</span>, <span class="st">"permil"</span><span class="op">)</span>
  <span class="op">)</span>

<span class="co"># printout standards table</span>
<span class="va">standards</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_make_units_explicit.html">iso_make_units_explicit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">id1</th>
<th align="right">true_d13C [permil]</th>
<th align="right">true_percent_C</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">acn1</td>
<td align="right">-29.53</td>
<td align="right">71.09</td>
</tr>
<tr class="even">
<td align="left">act1</td>
<td align="right">-29.53</td>
<td align="right">71.09</td>
</tr>
<tr class="odd">
<td align="left">pugel</td>
<td align="right">-12.60</td>
<td align="right">44.02</td>
</tr>
<tr class="even">
<td align="left">EDTA2</td>
<td align="right">-40.38</td>
<td align="right">41.09</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># add standards</span>
<span class="va">peak_table_w_standards</span> <span class="op">&lt;-</span> 
  <span class="va">peak_table</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_add_standards.html">iso_add_standards</a></span><span class="op">(</span>stds <span class="op">=</span> <span class="va">standards</span>, match_by <span class="op">=</span> <span class="st">"id1"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_mutate_peak_table.html">iso_mutate_peak_table</a></span><span class="op">(</span>mass_C <span class="op">=</span> <span class="va">mass</span> <span class="op">*</span> <span class="va">true_percent_C</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span>
<span class="co">#&gt; Info: matching standards by 'id1' - added 4 standard entries to 40 out of 118 rows, added new column 'is_std_peak' to identify standard peaks</span>
<span class="co">#&gt; Info: mutating peak table, column(s) 'mass_C' added.</span></code></pre></div>
</div>
<div id="temporal-drift" class="section level2">
<h2 class="hasAnchor">
<a href="#temporal-drift" class="anchor"></a>Temporal drift</h2>
<div id="drift-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#drift-plot" class="anchor"></a>Drift plot</h3>
<p>Look at changes in the drift standard over the course of the run:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">peak_table_w_standards</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"drift"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span><span class="op">(</span>
    <span class="co"># alternatively could use x = seq_nr, or x = analysis</span>
    x <span class="op">=</span> <span class="va">file_datetime</span>, y <span class="op">=</span> <span class="va">d13C</span>, size <span class="op">=</span> <span class="va">area44</span>,
    points <span class="op">=</span> <span class="cn">TRUE</span>, date_breaks <span class="op">=</span> <span class="st">"2 hours"</span>,
    <span class="co"># add some potential calibration model lines</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, color <span class="op">=</span> <span class="st">"red"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>, color <span class="op">=</span> <span class="st">"blue"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># mark the total value range</span>
  <span class="fu"><a href="../reference/iso_mark_value_range.html">iso_mark_value_range</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; `geom_smooth()` using formula 'y ~ x'</span>
<span class="co">#&gt; `geom_smooth()` using formula 'y ~ x'</span></code></pre></div>
<p><img src="ea_irms_example_carbon_files/figure-html/drift_vs_time-1.png" width="576"></p>
</div>
<div id="drift-regression" class="section level3">
<h3 class="hasAnchor">
<a href="#drift-regression" class="anchor"></a>Drift regression</h3>
<p>This looks like random scatter rather than any systematic drift but let’s check with a linear regression to confirm:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">calib_drift</span> <span class="op">&lt;-</span> 
  <span class="va">peak_table_w_standards</span> <span class="op">%&gt;%</span>
  <span class="co"># prepare for calibration</span>
  <span class="fu"><a href="../reference/iso_prepare_for_calibration.html">iso_prepare_for_calibration</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># run different calibrations</span>
  <span class="fu"><a href="../reference/iso_generate_calibration.html">iso_generate_calibration</a></span><span class="op">(</span>
    <span class="co"># provide a calibration name</span>
    calibration <span class="op">=</span> <span class="st">"drift"</span>, 
    <span class="co"># provide different regression models to test if there is any</span>
    <span class="co"># systematic pattern in d13C_dev (deviation from the mean)</span>
    model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">d13C_dev</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>, 
      <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">d13C_dev</span> <span class="op">~</span> <span class="va">file_datetime</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/r/stats/loess.html">loess</a></span><span class="op">(</span><span class="va">d13C_dev</span> <span class="op">~</span> <span class="va">file_datetime</span>, span <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
    <span class="op">)</span>,
    <span class="co"># specify which data points to use in the calibration</span>
    use_in_calib <span class="op">=</span> <span class="va">is_std_peak</span> <span class="op">&amp;</span> <span class="va">type</span> <span class="op">==</span> <span class="st">"drift"</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">is_outlier</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># remove problematic calibrations if there are any</span>
  <span class="fu"><a href="../reference/iso_remove_problematic_calibrations.html">iso_remove_problematic_calibrations</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Info: preparing data for calibration by nesting the entire dataset</span>
<span class="co">#&gt; Info: generating 'drift' calibration based on 3 models ('lm(d13C_dev ~ 1)', 'lm(d13C_dev ~ file_datetime)', 'loess(d13C_dev ~ file_datetime, span = 0.5)') for 1 data group(s) with standards filter 'is_std_peak &amp; type == "drift" &amp; !is_outlier'. Storing residuals in new column 'drift_resid'. Storing calibration info in new column 'drift_in_calib'.</span>
<span class="co">#&gt; Info: there are no problematic calibrations</span>

<span class="co"># visualize residuals</span>
<span class="va">calib_drift</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/iso_plot_residuals.html">iso_plot_residuals</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">file_datetime</span>, date_breaks <span class="op">=</span> <span class="st">"3 hours"</span><span class="op">)</span> 
<span class="co">#&gt; `geom_smooth()` using formula 'y ~ x'</span></code></pre></div>
<p><img src="ea_irms_example_carbon_files/figure-html/drift_residuals-1.png" width="768"></p>
<p>Although a local polynomial (<code>loess</code>) correction would improve the overall variation in the residuals, this improvement is minor (&lt;0.01 permil) and it is not clear that this correction addresses any systemic trend. Therefore, no drift correction is applied.</p>
</div>
</div>
<div id="linearity" class="section level2">
<h2 class="hasAnchor">
<a href="#linearity" class="anchor"></a>Linearity</h2>
<div id="linearity-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#linearity-plot" class="anchor"></a>Linearity plot</h3>
<p>Look at the response of the linearity standard and the range the samples are in:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">peak_table_w_standards</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"linearity"</span>, <span class="st">"sample"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">area44</span>, y <span class="op">=</span> <span class="va">d13C</span>, panel <span class="op">=</span> <span class="va">type</span> <span class="op">~</span> <span class="va">.</span>, color <span class="op">=</span> <span class="va">type</span>, points <span class="op">=</span> <span class="cn">TRUE</span>,
    <span class="co"># add a trendline to the linearity panel highlighting the variation</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>data <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">type</span> <span class="op">==</span> <span class="st">"linearity"</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span>
  <span class="op">)</span> 
<span class="co">#&gt; `geom_smooth()` using formula 'y ~ x'</span></code></pre></div>
<p><img src="ea_irms_example_carbon_files/figure-html/linearity_vs_area-1.png" width="576"></p>
</div>
<div id="linearity-regression" class="section level3">
<h3 class="hasAnchor">
<a href="#linearity-regression" class="anchor"></a>Linearity regression (*)</h3>
<p>The linearity standard shows a systematic area-dependent effect on the measured isotopic composition that is likely to have a small effect on the sample isotopic compositions. In runs that include two isotopically different standards (2 point scale calibration) both across the entire linearity range, isotopic offset, discrimination, and linearity can all be evaluated in one joint multi-variate regression. However, this run included only one linearity standard which can be used to correct for linearity prior to offset and discrimination corrections.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># run a set of regressions to evaluate linearity</span>
<span class="va">calib_linearity</span> <span class="op">&lt;-</span> 
  <span class="va">peak_table_w_standards</span> <span class="op">%&gt;%</span>
  <span class="co"># prepare for calibration</span>
  <span class="fu"><a href="../reference/iso_prepare_for_calibration.html">iso_prepare_for_calibration</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># run different calibrations</span>
  <span class="fu"><a href="../reference/iso_generate_calibration.html">iso_generate_calibration</a></span><span class="op">(</span>
    calibration <span class="op">=</span> <span class="st">"lin"</span>,
    <span class="co"># again evaluating different regression models of the deviation from the mean</span>
    model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">d13C_dev</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">d13C_dev</span> <span class="op">~</span> <span class="va">area44</span><span class="op">)</span>, 
      <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">d13C_dev</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">area44</span><span class="op">)</span><span class="op">)</span>, 
      <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">d13C_dev</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">area44</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>,
    use_in_calib <span class="op">=</span> <span class="va">is_std_peak</span> <span class="op">&amp;</span> <span class="va">type</span> <span class="op">==</span> <span class="st">"linearity"</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">is_outlier</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># remove problematic calibrations if there are any</span>
  <span class="fu"><a href="../reference/iso_remove_problematic_calibrations.html">iso_remove_problematic_calibrations</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Info: preparing data for calibration by nesting the entire dataset</span>
<span class="co">#&gt; Info: generating 'lin' calibration based on 4 models ('lm(d13C_dev ~ 1)', 'lm(d13C_dev ~ area44)', 'lm(d13C_dev ~ sqrt(area44))', 'lm(d13C_dev ~ I(1/area44))') for 1 data group(s) with standards filter 'is_std_peak &amp; type == "linearity" &amp; !is_outlier'. Storing residuals in new column 'lin_resid'. Storing calibration info in new column 'lin_in_calib'.</span>
<span class="co">#&gt; Info: there are no problematic calibrations</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># visualizing residuals</span>
<span class="va">calib_linearity</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/iso_plot_residuals.html">iso_plot_residuals</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">area44</span><span class="op">)</span>
<span class="co">#&gt; `geom_smooth()` using formula 'y ~ x'</span></code></pre></div>
<p><img src="ea_irms_example_carbon_files/figure-html/linearity_residuals-1.png" width="768"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># show calibration coefficients</span>
<span class="va">calib_linearity</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/iso_plot_calibration_parameters.html">iso_plot_calibration_parameters</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="ea_irms_example_carbon_files/figure-html/linearity_coefs-1.png" width="480"></p>
<p>It is clear that there is a small (~0.02 permil improvement in the residual) but significant (p &lt; 0.05) linearity effect that could be reasonably corrected with any of the assessed area dependences. However, we will use the <code>~ area44</code> correction because it explains more of the variation in the signal range that the samples fall into (~ 100-250 Vs) as can be seen in the residuals plot.</p>
</div>
<div id="apply-linearity-calibration" class="section level3">
<h3 class="hasAnchor">
<a href="#apply-linearity-calibration" class="anchor"></a>Apply linearity calibration (*)</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># apply calibration</span>
<span class="va">calib_linearity_applied</span> <span class="op">&lt;-</span> 
  <span class="va">calib_linearity</span> <span class="op">%&gt;%</span> 
  <span class="co"># decide which calibration to apply</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">lin_calib</span> <span class="op">==</span> <span class="st">"lm(d13C_dev ~ area44)"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># apply calibration indication what should be calcculated</span>
  <span class="fu"><a href="../reference/iso_apply_calibration.html">iso_apply_calibration</a></span><span class="op">(</span>predict <span class="op">=</span> <span class="va">d13C_dev</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># evaluate calibration range across area44</span>
  <span class="fu"><a href="../reference/iso_evaluate_calibration_range.html">iso_evaluate_calibration_range</a></span><span class="op">(</span><span class="va">area44</span><span class="op">)</span>
<span class="co">#&gt; Info: applying 'lin' calibration to infer 'd13C_dev' for 1 data group(s) in 1 model(s); storing resulting value in new column 'd13C_dev_pred'. This may take a moment... finished.</span>
<span class="co">#&gt; Info: evaluating range for terms 'area44' in 'lin' calibration for 1 data group(s) in 1 model(s); storing resulting summary for each data entry in new column 'lin_in_range'.</span>

<span class="co"># show linearity correction range</span>
<span class="va">calib_linearity_applied</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/iso_get_calibration_range.html">iso_get_calibration_range</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; Info: retrieving all calibration range information for 'lin' calibration</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">lin_calib</th>
<th align="right">lin_calib_points</th>
<th align="left">term</th>
<th align="left">units</th>
<th align="right">min</th>
<th align="right">max</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">lm(d13C_dev ~ area44)</td>
<td align="right">10</td>
<td align="left">area44</td>
<td align="left">Vs</td>
<td align="right">33.74</td>
<td align="right">381.76</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># fetch peak table from applied calibration</span>
<span class="va">peak_table_lin_corr</span> <span class="op">&lt;-</span> 
  <span class="va">calib_linearity_applied</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_get_calibration_data.html">iso_get_calibration_data</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># calculate the corrected d13C value</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>d13C_lin_corr <span class="op">=</span> <span class="va">d13C</span> <span class="op">-</span> <span class="va">d13C_dev_pred</span><span class="op">)</span>
<span class="co">#&gt; Info: retrieving all data</span></code></pre></div>
</div>
<div id="check-calibration-results" class="section level3">
<h3 class="hasAnchor">
<a href="#check-calibration-results" class="anchor"></a>Check calibration results</h3>
<p>Check the improvement in standard deviation of the linearity standard:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">peak_table_lin_corr</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"linearity"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span><span class="op">(</span>
    <span class="va">area44</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">d13C</span>, <span class="va">d13C_lin_corr</span><span class="op">)</span>, color <span class="op">=</span> <span class="va">variable</span>, panel <span class="op">=</span> <span class="cn">NULL</span>, points <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># show standard deviation range</span>
  <span class="fu"><a href="../reference/iso_mark_value_range.html">iso_mark_value_range</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="cn">FALSE</span>, plus_minus_sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="ea_irms_example_carbon_files/figure-html/linearity_check-1.png" width="672"></p>
</div>
</div>
<div id="isotopic-scaling" class="section level2">
<h2 class="hasAnchor">
<a href="#isotopic-scaling" class="anchor"></a>Isotopic scaling</h2>
<div id="scale-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#scale-plot" class="anchor"></a>Scale plot</h3>
<p>Look at the linearity corrected isotopic measurement of the two discrimnation standardds relative to their known isotopic value:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">peak_table_lin_corr</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"scale1"</span>, <span class="st">"scale2"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">true_d13C</span>, y <span class="op">=</span> <span class="va">d13C_lin_corr</span>, color <span class="op">=</span> <span class="va">id1</span>, 
    points <span class="op">=</span> <span class="cn">TRUE</span>,
    <span class="co"># add 1:1 slope for a visual check on scaling and offset</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> 
  <span class="op">)</span> </code></pre></div>
<p><img src="ea_irms_example_carbon_files/figure-html/measured_vs_true-1.png" width="576"></p>
</div>
<div id="scale-regression" class="section level3">
<h3 class="hasAnchor">
<a href="#scale-regression" class="anchor"></a>Scale regression (*)</h3>
<p>Evaluate regression models for isotopic scale contraction (discrimination) and offset:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># run a set of regressions to evaluate linearity</span>
<span class="va">calib_scale</span> <span class="op">&lt;-</span> 
  <span class="va">peak_table_lin_corr</span> <span class="op">%&gt;%</span>
  <span class="co"># prepare for calibration</span>
  <span class="fu"><a href="../reference/iso_prepare_for_calibration.html">iso_prepare_for_calibration</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># run different calibrations</span>
  <span class="fu"><a href="../reference/iso_generate_calibration.html">iso_generate_calibration</a></span><span class="op">(</span>
    calibration <span class="op">=</span> <span class="st">"scale"</span>,
    model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">d13C_lin_corr</span> <span class="op">~</span> <span class="va">true_d13C</span><span class="op">)</span>,
    use_in_calib <span class="op">=</span> <span class="va">is_std_peak</span> <span class="op">&amp;</span> <span class="va">type</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"scale1"</span>, <span class="st">"scale2"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">is_outlier</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># remove problematic calibrations if there are any</span>
  <span class="fu"><a href="../reference/iso_remove_problematic_calibrations.html">iso_remove_problematic_calibrations</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Info: preparing data for calibration by nesting the entire dataset</span>
<span class="co">#&gt; Info: generating 'scale' calibration based on 1 model ('lm(d13C_lin_corr ~ true_d13C)') for 1 data group(s) with standards filter 'is_std_peak &amp; type %in% c("scale1", "scale2") &amp; !is_outlier'. Storing residuals in new column 'scale_resid'. Storing calibration info in new column 'scale_in_calib'.</span>
<span class="co">#&gt; Info: there are no problematic calibrations</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># visualizing residuals</span>
<span class="va">calib_scale</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_plot_residuals.html">iso_plot_residuals</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">true_d13C</span>, shape <span class="op">=</span> <span class="va">id1</span>, size <span class="op">=</span> <span class="va">area44</span>, trendlines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="ea_irms_example_carbon_files/figure-html/scale_residuals-1.png" width="672"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># show calibration coefficients</span>
<span class="va">calib_scale</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_plot_calibration_parameters.html">iso_plot_calibration_parameters</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># reset theme for horizontal x axis labels</span></code></pre></div>
<p><img src="ea_irms_example_carbon_files/figure-html/scale_coefs-1.png" width="480"></p>
</div>
<div id="apply-scale-calibration" class="section level3">
<h3 class="hasAnchor">
<a href="#apply-scale-calibration" class="anchor"></a>Apply scale calibration (*)</h3>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># apply calibration</span>
<span class="va">calib_scale_applied</span> <span class="op">&lt;-</span> 
  <span class="va">calib_scale</span> <span class="op">%&gt;%</span> 
  <span class="co"># decide which calibration to apply</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">scale_calib</span> <span class="op">==</span> <span class="st">"lm(d13C_lin_corr ~ true_d13C)"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># apply calibration indicating what should be calculated</span>
  <span class="fu"><a href="../reference/iso_apply_calibration.html">iso_apply_calibration</a></span><span class="op">(</span>predict <span class="op">=</span> <span class="va">true_d13C</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># evaluate calibration range</span>
  <span class="fu"><a href="../reference/iso_evaluate_calibration_range.html">iso_evaluate_calibration_range</a></span><span class="op">(</span><span class="va">true_d13C_pred</span><span class="op">)</span>
<span class="co">#&gt; Info: applying 'scale' calibration to infer 'true_d13C' for 1 data group(s) in 1 model(s); storing resulting value in new column 'true_d13C_pred'. This may take a moment... finished.</span>
<span class="co">#&gt; Info: evaluating range for terms 'true_d13C_pred' in 'scale' calibration for 1 data group(s) in 1 model(s); storing resulting summary for each data entry in new column 'scale_in_range'.</span>

<span class="co"># show scale range</span>
<span class="va">calib_scale_applied</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/iso_get_calibration_range.html">iso_get_calibration_range</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; Info: retrieving all calibration range information for 'scale' calibration</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">scale_calib</th>
<th align="right">scale_calib_points</th>
<th align="left">term</th>
<th align="left">units</th>
<th align="right">min</th>
<th align="right">max</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">lm(d13C_lin_corr ~ true_d13C)</td>
<td align="right">15</td>
<td align="left">true_d13C_pred</td>
<td align="left">permil</td>
<td align="right">-40.45</td>
<td align="right">-12.56</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># get calibrated data</span>
<span class="va">peak_table_lin_scale_corr</span> <span class="op">&lt;-</span> 
  <span class="va">calib_scale_applied</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_get_calibration_data.html">iso_get_calibration_data</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Info: retrieving all data</span></code></pre></div>
</div>
<div id="check-calibration-results-1" class="section level3">
<h3 class="hasAnchor">
<a href="#check-calibration-results-1" class="anchor"></a>Check calibration results</h3>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># check the overal calibration results by visualizing </span>
<span class="co"># all analytes with known isotopic composition</span>
<span class="va">peak_table_lin_scale_corr</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">true_d13C</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>`known d13C` <span class="op">=</span> <span class="va">true_d13C</span><span class="op">)</span>, 
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>`measured d13C` <span class="op">=</span> <span class="va">true_d13C_pred</span><span class="op">)</span>, 
    color <span class="op">=</span> <span class="va">id1</span>, size <span class="op">=</span> <span class="va">area44</span>,
    points <span class="op">=</span> <span class="cn">TRUE</span>, shape <span class="op">=</span> <span class="va">is_outlier</span>,
    <span class="co"># add the expected 1:1 line</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> 
  <span class="op">)</span></code></pre></div>
<p><img src="ea_irms_example_carbon_files/figure-html/scale_check-1.png" width="672"></p>
</div>
</div>
<div id="carbon-percent" class="section level2">
<h2 class="hasAnchor">
<a href="#carbon-percent" class="anchor"></a>Carbon percent</h2>
<div id="mass-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#mass-plot" class="anchor"></a>Mass plot</h3>
<p>Check how well signal intensity varies with the amount of carbon for all standards</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># visualize the linearity standard's signal intensity vs. amount of carbon</span>
<span class="va">peak_table_lin_scale_corr</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">mass_C</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">mass_C</span>, y <span class="op">=</span> <span class="va">area44</span>, color <span class="op">=</span> <span class="va">type</span>, points <span class="op">=</span> <span class="cn">TRUE</span>,
    <span class="co"># add overall linear regression fit to visualize</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>
<span class="co">#&gt; `geom_smooth()` using formula 'y ~ x'</span></code></pre></div>
<p><img src="ea_irms_example_carbon_files/figure-html/weight_percent_C_area_vs_mass-1.png" width="672"></p>
</div>
<div id="mass-regression" class="section level3">
<h3 class="hasAnchor">
<a href="#mass-regression" class="anchor"></a>Mass regression (*)</h3>
<p>Calibrate the amount of C using the linearity standard</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># run a set of regressions to evaluate linearity</span>
<span class="va">calib_mass_C</span> <span class="op">&lt;-</span> 
  <span class="va">peak_table_lin_scale_corr</span> <span class="op">%&gt;%</span>
  <span class="co"># prepare for calibration</span>
  <span class="fu"><a href="../reference/iso_prepare_for_calibration.html">iso_prepare_for_calibration</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># run different calibrations</span>
  <span class="fu"><a href="../reference/iso_generate_calibration.html">iso_generate_calibration</a></span><span class="op">(</span>
    calibration <span class="op">=</span> <span class="st">"mass"</span>,
    model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">mass_C</span> <span class="op">~</span> <span class="va">area44</span><span class="op">)</span>,
    use_in_calib <span class="op">=</span> <span class="va">is_std_peak</span> <span class="op">&amp;</span> <span class="va">type</span> <span class="op">==</span> <span class="st">"linearity"</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">is_outlier</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># remove problematic calibrations if there are any</span>
  <span class="fu"><a href="../reference/iso_remove_problematic_calibrations.html">iso_remove_problematic_calibrations</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Info: preparing data for calibration by nesting the entire dataset</span>
<span class="co">#&gt; Info: generating 'mass' calibration based on 1 model ('lm(mass_C ~ area44)') for 1 data group(s) with standards filter 'is_std_peak &amp; type == "linearity" &amp; !is_outlier'. Storing residuals in new column 'mass_resid'. Storing calibration info in new column 'mass_in_calib'.</span>
<span class="co">#&gt; Info: there are no problematic calibrations</span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># visualizing residuals</span>
<span class="va">calib_mass_C</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_plot_residuals.html">iso_plot_residuals</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">area44</span>, color <span class="op">=</span> <span class="va">type</span>, trendlines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </code></pre></div>
<p><img src="ea_irms_example_carbon_files/figure-html/weight_percent_C_mass_residuals-1.png" width="672"></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># show calibration coefficients</span>
<span class="va">calib_mass_C</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_plot_calibration_parameters.html">iso_plot_calibration_parameters</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># reset theme for horizontal x axis labels</span></code></pre></div>
<p><img src="ea_irms_example_carbon_files/figure-html/weight_percent_C_coefs-1.png" width="480"></p>
</div>
<div id="apply-mass-calibration" class="section level3">
<h3 class="hasAnchor">
<a href="#apply-mass-calibration" class="anchor"></a>Apply mass calibration (*)</h3>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># apply calibration</span>
<span class="va">calib_mass_C_applied</span> <span class="op">&lt;-</span> 
  <span class="va">calib_mass_C</span> <span class="op">%&gt;%</span> 
  <span class="co"># decide which calibration to apply</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">mass_calib</span> <span class="op">==</span> <span class="st">"lm(mass_C ~ area44)"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># apply calibration to predict mass_C (creating new mass_C_pred column)</span>
  <span class="co"># since it's a single step calibration, also calculate the error</span>
  <span class="fu"><a href="../reference/iso_apply_calibration.html">iso_apply_calibration</a></span><span class="op">(</span>predict <span class="op">=</span> <span class="va">mass_C</span>, calculate_error <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># evaluate calibration range for the mass_C_pred column</span>
  <span class="fu"><a href="../reference/iso_evaluate_calibration_range.html">iso_evaluate_calibration_range</a></span><span class="op">(</span><span class="va">mass_C_pred</span><span class="op">)</span>
<span class="co">#&gt; Info: applying 'mass' calibration to infer 'mass_C' for 1 data group(s) in 1 model(s); storing resulting value in new column 'mass_C_pred' and estimated error in new column 'mass_C_pred_se'. This may take a moment... finished.</span>
<span class="co">#&gt; Info: evaluating range for terms 'mass_C_pred' in 'mass' calibration for 1 data group(s) in 1 model(s); storing resulting summary for each data entry in new column 'mass_in_range'.</span>

<span class="co"># show scale range</span>
<span class="va">calib_mass_C_applied</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/iso_get_calibration_range.html">iso_get_calibration_range</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; Info: retrieving all calibration range information for 'mass' calibration</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">mass_calib</th>
<th align="right">mass_calib_points</th>
<th align="left">term</th>
<th align="left">units</th>
<th align="right">min</th>
<th align="right">max</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">lm(mass_C ~ area44)</td>
<td align="right">10</td>
<td align="left">mass_C_pred</td>
<td align="left">ug</td>
<td align="right">6.94</td>
<td align="right">80.98</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># get calibrated data</span>
<span class="va">peak_table_lin_scale_mass_corr</span> <span class="op">&lt;-</span> 
  <span class="va">calib_mass_C_applied</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_get_calibration_data.html">iso_get_calibration_data</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_mutate_peak_table.html">iso_mutate_peak_table</a></span><span class="op">(</span>
    <span class="co"># calcuilate % C and propagate error (adjust if there is also error in mass)</span>
    percent_C <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">mass_C_pred</span> <span class="op">/</span> <span class="va">mass</span>,
    percent_C_se <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">mass_C_pred_se</span> <span class="op">/</span> <span class="va">mass</span>
  <span class="op">)</span>
<span class="co">#&gt; Info: retrieving all data</span>
<span class="co">#&gt; Info: mutating peak table, column(s) 'percent_C', 'percent_C_se' added.</span></code></pre></div>
</div>
<div id="check-calibration-results-2" class="section level3">
<h3 class="hasAnchor">
<a href="#check-calibration-results-2" class="anchor"></a>Check calibration results</h3>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># check the overal calibration results by visualizing </span>
<span class="co"># all analytes with known %C  </span>
<span class="va">peak_table_lin_scale_mass_corr</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">true_percent_C</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>`known %C` <span class="op">=</span> <span class="va">true_percent_C</span><span class="op">)</span>,
    <span class="co"># define 2 y values to panel</span>
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>`measured %C` <span class="op">=</span> <span class="va">percent_C</span>, `measured - known %C` <span class="op">=</span> <span class="va">percent_C</span> <span class="op">-</span> <span class="va">true_percent_C</span><span class="op">)</span>,
    <span class="co"># include regression error bars to highlight variation beyond the estimated</span>
    y_error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">percent_C_se</span>, <span class="va">percent_C_se</span><span class="op">)</span>,
    color <span class="op">=</span> <span class="va">type</span>, size <span class="op">=</span> <span class="va">area44</span>, points <span class="op">=</span> <span class="cn">TRUE</span>,
    <span class="co"># add the expected 1:1 line</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> 
  <span class="op">)</span></code></pre></div>
<p><img src="ea_irms_example_carbon_files/figure-html/mass_calibration_check-1.png" width="576"></p>
</div>
<div id="check-carbon-percent-drift" class="section level3">
<h3 class="hasAnchor">
<a href="#check-carbon-percent-drift" class="anchor"></a>Check carbon percent drift</h3>
<p>It looks like there is quite some variation around the known value –&gt; check if there is temporal drift affecting the measured %C:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">peak_table_lin_scale_mass_corr</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"drift"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">file_datetime</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>`measured %C` <span class="op">=</span> <span class="va">percent_C</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">area44</span>,
    points <span class="op">=</span> <span class="cn">TRUE</span>,
    <span class="co"># add some potential regression models</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, color <span class="op">=</span> <span class="st">"red"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>, color <span class="op">=</span> <span class="st">"blue"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  <span class="op">)</span>
<span class="co">#&gt; `geom_smooth()` using formula 'y ~ x'</span>
<span class="co">#&gt; `geom_smooth()` using formula 'y ~ x'</span></code></pre></div>
<p><img src="ea_irms_example_carbon_files/figure-html/mass_calibration_drift_check-1.png" width="576"></p>
<p>It does NOT look like there is a systematic drift so will not apply a correction.</p>
</div>
</div>
</div>
<div id="evaluate-data" class="section level1">
<h1 class="hasAnchor">
<a href="#evaluate-data" class="anchor"></a>Evaluate data</h1>
<div id="isotopic-accuracy-precision" class="section level2">
<h2 class="hasAnchor">
<a href="#isotopic-accuracy-precision" class="anchor"></a>Isotopic Accuracy &amp; Precision</h2>
<p>For this run, use the linearity standard for a very conservative accuracy and precision standard.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">peak_table_lin_scale_mass_corr</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"linearity"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">id1</span>, <span class="va">true_d13C</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_summarize_data_table.html">iso_summarize_data_table</a></span><span class="op">(</span><span class="va">true_d13C_pred</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    accuracy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">`true_d13C_pred mean`</span> <span class="op">-</span> <span class="va">true_d13C</span><span class="op">)</span>,
    precision <span class="op">=</span> <span class="va">`true_d13C_pred sd`</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">id1</span>, <span class="va">n</span>, <span class="va">accuracy</span>, <span class="va">precision</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_make_units_explicit.html">iso_make_units_explicit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">id1</th>
<th align="right">n</th>
<th align="right">accuracy [permil]</th>
<th align="right">precision</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">acn1</td>
<td align="right">10</td>
<td align="right">0.008</td>
<td align="right">0.036</td>
</tr></tbody>
</table>
</div>
<div id="c-accuracy-precision" class="section level2">
<h2 class="hasAnchor">
<a href="#c-accuracy-precision" class="anchor"></a>%C Accuracy &amp; Precision</h2>
<p>Check the precision for all standards but keep in mind that the <code>linearity</code> standard was used for calibration. The <code>drift</code> standard provides the most conservative accuracy and precision estimate:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">peak_table_lin_scale_mass_corr</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">true_percent_C</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">type</span>, <span class="va">true_percent_C</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_summarize_data_table.html">iso_summarize_data_table</a></span><span class="op">(</span><span class="va">percent_C</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    accuracy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">`percent_C mean`</span> <span class="op">-</span> <span class="va">true_percent_C</span><span class="op">)</span>,
    precision <span class="op">=</span> <span class="va">`percent_C sd`</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">type</span>, <span class="va">n</span>, <span class="va">accuracy</span>, <span class="va">precision</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_make_units_explicit.html">iso_make_units_explicit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">type</th>
<th align="right">n</th>
<th align="right">accuracy</th>
<th align="right">precision</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">drift</td>
<td align="right">14</td>
<td align="right">1.625</td>
<td align="right">3.445</td>
</tr>
<tr class="even">
<td align="left">linearity</td>
<td align="right">10</td>
<td align="right">0.284</td>
<td align="right">2.384</td>
</tr>
<tr class="odd">
<td align="left">scale1</td>
<td align="right">3</td>
<td align="right">0.409</td>
<td align="right">0.877</td>
</tr>
<tr class="even">
<td align="left">scale2</td>
<td align="right">13</td>
<td align="right">0.189</td>
<td align="right">1.970</td>
</tr>
</tbody>
</table>
</div>
<div id="plot-data" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-data" class="anchor"></a>Plot Data</h2>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">peak_table_lin_scale_mass_corr</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"sample"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_plot_data.html">iso_plot_data</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">id1</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">true_d13C_pred</span>, <span class="va">percent_C</span><span class="op">)</span>, 
    shape <span class="op">=</span> <span class="fu">str_extract</span><span class="op">(</span><span class="va">id1</span>, <span class="st">"^\\w+"</span><span class="op">)</span>,
    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/isoreader/man/iso_format.html">iso_format</a></span><span class="op">(</span>area <span class="op">=</span> <span class="va">lin_in_range</span>, d13C <span class="op">=</span> <span class="va">scale_in_range</span><span class="op">)</span>,
    points <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_mark_calibration_range.html">iso_mark_calibration_range</a></span><span class="op">(</span>calibration <span class="op">=</span> <span class="st">"scale"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="st">"data groups"</span>, color <span class="op">=</span> <span class="st">"in calibration ranges"</span><span class="op">)</span></code></pre></div>
<p><img src="ea_irms_example_carbon_files/figure-html/samples-1.png" width="864"></p>
</div>
</div>
<div id="final" class="section level1">
<h1 class="hasAnchor">
<a href="#final" class="anchor"></a>Final</h1>
<p>Final data processing and visualization usually depends on the type of data and the metadata available for contextualization (e.g. core depth, source organism, age, etc.). The relevant metadata can be added easily with <code><a href="https://rdrr.io/pkg/isoreader/man/iso_add_file_info.html">iso_add_file_info()</a></code> during the initial data load / file info procesing. Alternatively, just call <code><a href="https://rdrr.io/pkg/isoreader/man/iso_add_file_info.html">iso_add_file_info()</a></code> again at this later point or use dplyr’s <code>left_join</code> directly.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># @user: add final data processing and plot(s)</span>
<span class="va">data_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="export" class="section level1">
<h1 class="hasAnchor">
<a href="#export" class="anchor"></a>Export</h1>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># export the calibrations with all information and data to Excel</span>
<span class="va">peak_table_lin_scale_mass_corr</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/iso_export_calibration_to_excel.html">iso_export_calibration_to_excel</a></span><span class="op">(</span>
    filepath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"%Y%m%d_ea_irms_example_carbon_export.xlsx"</span><span class="op">)</span>,
    <span class="co"># include data summary as an additional useful tab</span>
    `data summary` <span class="op">=</span> <span class="va">data_summary</span>
  <span class="op">)</span>
<span class="co">#&gt; Info: exporting calibrations into Excel '20210304_ea_irms_example_carbon_export.xlsx'...</span>
<span class="co">#&gt; Info: retrieving all data</span>
<span class="co">#&gt; Info: retrieving all coefficient information for 'lin' calibration</span>
<span class="co">#&gt; Info: retrieving all summary information for 'lin' calibration</span>
<span class="co">#&gt; Info: retrieving all calibration range information for 'lin' calibration</span>
<span class="co">#&gt; Info: retrieving all coefficient information for 'scale' calibration</span>
<span class="co">#&gt; Info: retrieving all summary information for 'scale' calibration</span>
<span class="co">#&gt; Info: retrieving all calibration range information for 'scale' calibration</span>
<span class="co">#&gt; Info: retrieving all coefficient information for 'mass' calibration</span>
<span class="co">#&gt; Info: retrieving all summary information for 'mass' calibration</span>
<span class="co">#&gt; Info: retrieving all calibration range information for 'mass' calibration</span>
<span class="co">#&gt; Info: export complete, created tabs 'data summary', 'all data', 'lin coefs', 'lin summary', 'lin range', 'scale coefs', 'scale summary', 'scale range', 'mass coefs', 'mass summary' and 'mass range'.</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Sebastian Kopf.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
